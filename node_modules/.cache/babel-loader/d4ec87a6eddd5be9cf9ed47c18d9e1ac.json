{"ast":null,"code":"import _regeneratorRuntime from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Modal,Button,Table,Message,Dropdown}from'semantic-ui-react';import{GoogleReCaptchaProvider,withGoogleReCaptcha}from'react-google-recaptcha-v3';import{SignInButton}from'../TopBar/TopBar';import{serverPath}from'../../utils';import{SubscribeButton}from'../SubscribeButton/SubscribeButton';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var VBrowserModal=/*#__PURE__*/function(_React$Component){_inherits(VBrowserModal,_React$Component);var _super=_createSuper(VBrowserModal);function VBrowserModal(){var _this;_classCallCheck(this,VBrowserModal);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={isFreePoolFull:false,region:'US'};return _this;}_createClass(VBrowserModal,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var resp,metadata;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return window.fetch(serverPath+'/metadata');case 2:resp=_context.sent;_context.next=5;return resp.json();case 5:metadata=_context.sent;this.setState({isFreePoolFull:metadata.isFreePoolFull});case 7:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this2=this;var regionOptions=[{key:'US',text:'US East',value:'US',image:{avatar:false,src:'/flag-united-states.png'}},{key:'EU',text:'Europe',value:'EU',image:{avatar:false,src:'/flag-european-union.png'}}];if(this.props.beta){regionOptions.push({key:'USW',text:'US West',value:'USW',image:{avatar:false,src:'/flag-united-states.png'}});}var _this$props=this.props,closeModal=_this$props.closeModal,startVBrowser=_this$props.startVBrowser;var LaunchButton=withGoogleReCaptcha(function(_ref){var googleReCaptchaProps=_ref.googleReCaptchaProps,large=_ref.large;return/*#__PURE__*/_jsx(Button,{color:large?'orange':undefined,onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var rcToken;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return googleReCaptchaProps.executeRecaptcha('launchVBrowser');case 2:rcToken=_context2.sent;startVBrowser(rcToken,{size:large?'large':'',region:large?_this2.state.region:'US'});closeModal();case 5:case\"end\":return _context2.stop();}}},_callee2);})),children:large?'Launch VBrowser+':'Continue with Free'});});var vmPoolFullMessage=/*#__PURE__*/_jsx(Message,{size:\"small\",color:\"red\",icon:\"hourglass two\",style:{width:'380px'},header:\"No Free VBrowsers Available\",content:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:\"All of the free VBrowsers are currently being used.\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Please consider subscribing for anytime access to faster VBrowsers, or try again later.\"})]})});var subscribeButton=!this.props.isSubscriber?/*#__PURE__*/_jsx(SubscribeButton,{user:this.props.user}):null;return/*#__PURE__*/_jsx(GoogleReCaptchaProvider,{reCaptchaKey:process.env.REACT_APP_RECAPTCHA_SITE_KEY,useRecaptchaNet:true,children:/*#__PURE__*/_jsxs(Modal,{open:true,onClose:closeModal,children:[/*#__PURE__*/_jsx(Modal.Header,{children:\"Launch a VBrowser\"}),/*#__PURE__*/_jsx(Modal.Content,{image:true,children:/*#__PURE__*/_jsxs(Modal.Description,{children:[/*#__PURE__*/_jsx(\"div\",{children:\"You're about to launch a virtual browser to share in this room.\"}),/*#__PURE__*/_jsxs(Table,{definition:true,unstackable:true,striped:true,celled:true,children:[/*#__PURE__*/_jsx(Table.Header,{children:/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.HeaderCell,{}),/*#__PURE__*/_jsx(Table.HeaderCell,{children:\"WatchParty Free\"}),/*#__PURE__*/_jsx(Table.HeaderCell,{children:\"WatchParty Plus\"})]})}),/*#__PURE__*/_jsxs(Table.Body,{children:[/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{children:\"VBrowser Max Resolution\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"720p\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"1080p\"})]}),/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{children:\"VBrowser CPU/RAM\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"Standard\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"Extra\"})]}),/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{children:\"VBrowser Session Length\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"3 hours\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"24 hours\"})]}),/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{children:\"Recommended Max Viewers\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"15\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"30\"})]}),/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{children:\"Region\"}),/*#__PURE__*/_jsx(Table.Cell,{children:\"Where available \"}),/*#__PURE__*/_jsx(Table.Cell,{children:/*#__PURE__*/_jsx(Dropdown,{selection:true,onChange:function onChange(e,_ref3){var value=_ref3.value;return _this2.setState({region:value});},value:this.state.region,options:regionOptions})})]}),/*#__PURE__*/_jsxs(Table.Row,{children:[/*#__PURE__*/_jsx(Table.Cell,{}),/*#__PURE__*/_jsx(Table.Cell,{children:this.props.user?this.state.isFreePoolFull?vmPoolFullMessage:/*#__PURE__*/_jsx(LaunchButton,{}):/*#__PURE__*/_jsx(SignInButton,{fluid:true,user:this.props.user,isSubscriber:this.props.isSubscriber})}),/*#__PURE__*/_jsx(Table.Cell,{children:this.props.isSubscriber?/*#__PURE__*/_jsx(LaunchButton,{large:true}):subscribeButton})]})]})]})]})})]})});}}]);return VBrowserModal;}(React.Component);","map":{"version":3,"names":["React","Modal","Button","Table","Message","Dropdown","GoogleReCaptchaProvider","withGoogleReCaptcha","SignInButton","serverPath","SubscribeButton","VBrowserModal","state","isFreePoolFull","region","window","fetch","resp","json","metadata","setState","regionOptions","key","text","value","image","avatar","src","props","beta","push","closeModal","startVBrowser","LaunchButton","googleReCaptchaProps","large","undefined","executeRecaptcha","rcToken","size","vmPoolFullMessage","width","subscribeButton","isSubscriber","user","process","env","REACT_APP_RECAPTCHA_SITE_KEY","e","Component"],"sources":["/home/runner/work/watchparty/watchparty/src/components/Modal/VBrowserModal.tsx"],"sourcesContent":["import React from 'react';\nimport { Modal, Button, Table, Message, Dropdown } from 'semantic-ui-react';\nimport {\n  GoogleReCaptchaProvider,\n  withGoogleReCaptcha,\n} from 'react-google-recaptcha-v3';\nimport { SignInButton } from '../TopBar/TopBar';\nimport { serverPath } from '../../utils';\nimport firebase from 'firebase/compat/app';\nimport { SubscribeButton } from '../SubscribeButton/SubscribeButton';\n\nexport class VBrowserModal extends React.Component<{\n  closeModal: () => void;\n  startVBrowser: (\n    rcToken: string,\n    options: { size: string; region: string }\n  ) => void;\n  isSubscriber: boolean;\n  user: firebase.User | undefined;\n  beta?: boolean;\n}> {\n  state = {\n    isFreePoolFull: false,\n    region: 'US',\n  };\n\n  async componentDidMount() {\n    const resp = await window.fetch(serverPath + '/metadata');\n    const metadata = await resp.json();\n    this.setState({ isFreePoolFull: metadata.isFreePoolFull });\n  }\n  render() {\n    const regionOptions = [\n      {\n        key: 'US',\n        text: 'US East',\n        value: 'US',\n        image: { avatar: false, src: '/flag-united-states.png' },\n      },\n      {\n        key: 'EU',\n        text: 'Europe',\n        value: 'EU',\n        image: { avatar: false, src: '/flag-european-union.png' },\n      },\n    ];\n    if (this.props.beta) {\n      regionOptions.push({\n        key: 'USW',\n        text: 'US West',\n        value: 'USW',\n        image: { avatar: false, src: '/flag-united-states.png' },\n      });\n    }\n    const { closeModal, startVBrowser } = this.props;\n    const LaunchButton = withGoogleReCaptcha(\n      ({ googleReCaptchaProps, large }: any) => (\n        <Button\n          color={large ? 'orange' : undefined}\n          onClick={async () => {\n            const rcToken = await googleReCaptchaProps.executeRecaptcha(\n              'launchVBrowser'\n            );\n            startVBrowser(rcToken, {\n              size: large ? 'large' : '',\n              region: large ? this.state.region : 'US',\n            });\n            closeModal();\n          }}\n        >\n          {large ? 'Launch VBrowser+' : 'Continue with Free'}\n        </Button>\n      )\n    );\n    const vmPoolFullMessage = (\n      <Message\n        size=\"small\"\n        color=\"red\"\n        icon=\"hourglass two\"\n        style={{ width: '380px' }}\n        header=\"No Free VBrowsers Available\"\n        content={\n          <div>\n            <div>All of the free VBrowsers are currently being used.</div>\n            <div>\n              Please consider subscribing for anytime access to faster\n              VBrowsers, or try again later.\n            </div>\n          </div>\n        }\n      />\n    );\n\n    const subscribeButton = !this.props.isSubscriber ? (\n      <SubscribeButton user={this.props.user} />\n    ) : null;\n\n    return (\n      <GoogleReCaptchaProvider\n        reCaptchaKey={process.env.REACT_APP_RECAPTCHA_SITE_KEY as string}\n        useRecaptchaNet\n      >\n        <Modal open={true} onClose={closeModal}>\n          <Modal.Header>Launch a VBrowser</Modal.Header>\n          <Modal.Content image>\n            <Modal.Description>\n              <div>\n                You're about to launch a virtual browser to share in this room.\n              </div>\n              <Table definition unstackable striped celled>\n                <Table.Header>\n                  <Table.Row>\n                    <Table.HeaderCell />\n                    <Table.HeaderCell>WatchParty Free</Table.HeaderCell>\n                    <Table.HeaderCell>WatchParty Plus</Table.HeaderCell>\n                  </Table.Row>\n                </Table.Header>\n\n                <Table.Body>\n                  <Table.Row>\n                    <Table.Cell>VBrowser Max Resolution</Table.Cell>\n                    <Table.Cell>720p</Table.Cell>\n                    <Table.Cell>1080p</Table.Cell>\n                  </Table.Row>\n                  <Table.Row>\n                    <Table.Cell>VBrowser CPU/RAM</Table.Cell>\n                    <Table.Cell>Standard</Table.Cell>\n                    <Table.Cell>Extra</Table.Cell>\n                  </Table.Row>\n                  <Table.Row>\n                    <Table.Cell>VBrowser Session Length</Table.Cell>\n                    <Table.Cell>3 hours</Table.Cell>\n                    <Table.Cell>24 hours</Table.Cell>\n                  </Table.Row>\n                  <Table.Row>\n                    <Table.Cell>Recommended Max Viewers</Table.Cell>\n                    <Table.Cell>15</Table.Cell>\n                    <Table.Cell>30</Table.Cell>\n                  </Table.Row>\n                  <Table.Row>\n                    <Table.Cell>Region</Table.Cell>\n                    <Table.Cell>Where available </Table.Cell>\n                    <Table.Cell>\n                      <Dropdown\n                        selection\n                        onChange={(e, { value }) =>\n                          this.setState({ region: value })\n                        }\n                        value={this.state.region}\n                        options={regionOptions}\n                      ></Dropdown>\n                    </Table.Cell>\n                  </Table.Row>\n                  <Table.Row>\n                    <Table.Cell></Table.Cell>\n                    <Table.Cell>\n                      {this.props.user ? (\n                        this.state.isFreePoolFull ? (\n                          vmPoolFullMessage\n                        ) : (\n                          <LaunchButton />\n                        )\n                      ) : (\n                        <SignInButton\n                          fluid\n                          user={this.props.user}\n                          isSubscriber={this.props.isSubscriber}\n                        />\n                      )}\n                    </Table.Cell>\n                    <Table.Cell>\n                      {this.props.isSubscriber ? (\n                        <LaunchButton large />\n                      ) : (\n                        subscribeButton\n                      )}\n                    </Table.Cell>\n                  </Table.Row>\n                </Table.Body>\n              </Table>\n            </Modal.Description>\n          </Modal.Content>\n        </Modal>\n      </GoogleReCaptchaProvider>\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}