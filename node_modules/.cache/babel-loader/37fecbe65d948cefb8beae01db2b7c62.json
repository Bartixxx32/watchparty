{"ast":null,"code":"import _regeneratorRuntime from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useCallback,useState}from'react';import{Button,Icon,Popup}from'semantic-ui-react';import{serverPath}from'../../utils';import{SubscribeModal}from'../Modal/SubscribeModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var SubscribeButton=function SubscribeButton(_ref){var user=_ref.user;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isSubscribeModalOpen=_useState2[0],setIsSubscribeModalOpen=_useState2[1];return/*#__PURE__*/_jsxs(_Fragment,{children:[isSubscribeModalOpen&&/*#__PURE__*/_jsx(SubscribeModal,{user:user,closeSubscribe:function closeSubscribe(){return setIsSubscribeModalOpen(false);}}),/*#__PURE__*/_jsx(Popup,{content:\"Subscribe to help support us and enable additional features!\",trigger:/*#__PURE__*/_jsxs(Button,{fluid:true,color:\"orange\",className:\"toolButton\",icon:true,labelPosition:\"left\",onClick:function onClick(){return setIsSubscribeModalOpen(true);},children:[/*#__PURE__*/_jsx(Icon,{name:\"plus\"}),\"Subscribe\"]})})]});};export var ManageSubButton=function ManageSubButton(_ref2){var user=_ref2.user;var onManage=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var resp,session;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=window;_context.t1=serverPath+'/manageSub';_context.t2={'Content-Type':'application/json'};_context.t3=JSON;_context.t4=user===null||user===void 0?void 0:user.uid;_context.next=7;return user===null||user===void 0?void 0:user.getIdToken();case 7:_context.t5=_context.sent;_context.t6=window.location.href;_context.t7={uid:_context.t4,token:_context.t5,return_url:_context.t6};_context.t8=_context.t3.stringify.call(_context.t3,_context.t7);_context.t9={method:'POST',headers:_context.t2,body:_context.t8};_context.next=14;return _context.t0.fetch.call(_context.t0,_context.t1,_context.t9);case 14:resp=_context.sent;_context.next=17;return resp.json();case 17:session=_context.sent;console.log(session);window.location.assign(session.url);case 20:case\"end\":return _context.stop();}}},_callee);})),[user]);return/*#__PURE__*/_jsxs(Button,{fluid:true,color:\"orange\",className:\"toolButton\",icon:true,labelPosition:\"left\",onClick:onManage,children:[/*#__PURE__*/_jsx(Icon,{name:\"wrench\"}),\"Manage Subscription\"]});};","map":{"version":3,"names":["React","useCallback","useState","Button","Icon","Popup","serverPath","SubscribeModal","SubscribeButton","user","isSubscribeModalOpen","setIsSubscribeModalOpen","ManageSubButton","onManage","window","JSON","uid","getIdToken","location","href","token","return_url","stringify","method","headers","body","fetch","resp","json","session","console","log","assign","url"],"sources":["/home/runner/work/watchparty/watchparty/src/components/SubscribeButton/SubscribeButton.tsx"],"sourcesContent":["import React, { useCallback, useState } from 'react';\nimport { Button, Icon, Popup } from 'semantic-ui-react';\nimport { serverPath } from '../../utils';\nimport { SubscribeModal } from '../Modal/SubscribeModal';\nimport firebase from 'firebase/compat/app';\n\nexport const SubscribeButton = ({\n  user,\n}: {\n  user: firebase.User | undefined;\n}) => {\n  const [isSubscribeModalOpen, setIsSubscribeModalOpen] = useState(false);\n  return (\n    <>\n      {isSubscribeModalOpen && (\n        <SubscribeModal\n          user={user}\n          closeSubscribe={() => setIsSubscribeModalOpen(false)}\n        />\n      )}\n      <Popup\n        content=\"Subscribe to help support us and enable additional features!\"\n        trigger={\n          <Button\n            fluid\n            color=\"orange\"\n            className=\"toolButton\"\n            icon\n            labelPosition=\"left\"\n            onClick={() => setIsSubscribeModalOpen(true)}\n          >\n            <Icon name=\"plus\" />\n            Subscribe\n          </Button>\n        }\n      />\n    </>\n  );\n};\n\nexport const ManageSubButton = ({\n  user,\n}: {\n  user: firebase.User | undefined;\n}) => {\n  const onManage = useCallback(async () => {\n    const resp = await window.fetch(serverPath + '/manageSub', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        uid: user?.uid,\n        token: await user?.getIdToken(),\n        return_url: window.location.href,\n      }),\n    });\n    const session = await resp.json();\n    console.log(session);\n    window.location.assign(session.url);\n  }, [user]);\n  return (\n    <Button\n      fluid\n      color=\"orange\"\n      className=\"toolButton\"\n      icon\n      labelPosition=\"left\"\n      onClick={onManage}\n    >\n      <Icon name=\"wrench\" />\n      Manage Subscription\n    </Button>\n  );\n};\n"],"mappings":"uYAAA,MAAOA,MAAP,EAAgBC,WAAhB,CAA6BC,QAA7B,KAA6C,OAA7C,CACA,OAASC,MAAT,CAAiBC,IAAjB,CAAuBC,KAAvB,KAAoC,mBAApC,CACA,OAASC,UAAT,KAA2B,aAA3B,CACA,OAASC,cAAT,KAA+B,yBAA/B,C,6IAGA,MAAO,IAAMC,gBAAe,CAAG,QAAlBA,gBAAkB,MAIzB,IAHJC,KAGI,MAHJA,IAGI,CACJ,cAAwDP,QAAQ,CAAC,KAAD,CAAhE,wCAAOQ,oBAAP,eAA6BC,uBAA7B,eACA,mBACE,2BACGD,oBAAoB,eACnB,KAAC,cAAD,EACE,IAAI,CAAED,IADR,CAEE,cAAc,CAAE,gCAAME,wBAAuB,CAAC,KAAD,CAA7B,EAFlB,EAFJ,cAOE,KAAC,KAAD,EACE,OAAO,CAAC,8DADV,CAEE,OAAO,cACL,MAAC,MAAD,EACE,KAAK,KADP,CAEE,KAAK,CAAC,QAFR,CAGE,SAAS,CAAC,YAHZ,CAIE,IAAI,KAJN,CAKE,aAAa,CAAC,MALhB,CAME,OAAO,CAAE,yBAAMA,wBAAuB,CAAC,IAAD,CAA7B,EANX,wBAQE,KAAC,IAAD,EAAM,IAAI,CAAC,MAAX,EARF,eAHJ,EAPF,GADF,CA0BD,CAhCM,CAkCP,MAAO,IAAMC,gBAAe,CAAG,QAAlBA,gBAAkB,OAIzB,IAHJH,KAGI,OAHJA,IAGI,CACJ,GAAMI,SAAQ,CAAGZ,WAAW,wEAAC,kKACRa,MADQ,aACKR,UAAU,CAAG,YADlB,aAGhB,CACP,eAAgB,kBADT,CAHgB,aAMnBS,IANmB,aAOlBN,IAPkB,SAOlBA,IAPkB,iBAOlBA,IAAI,CAAEO,GAPY,uBAQVP,KARU,SAQVA,IARU,iBAQVA,IAAI,CAAEQ,UAAN,EARU,8CASXH,MAAM,CAACI,QAAP,CAAgBC,IATL,cAOvBH,GAPuB,aAQvBI,KARuB,aASvBC,UATuB,sCAMdC,SANc,4CAEzBC,MAFyB,CAEjB,MAFiB,CAGzBC,OAHyB,aAMzBC,IANyB,kDACDC,KADC,mDACrBC,IADqB,sCAYLA,KAAI,CAACC,IAAL,EAZK,SAYrBC,OAZqB,eAa3BC,OAAO,CAACC,GAAR,CAAYF,OAAZ,EACAf,MAAM,CAACI,QAAP,CAAgBc,MAAhB,CAAuBH,OAAO,CAACI,GAA/B,EAd2B,uDAAD,GAezB,CAACxB,IAAD,CAfyB,CAA5B,CAgBA,mBACE,MAAC,MAAD,EACE,KAAK,KADP,CAEE,KAAK,CAAC,QAFR,CAGE,SAAS,CAAC,YAHZ,CAIE,IAAI,KAJN,CAKE,aAAa,CAAC,MALhB,CAME,OAAO,CAAEI,QANX,wBAQE,KAAC,IAAD,EAAM,IAAI,CAAC,QAAX,EARF,yBADF,CAaD,CAlCM"},"metadata":{},"sourceType":"module"}