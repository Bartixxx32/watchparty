{"ast":null,"code":"import _regeneratorRuntime from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import'./index.css';import React,{lazy,Suspense}from'react';import{createRoot}from'react-dom/client';import{BrowserRouter,Route}from'react-router-dom';import App from'./components/App';import{Home}from'./components/Home';import{Privacy,Terms,FAQ,DiscordBot}from'./components/Pages/Pages';import{TopBar}from'./components/TopBar/TopBar';import{Footer}from'./components/Footer/Footer';import*as serviceWorker from'./serviceWorker';import firebase from'firebase/compat/app';import'firebase/auth';import{serverPath}from'./utils';import{Create}from'./components/Create/Create';import{Discord}from'./components/Discord/Discord';import'semantic-ui-css/semantic.min.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Debug=/*#__PURE__*/lazy(function(){return import('./components/Debug/Debug');});var firebaseConfig=process.env.REACT_APP_FIREBASE_CONFIG;if(firebaseConfig){firebase.initializeApp(JSON.parse(firebaseConfig));}// Redirect old-style URLs\nif(window.location.hash){var hashRoomId=window.location.hash.substring(1);window.location.href='/watch/'+hashRoomId;}var WatchParty=/*#__PURE__*/function(_React$Component){_inherits(WatchParty,_React$Component);var _super=_createSuper(WatchParty);function WatchParty(){var _this;_classCallCheck(this,WatchParty);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={user:undefined,isSubscriber:false,isCustomer:false,streamPath:undefined,beta:false};return _this;}_createClass(WatchParty,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var _this2=this;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(firebaseConfig){firebase.auth().onAuthStateChanged(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(user){var token,response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!user){_context.next=12;break;}// console.log(user);\n_this2.setState({user:user});_context.next=4;return user.getIdToken();case 4:token=_context.sent;_context.next=7;return window.fetch(serverPath+\"/metadata?uid=\".concat(user.uid,\"&token=\").concat(token));case 7:response=_context.sent;_context.next=10;return response.json();case 10:data=_context.sent;_this2.setState({isSubscriber:data.isSubscriber,isCustomer:data.isCustomer,streamPath:data.streamPath,beta:data.beta});case 12:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());}case 1:case\"end\":return _context2.stop();}}},_callee2);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this3=this;return/*#__PURE__*/ (// <React.StrictMode>\n_jsxs(BrowserRouter,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",exact:true,render:function render(props){return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(TopBar,{user:_this3.state.user,isSubscriber:_this3.state.isSubscriber,hideNewRoom:true}),/*#__PURE__*/_jsx(Home,{user:_this3.state.user}),/*#__PURE__*/_jsx(Footer,{})]});}}),/*#__PURE__*/_jsx(Route,{path:\"/create\",exact:true,render:function render(){return/*#__PURE__*/_jsx(Create,{user:_this3.state.user});}}),/*#__PURE__*/_jsx(Route,{path:\"/watch/:roomId\",exact:true,render:function render(props){return/*#__PURE__*/_jsx(App,{user:_this3.state.user,isSubscriber:_this3.state.isSubscriber,urlRoomId:props.match.params.roomId,streamPath:_this3.state.streamPath,beta:_this3.state.beta});}}),/*#__PURE__*/_jsx(Route,{path:\"/r/:vanity\",exact:true,render:function render(props){return/*#__PURE__*/_jsx(App,{user:_this3.state.user,isSubscriber:_this3.state.isSubscriber,vanity:props.match.params.vanity,streamPath:_this3.state.streamPath,beta:_this3.state.beta});}}),/*#__PURE__*/_jsxs(Route,{path:\"/terms\",children:[/*#__PURE__*/_jsx(TopBar,{user:this.state.user,isSubscriber:this.state.isSubscriber}),/*#__PURE__*/_jsx(Terms,{}),/*#__PURE__*/_jsx(Footer,{})]}),/*#__PURE__*/_jsxs(Route,{path:\"/privacy\",children:[/*#__PURE__*/_jsx(TopBar,{user:this.state.user,isSubscriber:this.state.isSubscriber}),/*#__PURE__*/_jsx(Privacy,{}),/*#__PURE__*/_jsx(Footer,{})]}),/*#__PURE__*/_jsxs(Route,{path:\"/faq\",children:[/*#__PURE__*/_jsx(TopBar,{user:this.state.user,isSubscriber:this.state.isSubscriber}),/*#__PURE__*/_jsx(FAQ,{}),/*#__PURE__*/_jsx(Footer,{})]}),/*#__PURE__*/_jsxs(Route,{path:\"/discordBot\",children:[/*#__PURE__*/_jsx(TopBar,{user:this.state.user,isSubscriber:this.state.isSubscriber}),/*#__PURE__*/_jsx(DiscordBot,{}),/*#__PURE__*/_jsx(Footer,{})]}),/*#__PURE__*/_jsx(Route,{path:\"/discord/auth\",exact:true,children:/*#__PURE__*/_jsx(Discord,{user:this.state.user})}),/*#__PURE__*/_jsxs(Route,{path:\"/debug\",children:[/*#__PURE__*/_jsx(TopBar,{user:this.state.user,isSubscriber:this.state.isSubscriber}),/*#__PURE__*/_jsx(Suspense,{fallback:null,children:/*#__PURE__*/_jsx(Debug,{})}),/*#__PURE__*/_jsx(Footer,{})]})]})// </React.StrictMode>\n);}}]);return WatchParty;}(React.Component);var container=document.getElementById('root');var root=createRoot(container);root.render(/*#__PURE__*/_jsx(WatchParty,{}));// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();","map":{"version":3,"names":["React","lazy","Suspense","createRoot","BrowserRouter","Route","App","Home","Privacy","Terms","FAQ","DiscordBot","TopBar","Footer","serviceWorker","firebase","serverPath","Create","Discord","Debug","firebaseConfig","process","env","REACT_APP_FIREBASE_CONFIG","initializeApp","JSON","parse","window","location","hash","hashRoomId","substring","href","WatchParty","state","user","undefined","isSubscriber","isCustomer","streamPath","beta","auth","onAuthStateChanged","setState","getIdToken","token","fetch","uid","response","json","data","props","match","params","roomId","vanity","Component","container","document","getElementById","root","render","unregister"],"sources":["/home/runner/work/watchparty/watchparty/src/index.tsx"],"sourcesContent":["import './index.css';\n\nimport React, { lazy, Suspense } from 'react';\nimport { createRoot } from 'react-dom/client';\nimport { BrowserRouter, Route } from 'react-router-dom';\n\nimport App from './components/App';\nimport { Home } from './components/Home';\nimport { Privacy, Terms, FAQ, DiscordBot } from './components/Pages/Pages';\nimport { TopBar } from './components/TopBar/TopBar';\nimport { Footer } from './components/Footer/Footer';\nimport * as serviceWorker from './serviceWorker';\nimport firebase from 'firebase/compat/app';\nimport 'firebase/auth';\nimport { serverPath } from './utils';\nimport { Create } from './components/Create/Create';\nimport { Discord } from './components/Discord/Discord';\nimport 'semantic-ui-css/semantic.min.css';\n\nconst Debug = lazy(() => import('./components/Debug/Debug'));\n\nconst firebaseConfig = process.env.REACT_APP_FIREBASE_CONFIG;\nif (firebaseConfig) {\n  firebase.initializeApp(JSON.parse(firebaseConfig));\n}\n\n// Redirect old-style URLs\nif (window.location.hash) {\n  const hashRoomId = window.location.hash.substring(1);\n  window.location.href = '/watch/' + hashRoomId;\n}\n\nclass WatchParty extends React.Component {\n  public state = {\n    user: undefined as firebase.User | undefined,\n    isSubscriber: false,\n    isCustomer: false,\n    streamPath: undefined as string | undefined,\n    beta: false,\n  };\n  async componentDidMount() {\n    if (firebaseConfig) {\n      firebase.auth().onAuthStateChanged(async (user: firebase.User | null) => {\n        if (user) {\n          // console.log(user);\n          this.setState({ user });\n          const token = await user.getIdToken();\n          const response = await window.fetch(\n            serverPath + `/metadata?uid=${user.uid}&token=${token}`\n          );\n          const data = await response.json();\n          this.setState({\n            isSubscriber: data.isSubscriber,\n            isCustomer: data.isCustomer,\n            streamPath: data.streamPath,\n            beta: data.beta,\n          });\n        }\n      });\n    }\n  }\n  render() {\n    return (\n      // <React.StrictMode>\n      <BrowserRouter>\n        <Route\n          path=\"/\"\n          exact\n          render={(props) => {\n            return (\n              <React.Fragment>\n                <TopBar\n                  user={this.state.user}\n                  isSubscriber={this.state.isSubscriber}\n                  hideNewRoom\n                />\n                <Home user={this.state.user} />\n                <Footer />\n              </React.Fragment>\n            );\n          }}\n        />\n        <Route\n          path=\"/create\"\n          exact\n          render={() => {\n            return <Create user={this.state.user} />;\n          }}\n        />\n        <Route\n          path=\"/watch/:roomId\"\n          exact\n          render={(props) => {\n            return (\n              <App\n                user={this.state.user}\n                isSubscriber={this.state.isSubscriber}\n                urlRoomId={props.match.params.roomId}\n                streamPath={this.state.streamPath}\n                beta={this.state.beta}\n              />\n            );\n          }}\n        />\n        <Route\n          path=\"/r/:vanity\"\n          exact\n          render={(props) => {\n            return (\n              <App\n                user={this.state.user}\n                isSubscriber={this.state.isSubscriber}\n                vanity={props.match.params.vanity}\n                streamPath={this.state.streamPath}\n                beta={this.state.beta}\n              />\n            );\n          }}\n        />\n        <Route path=\"/terms\">\n          <TopBar\n            user={this.state.user}\n            isSubscriber={this.state.isSubscriber}\n          />\n          <Terms />\n          <Footer />\n        </Route>\n        <Route path=\"/privacy\">\n          <TopBar\n            user={this.state.user}\n            isSubscriber={this.state.isSubscriber}\n          />\n          <Privacy />\n          <Footer />\n        </Route>\n        <Route path=\"/faq\">\n          <TopBar\n            user={this.state.user}\n            isSubscriber={this.state.isSubscriber}\n          />\n          <FAQ />\n          <Footer />\n        </Route>\n        <Route path=\"/discordBot\">\n          <TopBar\n            user={this.state.user}\n            isSubscriber={this.state.isSubscriber}\n          />\n          <DiscordBot />\n          <Footer />\n        </Route>\n        <Route path=\"/discord/auth\" exact>\n          <Discord user={this.state.user} />\n        </Route>\n        <Route path=\"/debug\">\n          <TopBar\n            user={this.state.user}\n            isSubscriber={this.state.isSubscriber}\n          />\n          <Suspense fallback={null}>\n            <Debug />\n          </Suspense>\n          <Footer />\n        </Route>\n      </BrowserRouter>\n      // </React.StrictMode>\n    );\n  }\n}\nconst container = document.getElementById('root');\nconst root = createRoot(container!);\nroot.render(<WatchParty />);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}