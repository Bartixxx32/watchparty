{"ast":null,"code":"import _regeneratorRuntime from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/runner/work/watchparty/watchparty/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{Menu,Icon,Label,Button}from'semantic-ui-react';import{decodeEntities,formatSize}from'../../utils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var YouTubeSearchResult=function YouTubeSearchResult(props){var result=props;var setMedia=props.setMedia;return/*#__PURE__*/_jsx(Menu.Item,{onClick:function onClick(e){setMedia(e,{value:result.url});},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(\"img\",{style:{height:'50px'},src:result.img,alt:result.name}),/*#__PURE__*/_jsx(Icon,{color:\"red\",size:\"large\",name:\"youtube\"}),/*#__PURE__*/_jsx(\"div\",{children:decodeEntities(result.name)}),/*#__PURE__*/_jsx(\"div\",{style:{marginLeft:'auto'},children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(e){e.stopPropagation();e.nativeEvent.stopImmediatePropagation();props.playlistAdd(e,{value:result.url});},children:\"Add To Playlist\"})})]})});};export var MediaPathSearchResult=function MediaPathSearchResult(props){var result=props;var setMedia=props.setMedia;return/*#__PURE__*/_jsx(Menu.Item,{onClick:function onClick(e){setMedia(e,{value:result.url});},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex'},children:[/*#__PURE__*/_jsx(Icon,{name:\"file\"}),result.name]})});};export var StreamPathSearchResult=/*#__PURE__*/function(_React$Component){_inherits(StreamPathSearchResult,_React$Component);var _super=_createSuper(StreamPathSearchResult);function StreamPathSearchResult(){_classCallCheck(this,StreamPathSearchResult);return _super.apply(this,arguments);}_createClass(StreamPathSearchResult,[{key:\"render\",value:function render(){var _this=this;var result=this.props;var setMedia=this.props.setMedia;return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(Menu.Item,{onClick:/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var response,metadata,multiStreamSelection;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(_this.props.launchMultiSelect){_this.props.launchMultiSelect([]);}_context.next=3;return window.fetch(_this.props.streamPath+'/data?torrent='+encodeURIComponent(result.magnet));case 3:response=_context.sent;_context.next=6;return response.json();case 6:metadata=_context.sent;// console.log(metadata);\nif(metadata.files.filter(function(file){return file.length>10*1024*1024;}).length>1){// Multiple large files, present user selection\nmultiStreamSelection=metadata.files.map(function(file,i){return _objectSpread(_objectSpread({},file),{},{url:_this.props.streamPath+'/stream?torrent='+encodeURIComponent(result.magnet)+'&fileIndex='+i});});// multiStreamSelection.sort((a: any, b: any) =>\n//   a.name.localeCompare(b.name)\n// );\nif(_this.props.launchMultiSelect){_this.props.launchMultiSelect(multiStreamSelection);}}else{if(_this.props.launchMultiSelect){_this.props.launchMultiSelect(undefined);}setMedia(e,{value:_this.props.streamPath+'/stream?torrent='+encodeURIComponent(result.magnet)});}case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}(),children:[/*#__PURE__*/_jsx(Label,{circular:true,empty:true,color:Number(result.seeders)?'green':'red'}),/*#__PURE__*/_jsx(Icon,{name:\"film\"}),result.name+' - '+(typeof result.size==='number'?formatSize(result.size):result.size)+' - '+result.seeders+' peers']})});}}]);return StreamPathSearchResult;}(React.Component);","map":{"version":3,"names":["React","Menu","Icon","Label","Button","decodeEntities","formatSize","YouTubeSearchResult","props","result","setMedia","e","value","url","display","alignItems","gap","height","img","name","marginLeft","stopPropagation","nativeEvent","stopImmediatePropagation","playlistAdd","MediaPathSearchResult","StreamPathSearchResult","launchMultiSelect","window","fetch","streamPath","encodeURIComponent","magnet","response","json","metadata","files","filter","file","length","multiStreamSelection","map","i","undefined","Number","seeders","size","Component"],"sources":["/home/runner/work/watchparty/watchparty/src/components/SearchResult/SearchResult.tsx"],"sourcesContent":["import React from 'react';\nimport { Menu, Icon, Label, Button, DropdownProps } from 'semantic-ui-react';\nimport { decodeEntities, formatSize } from '../../utils';\n\nexport const YouTubeSearchResult = (\n  props: SearchResult & {\n    setMedia: (_e: any, data: DropdownProps) => void;\n    playlistAdd: (_e: any, data: DropdownProps) => void;\n  }\n) => {\n  const result = props;\n  const setMedia = props.setMedia;\n  return (\n    <Menu.Item\n      onClick={(e) => {\n        setMedia(e, { value: result.url });\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n        <img style={{ height: '50px' }} src={result.img} alt={result.name} />\n        <Icon color=\"red\" size=\"large\" name=\"youtube\" />\n        <div>{decodeEntities(result.name)}</div>\n        <div style={{ marginLeft: 'auto' }}>\n          <Button\n            onClick={(e) => {\n              e.stopPropagation();\n              e.nativeEvent.stopImmediatePropagation();\n              props.playlistAdd(e, { value: result.url });\n            }}\n          >\n            Add To Playlist\n          </Button>\n        </div>\n      </div>\n    </Menu.Item>\n  );\n};\n\nexport const MediaPathSearchResult = (\n  props: SearchResult & { setMedia: (_e: any, data: DropdownProps) => void }\n) => {\n  const result = props;\n  const setMedia = props.setMedia;\n  return (\n    <Menu.Item\n      onClick={(e) => {\n        setMedia(e, { value: result.url });\n      }}\n    >\n      <div style={{ display: 'flex' }}>\n        <Icon name=\"file\" />\n        {result.name}\n      </div>\n    </Menu.Item>\n  );\n};\n\nexport class StreamPathSearchResult extends React.Component<\n  SearchResult & {\n    setMedia: (_e: any, data: DropdownProps) => void;\n    launchMultiSelect?: (multi?: []) => void;\n    streamPath: string;\n  }\n> {\n  render() {\n    const result = this.props;\n    const setMedia = this.props.setMedia;\n    return (\n      <React.Fragment>\n        <Menu.Item\n          onClick={async (e) => {\n            if (this.props.launchMultiSelect) {\n              this.props.launchMultiSelect([]);\n            }\n            let response = await window.fetch(\n              this.props.streamPath +\n                '/data?torrent=' +\n                encodeURIComponent(result.magnet!)\n            );\n            let metadata = await response.json();\n            // console.log(metadata);\n            if (\n              metadata.files.filter(\n                (file: any) => file.length > 10 * 1024 * 1024\n              ).length > 1\n            ) {\n              // Multiple large files, present user selection\n              const multiStreamSelection = metadata.files.map(\n                (file: any, i: number) => ({\n                  ...file,\n                  url:\n                    this.props.streamPath +\n                    '/stream?torrent=' +\n                    encodeURIComponent(result.magnet!) +\n                    '&fileIndex=' +\n                    i,\n                })\n              );\n              // multiStreamSelection.sort((a: any, b: any) =>\n              //   a.name.localeCompare(b.name)\n              // );\n              if (this.props.launchMultiSelect) {\n                this.props.launchMultiSelect(multiStreamSelection);\n              }\n            } else {\n              if (this.props.launchMultiSelect) {\n                this.props.launchMultiSelect(undefined);\n              }\n              setMedia(e, {\n                value:\n                  this.props.streamPath +\n                  '/stream?torrent=' +\n                  encodeURIComponent(result.magnet!),\n              });\n            }\n          }}\n        >\n          <Label\n            circular\n            empty\n            color={Number(result.seeders) ? 'green' : 'red'}\n          />\n          <Icon name=\"film\" />\n          {result.name +\n            ' - ' +\n            (typeof result.size === 'number'\n              ? formatSize(result.size)\n              : result.size) +\n            ' - ' +\n            result.seeders +\n            ' peers'}\n        </Menu.Item>\n      </React.Fragment>\n    );\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}