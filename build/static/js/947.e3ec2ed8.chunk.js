/*! For license information please see 947.e3ec2ed8.chunk.js.LICENSE.txt */
(self.webpackChunkwatchparty=self.webpackChunkwatchparty||[]).push([[947],{1836:function(e,t,r){"use strict";var n=r(6690).default,a=r(9728).default,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var s=i(r(3486)),c="awaitqueue",o=function(){function e(t){n(this,e),t?(this._debug=(0,s.default)("".concat(c,":").concat(t)),this._warn=(0,s.default)("".concat(c,":WARN:").concat(t)),this._error=(0,s.default)("".concat(c,":ERROR:").concat(t))):(this._debug=(0,s.default)(c),this._warn=(0,s.default)("".concat(c,":WARN")),this._error=(0,s.default)("".concat(c,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return a(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}();t.Logger=o},9647:function(e,t,r){"use strict";var n=r(4704).default,a=r(7061).default,i=r(7424).default,s=r(7156).default,c=r(9728).default,o=r(6690).default,u=r(6115).default,d=r(1655).default,p=r(6389).default,l=r(3496).default;Object.defineProperty(t,"__esModule",{value:!0}),t.AwaitQueue=t.AwaitQueueRemovedTaskError=t.AwaitQueueStoppedError=void 0;var f=new(r(1836).Logger),h=function(e){d(r,e);var t=p(r);function r(e){var n;return o(this,r),(n=t.call(this,null!==e&&void 0!==e?e:"AwaitQueue stopped")).name="AwaitQueueStoppedError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(u(n),r),n}return c(r)}(l(Error));t.AwaitQueueStoppedError=h;var m=function(e){d(r,e);var t=p(r);function r(e){var n;return o(this,r),(n=t.call(this,null!==e&&void 0!==e?e:"AwaitQueue task removed")).name="AwaitQueueRemovedTaskError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(u(n),r),n}return c(r)}(l(Error));t.AwaitQueueRemovedTaskError=m;var v=function(){function e(){o(this,e),this.pendingTasks=new Map,this.nextTaskId=0,this.stopping=!1}return c(e,[{key:"size",get:function(){return this.pendingTasks.size}},{key:"push",value:function(){var e=s(a().mark((function e(t,r){var n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null!==r&&void 0!==r?r:t.name,f.debug("push() [name:".concat(r,"]")),"function"===typeof t){e.next=4;break}throw new TypeError("given task is not a function");case 4:if(r)try{Object.defineProperty(t,"name",{value:r})}catch(a){}return e.abrupt("return",new Promise((function(e,a){var s={id:n.nextTaskId++,task:t,name:r,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:function(t){if(!s.completed){s.completed=!0,n.pendingTasks.delete(s.id),f.debug("resolving task [name:".concat(s.name,"]")),e(t);var r=n.pendingTasks.values(),a=i(r,1)[0];a&&!a.executedAt&&n.execute(a)}},reject:function(e){if(!s.completed&&(s.completed=!0,n.pendingTasks.delete(s.id),f.debug("rejecting task [name:".concat(s.name,"]: %s"),String(e)),a(e),!n.stopping)){var t=n.pendingTasks.values(),r=i(t,1)[0];r&&!r.executedAt&&n.execute(r)}}};n.pendingTasks.set(s.id,s),1===n.pendingTasks.size&&n.execute(s)})));case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"stop",value:function(){f.debug("stop()"),this.stopping=!0;var e,t=n(this.pendingTasks.values());try{for(t.s();!(e=t.n()).done;){var r=e.value;f.debug("stop() | stopping task [name:".concat(r.name,"]")),r.reject(new h)}}catch(a){t.e(a)}finally{t.f()}this.stopping=!1}},{key:"remove",value:function(e){f.debug("remove() [taskIdx:".concat(e,"]"));var t=Array.from(this.pendingTasks.values())[e];t?t.reject(new m):f.debug("stop() | no task with given idx [taskIdx:".concat(e,"]"))}},{key:"dump",value:function(){var e=Date.now(),t=0;return Array.from(this.pendingTasks.values()).map((function(r){return{idx:t++,task:r.task,name:r.name,enqueuedTime:r.executedAt?r.executedAt-r.enqueuedAt:e-r.enqueuedAt,executionTime:r.executedAt?e-r.executedAt:0}}))}},{key:"execute",value:function(){var e=s(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f.debug("execute() [name:".concat(t.name,"]")),!t.executedAt){e.next=3;break}throw new Error("task already being executed");case 3:return t.executedAt=Date.now(),e.prev=4,e.next=7,t.task();case 7:r=e.sent,t.resolve(r),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),t.reject(e.t0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();t.AwaitQueue=v},3486:function(e,t,r){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,a=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(a=n))})),t.splice(a,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(r){}!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_STRIPE_PUBLIC_KEY:"pk_live_eVMbIifj5lnvgBleBCRaCv4E00aeXQkPxQ",REACT_APP_RECAPTCHA_SITE_KEY:"6LeDGP4UAAAAAGYZZenyU-3fRdhL3p0BaBmiK9mM",REACT_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyA2fkXeFokJ-Ei_jnzDso5AmjbIaMdzuEc","authDomain":"watchparty-273604.firebaseapp.com","databaseURL":"https://watchparty-273604.firebaseio.com","projectId":"watchparty-273604","storageBucket":"watchparty-273604.appspot.com","messagingSenderId":"769614672795","appId":"1:769614672795:web:54bbda86288ab1a034273e"}'}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=r(1209)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},1209:function(e,t,r){var n=r(861).default;e.exports=function(e){function t(e){var r,n,i,s=null;function c(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(c.enabled){var i=c,s=Number(new Date),o=s-(r||s);i.diff=o,i.prev=r,i.curr=s,r=s,n[0]=t.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");var u=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";u++;var a=t.formatters[r];if("function"===typeof a){var s=n[u];e=a.call(i,s),n.splice(u,1),u--}return e})),t.formatArgs.call(i,n);var d=i.log||t.log;d.apply(i,n)}}return c.namespace=e,c.useColors=t.useColors(),c.color=t.selectColor(e),c.extend=a,c.destroy=t.destroy,Object.defineProperty(c,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==s?s:(n!==t.namespaces&&(n=t.namespaces,i=t.enabled(e)),i)},set:function(e){s=e}}),"function"===typeof t.init&&t.init(c),c}function a(e,r){var n=t(this.namespace+("undefined"===typeof r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(n(t.names.map(i)),n(t.skips.map(i).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var n=("string"===typeof e?e:"").split(/[\s,]+/),a=n.length;for(r=0;r<a;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(421),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},421:function(e){var t=1e3,r=60*t,n=60*r,a=24*n,i=7*a,s=365.25*a;function c(e,t,r,n){var a=t>=1.5*r;return Math.round(e/r)+" "+n+(a?"s":"")}e.exports=function(e,o){o=o||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var c=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!c)return;var o=parseFloat(c[1]);switch((c[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return o*s;case"weeks":case"week":case"w":return o*i;case"days":case"day":case"d":return o*a;case"hours":case"hour":case"hrs":case"hr":case"h":return o*n;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===u&&isFinite(e))return o.long?function(e){var i=Math.abs(e);if(i>=a)return c(e,i,a,"day");if(i>=n)return c(e,i,n,"hour");if(i>=r)return c(e,i,r,"minute");if(i>=t)return c(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=a)return Math.round(e/a)+"d";if(i>=n)return Math.round(e/n)+"h";if(i>=r)return Math.round(e/r)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},5524:function(e){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}({17:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=r(18),a=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||""},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||""},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,r,n){void 0===n&&(n=!1);var a=e.getVersionPrecision(t),i=e.getVersionPrecision(r),s=Math.max(a,i),c=0,o=e.map([t,r],(function(t){var r=s-e.getVersionPrecision(t),n=t+new Array(r+1).join(".0");return e.map(n.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(n&&(c=s-Math.min(a,i)),s-=1;s>=c;){if(o[0][s]>o[1][s])return 1;if(o[0][s]===o[1][s]){if(s===c)return 0;s-=1}else if(o[0][s]<o[1][s])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var a=e[r];if(t(a,r))return a}},e.assign=function(e){for(var t,r,n=e,a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(i));var c=function(){var e=i[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))};for(t=0,r=i.length;t<r;t+=1)c();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||""},e}();t.default=a,e.exports=t.default},18:function(e,t,r){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,a=(n=r(91))&&n.__esModule?n:{default:n},i=r(18);function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(){}var t,r,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new a.default(e,t)},e.parse=function(e){return new a.default(e).getResult()},t=e,n=[{key:"BROWSER_MAP",get:function(){return i.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return i.ENGINE_MAP}},{key:"OS_MAP",get:function(){return i.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return i.PLATFORMS_MAP}}],(r=null)&&s(t.prototype,r),n&&s(t,n),e}();t.default=c,e.exports=t.default},91:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=o(r(92)),a=o(r(93)),i=o(r(94)),s=o(r(95)),c=o(r(17));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=c.default.find(n.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=c.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=c.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=c.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return c.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,a={},i=0;if(Object.keys(e).forEach((function(t){var s=e[t];"string"==typeof s?(a[t]=s,i+=1):"object"==typeof s&&(r[t]=s,n+=1)})),n>0){var s=Object.keys(r),o=c.default.find(s,(function(e){return t.isOS(e)}));if(o){var u=this.satisfies(r[o]);if(void 0!==u)return u}var d=c.default.find(s,(function(e){return t.isPlatform(e)}));if(d){var p=this.satisfies(r[d]);if(void 0!==p)return p}}if(i>0){var l=Object.keys(a),f=c.default.find(l,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(a[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),a=c.default.getBrowserTypeByAlias(n);return t&&a&&(n=a.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,a=this.getBrowserVersion();if("string"==typeof a)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(c.default.compareVersions(a,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,a=(n=r(17))&&n.__esModule?n:{default:n},i=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},r=a.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},r=a.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},r=a.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},r=a.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},r=a.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},r=a.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},r=a.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},r=a.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=a.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},r=a.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},r=a.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},r=a.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},r=a.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},r=a.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},r=a.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},r=a.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},r=a.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},r=a.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},r=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},r=a.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},r=a.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},r=a.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},r=a.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},r=a.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},r=a.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},r=a.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},r=a.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},r=a.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:"Android Browser"},r=a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},r=a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},r=a.default.getFirstMatch(i,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:a.default.getFirstMatch(t,e),version:a.default.getSecondMatch(t,e)}}}];t.default=s,e.exports=t.default},93:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,a=(n=r(17))&&n.__esModule?n:{default:n},i=r(18),s=[{test:[/Roku\/DVP/],describe:function(e){var t=a.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:i.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=a.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=a.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=a.default.getWindowsVersionName(t);return{name:i.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:i.OS_MAP.iOS},r=a.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe:function(e){var t=a.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=a.default.getMacOSVersionName(t),n={name:i.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=a.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:i.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=a.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=a.default.getAndroidVersionName(t),n={name:i.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=a.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:i.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=a.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||a.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||a.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:i.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=a.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=a.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:i.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:i.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=a.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.PlayStation4,version:t}}}];t.default=s,e.exports=t.default},94:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,a=(n=r(17))&&n.__esModule?n:{default:n},i=r(18),s=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=a.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:i.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=a.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:i.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}}];t.default=s,e.exports=t.default},95:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,a=(n=r(17))&&n.__esModule?n:{default:n},i=r(18),s=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:i.ENGINE_MAP.Blink};var t=a.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:i.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:i.ENGINE_MAP.Trident},r=a.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:i.ENGINE_MAP.Presto},r=a.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:i.ENGINE_MAP.Gecko},r=a.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:i.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:i.ENGINE_MAP.WebKit},r=a.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=s,e.exports=t.default}})},7465:function(e){"use strict";var t,r="object"===typeof Reflect?Reflect:null,n=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!==e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,n){function a(r){e.removeListener(t,i),n(r)}function i(){"function"===typeof e.removeListener&&e.removeListener("error",a),r([].slice.call(arguments))}m(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&m(e,"error",t,r)}(e,a,{once:!0})}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function c(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function o(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var a,i,s,u;if(c(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"===typeof s?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(a=o(e))>0&&s.length>a&&!s.warned){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=s.length,u=d,console&&console.warn&&console.warn(u)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},a=d.bind(n);return a.listener=r,n.wrapFn=a,a}function l(e,t,r){var n=e._events;if(void 0===n)return[];var a=n[t];return void 0===a?[]:"function"===typeof a?r?[a.listener||a]:[a]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(a):h(a,a.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function h(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function m(e,t,r,n){if("function"===typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function a(i){n.once&&e.removeEventListener(t,a),r(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return o(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var a="error"===e,i=this._events;if(void 0!==i)a=a&&void 0===i.error;else if(!a)return!1;if(a){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var c=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw c.context=s,c}var o=i[e];if(void 0===o)return!1;if("function"===typeof o)n(o,this,t);else{var u=o.length,d=h(o,u);for(r=0;r<u;++r)n(d[r],this,t)}return!0},i.prototype.addListener=function(e,t){return u(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return u(this,e,t,!0)},i.prototype.once=function(e,t){return c(t),this.on(e,p(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,p(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,a,i,s;if(c(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(a=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,a=i;break}if(a<0)return this;0===a?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,a),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var a,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(a=i[n])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return l(this,e,!0)},i.prototype.rawListeners=function(e){return l(this,e,!1)},i.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},i.prototype.listenerCount=f,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},4434:function(e,t,r){var n=r(4704).default,a=r(9728).default,i=r(6690).default,s=r(2696)("h264-profile-level-id");s.log=console.info.bind(console);t.ProfileConstrainedBaseline=1,t.ProfileBaseline=2,t.ProfileMain=3,t.ProfileConstrainedHigh=4,t.ProfileHigh=5;t.Level1_b=0,t.Level1=10,t.Level1_1=11,t.Level1_2=12,t.Level1_3=13,t.Level2=20,t.Level2_1=21,t.Level2_2=22,t.Level3=30,t.Level3_1=31,t.Level3_2=32,t.Level4=40,t.Level4_1=41,t.Level4_2=42,t.Level5=50,t.Level5_1=51,t.Level5_2=52;var c=a((function e(t,r){"use strict";i(this,e),this.profile=t,this.level=r}));t.ProfileLevelId=c;var o=new c(1,31),u=function(){"use strict";function e(t){i(this,e),this._mask=~l("x",t),this._maskedValue=l("1",t)}return a(e,[{key:"isMatch",value:function(e){return this._maskedValue===(e&this._mask)}}]),e}(),d=a((function e(t,r,n){"use strict";i(this,e),this.profile_idc=t,this.profile_iop=r,this.profile=n})),p=[new d(66,new u("x1xx0000"),1),new d(77,new u("1xxx0000"),1),new d(88,new u("11xx0000"),1),new d(66,new u("x0xx0000"),2),new d(88,new u("10xx0000"),2),new d(77,new u("0x0x0000"),3),new d(100,new u("00000000"),5),new d(100,new u("00001100"),4)];function l(e,t){return(t[0]===e)<<7|(t[1]===e)<<6|(t[2]===e)<<5|(t[3]===e)<<4|(t[4]===e)<<3|(t[5]===e)<<2|(t[6]===e)<<1|(t[7]===e)<<0}function f(e,t){return function(e,t){return 0===e?10!==t&&0!==t:0===t?10!==e:e<t}(e,t)?e:t}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e["level-asymmetry-allowed"];return 1===t||"1"===t}t.parseProfileLevelId=function(e){if("string"!==typeof e||6!==e.length)return null;var t=parseInt(e,16);if(0===t)return null;var r,a=255&t,i=t>>8&255,o=t>>16&255;switch(a){case 11:r=0!==(16&i)?0:11;break;case 10:case 12:case 13:case 20:case 21:case 22:case 30:case 31:case 32:case 40:case 41:case 42:case 50:case 51:case 52:r=a;break;default:return s("parseProfileLevelId() | unrecognized level_idc:%s",a),null}var u,d=n(p);try{for(d.s();!(u=d.n()).done;){var l=u.value;if(o===l.profile_idc&&l.profile_iop.isMatch(i))return new c(l.profile,r)}}catch(f){d.e(f)}finally{d.f()}return s("parseProfileLevelId() | unrecognized profile_idc/profile_iop combination"),null},t.profileLevelIdToString=function(e){if(0==e.level)switch(e.profile){case 1:return"42f00b";case 2:return"42100b";case 3:return"4d100b";default:return s("profileLevelIdToString() | Level 1_b not is allowed for profile:%s",e.profile),null}var t;switch(e.profile){case 1:t="42e0";break;case 2:t="4200";break;case 3:t="4d00";break;case 4:t="640c";break;case 5:t="6400";break;default:return s("profileLevelIdToString() | unrecognized profile:%s",e.profile),null}var r=e.level.toString(16);return 1===r.length&&(r="0".concat(r)),"".concat(t).concat(r)},t.parseSdpProfileLevelId=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e["profile-level-id"];return r?t.parseProfileLevelId(r):o},t.isSameProfile=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.parseSdpProfileLevelId(e),a=t.parseSdpProfileLevelId(r);return Boolean(n&&a&&n.profile===a.profile)},t.generateProfileLevelIdForAnswer=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e["profile-level-id"]&&!r["profile-level-id"])return s("generateProfileLevelIdForAnswer() | no profile-level-id in local and remote params"),null;var n=t.parseSdpProfileLevelId(e),a=t.parseSdpProfileLevelId(r);if(!n)throw new TypeError("invalid local_profile_level_id");if(!a)throw new TypeError("invalid remote_profile_level_id");if(n.profile!==a.profile)throw new TypeError("H264 Profile mismatch");var i=h(e)&&h(r),o=n.level,u=a.level,d=f(o,u),p=i?o:d;return s("generateProfileLevelIdForAnswer() | result: [profile:%s, level:%s]",n.profile,p),t.profileLevelIdToString(new c(n.profile,p))}},2696:function(e,t,r){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,a=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(a=n))})),t.splice(a,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(r){}!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_STRIPE_PUBLIC_KEY:"pk_live_eVMbIifj5lnvgBleBCRaCv4E00aeXQkPxQ",REACT_APP_RECAPTCHA_SITE_KEY:"6LeDGP4UAAAAAGYZZenyU-3fRdhL3p0BaBmiK9mM",REACT_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyA2fkXeFokJ-Ei_jnzDso5AmjbIaMdzuEc","authDomain":"watchparty-273604.firebaseapp.com","databaseURL":"https://watchparty-273604.firebaseio.com","projectId":"watchparty-273604","storageBucket":"watchparty-273604.appspot.com","messagingSenderId":"769614672795","appId":"1:769614672795:web:54bbda86288ab1a034273e"}'}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=r(2067)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},2067:function(e,t,r){var n=r(861).default;e.exports=function(e){function t(e){var r,n,i,s=null;function c(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(c.enabled){var i=c,s=Number(new Date),o=s-(r||s);i.diff=o,i.prev=r,i.curr=s,r=s,n[0]=t.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");var u=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";u++;var a=t.formatters[r];if("function"===typeof a){var s=n[u];e=a.call(i,s),n.splice(u,1),u--}return e})),t.formatArgs.call(i,n);var d=i.log||t.log;d.apply(i,n)}}return c.namespace=e,c.useColors=t.useColors(),c.color=t.selectColor(e),c.extend=a,c.destroy=t.destroy,Object.defineProperty(c,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==s?s:(n!==t.namespaces&&(n=t.namespaces,i=t.enabled(e)),i)},set:function(e){s=e}}),"function"===typeof t.init&&t.init(c),c}function a(e,r){var n=t(this.namespace+("undefined"===typeof r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(n(t.names.map(i)),n(t.skips.map(i).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var n=("string"===typeof e?e:"").split(/[\s,]+/),a=n.length;for(r=0;r<a;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(9258),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},9258:function(e){var t=1e3,r=60*t,n=60*r,a=24*n,i=7*a,s=365.25*a;function c(e,t,r,n){var a=t>=1.5*r;return Math.round(e/r)+" "+n+(a?"s":"")}e.exports=function(e,o){o=o||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var c=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!c)return;var o=parseFloat(c[1]);switch((c[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return o*s;case"weeks":case"week":case"w":return o*i;case"days":case"day":case"d":return o*a;case"hours":case"hour":case"hrs":case"hr":case"h":return o*n;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===u&&isFinite(e))return o.long?function(e){var i=Math.abs(e);if(i>=a)return c(e,i,a,"day");if(i>=n)return c(e,i,n,"hour");if(i>=r)return c(e,i,r,"minute");if(i>=t)return c(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=a)return Math.round(e/a)+"d";if(i>=n)return Math.round(e/n)+"h";if(i>=r)return Math.round(e/r)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},1098:function(e,t,r){"use strict";var n=r(7061).default,a=r(7156).default,i=r(6690).default,s=r(9728).default,c=r(6115).default,o=r(1655).default,u=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Consumer=void 0;var d=r(4115),p=r(7318),l=r(6431),f=new d.Logger("Consumer"),h=function(e){o(r,e);var t=u(r);function r(e){var n,a=e.id,s=e.localId,o=e.producerId,u=e.rtpReceiver,d=e.track,l=e.rtpParameters,h=e.appData;return i(this,r),(n=t.call(this))._closed=!1,n._observer=new p.EnhancedEventEmitter,f.debug("constructor()"),n._id=a,n._localId=s,n._producerId=o,n._rtpReceiver=u,n._track=d,n._rtpParameters=l,n._paused=!d.enabled,n._appData=h||{},n.onTrackEnded=n.onTrackEnded.bind(c(n)),n.handleTrack(),n}return s(r,[{key:"id",get:function(){return this._id}},{key:"localId",get:function(){return this._localId}},{key:"producerId",get:function(){return this._producerId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._track.kind}},{key:"rtpReceiver",get:function(){return this._rtpReceiver}},{key:"track",get:function(){return this._track}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"paused",get:function(){return this._paused}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(f.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(f.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"getStats",value:function(){var e=a(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new l.InvalidStateError("closed");case 2:return e.abrupt("return",new Promise((function(e,r){t.safeEmit("@getstats",e,r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){f.debug("pause()"),this._closed?f.error("pause() | Consumer closed"):this._paused?f.debug("pause() | Consumer is already paused"):(this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause"))}},{key:"resume",value:function(){f.debug("resume()"),this._closed?f.error("resume() | Consumer closed"):this._paused?(this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")):f.debug("resume() | Consumer is already resumed")}},{key:"onTrackEnded",value:function(){f.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}},{key:"handleTrack",value:function(){this._track.addEventListener("ended",this.onTrackEnded)}},{key:"destroyTrack",value:function(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch(e){}}}]),r}(p.EnhancedEventEmitter);t.Consumer=h},6919:function(e,t,r){"use strict";var n=r(6690).default,a=r(9728).default,i=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.DataConsumer=void 0;var c=r(4115),o=r(7318),u=new c.Logger("DataConsumer"),d=function(e){i(r,e);var t=s(r);function r(e){var a,i=e.id,s=e.dataProducerId,c=e.dataChannel,d=e.sctpStreamParameters,p=e.appData;return n(this,r),(a=t.call(this))._closed=!1,a._observer=new o.EnhancedEventEmitter,u.debug("constructor()"),a._id=i,a._dataProducerId=s,a._dataChannel=c,a._sctpStreamParameters=d,a._appData=p||{},a.handleDataChannel(),a}return a(r,[{key:"id",get:function(){return this._id}},{key:"dataProducerId",get:function(){return this._dataProducerId}},{key:"closed",get:function(){return this._closed}},{key:"sctpStreamParameters",get:function(){return this._sctpStreamParameters}},{key:"readyState",get:function(){return this._dataChannel.readyState}},{key:"label",get:function(){return this._dataChannel.label}},{key:"protocol",get:function(){return this._dataChannel.protocol}},{key:"binaryType",get:function(){return this._dataChannel.binaryType},set:function(e){this._dataChannel.binaryType=e}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(u.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(u.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"handleDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("open",(function(){e._closed||(u.debug('DataChannel "open" event'),e.safeEmit("open"))})),this._dataChannel.addEventListener("error",(function(t){if(!e._closed){var r=t.error;r||(r=new Error("unknown DataChannel error")),"sctp-failure"===r.errorDetail?u.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",r.sctpCauseCode,r.message):u.error('DataChannel "error" event: %o',r),e.safeEmit("error",r)}})),this._dataChannel.addEventListener("close",(function(){e._closed||(u.warn('DataChannel "close" event'),e._closed=!0,e.emit("@close"),e.safeEmit("close"),e._observer.safeEmit("close"))})),this._dataChannel.addEventListener("message",(function(t){e._closed||e.safeEmit("message",t.data)}))}}]),r}(o.EnhancedEventEmitter);t.DataConsumer=d},7358:function(e,t,r){"use strict";var n=r(6690).default,a=r(9728).default,i=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.DataProducer=void 0;var c=r(4115),o=r(7318),u=r(6431),d=new c.Logger("DataProducer"),p=function(e){i(r,e);var t=s(r);function r(e){var a,i=e.id,s=e.dataChannel,c=e.sctpStreamParameters,u=e.appData;return n(this,r),(a=t.call(this))._closed=!1,a._observer=new o.EnhancedEventEmitter,d.debug("constructor()"),a._id=i,a._dataChannel=s,a._sctpStreamParameters=c,a._appData=u||{},a.handleDataChannel(),a}return a(r,[{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"sctpStreamParameters",get:function(){return this._sctpStreamParameters}},{key:"readyState",get:function(){return this._dataChannel.readyState}},{key:"label",get:function(){return this._dataChannel.label}},{key:"protocol",get:function(){return this._dataChannel.protocol}},{key:"bufferedAmount",get:function(){return this._dataChannel.bufferedAmount}},{key:"bufferedAmountLowThreshold",get:function(){return this._dataChannel.bufferedAmountLowThreshold},set:function(e){this._dataChannel.bufferedAmountLowThreshold=e}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(d.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(d.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"send",value:function(e){if(d.debug("send()"),this._closed)throw new u.InvalidStateError("closed");this._dataChannel.send(e)}},{key:"handleDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("open",(function(){e._closed||(d.debug('DataChannel "open" event'),e.safeEmit("open"))})),this._dataChannel.addEventListener("error",(function(t){if(!e._closed){var r=t.error;r||(r=new Error("unknown DataChannel error")),"sctp-failure"===r.errorDetail?d.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",r.sctpCauseCode,r.message):d.error('DataChannel "error" event: %o',r),e.safeEmit("error",r)}})),this._dataChannel.addEventListener("close",(function(){e._closed||(d.warn('DataChannel "close" event'),e._closed=!0,e.emit("@close"),e.safeEmit("close"),e._observer.safeEmit("close"))})),this._dataChannel.addEventListener("message",(function(){e._closed||d.warn('DataChannel "message" event in a DataProducer, message discarded')})),this._dataChannel.addEventListener("bufferedamountlow",(function(){e._closed||e.safeEmit("bufferedamountlow")}))}}]),r}(o.EnhancedEventEmitter);t.DataProducer=p},5703:function(e,t,r){"use strict";var n=r(7061).default,a=r(7156).default,i=r(6690).default,s=r(9728).default,c=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&c(t,e,r);return o(t,e),t},d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Device=t.detectDevice=void 0;var p=d(r(5524)),l=r(4115),f=r(7318),h=r(6431),m=u(r(3001)),v=u(r(1777)),g=r(475),y=r(4197),b=r(6139),_=r(1521),w=r(8719),S=r(5939),k=r(1714),x=r(3767),R=r(9942),C=r(7516),P=r(3685),D=r(3997),T=new l.Logger("Device");function M(){if("object"===typeof navigator&&"ReactNative"===navigator.product)return"undefined"===typeof RTCPeerConnection?void T.warn("this._detectDevice() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?"):"undefined"!==typeof RTCRtpTransceiver?(T.debug("this._detectDevice() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(T.debug("this._detectDevice() | ReactNative PlanB handler chosen"),"ReactNative");if("object"!==typeof navigator||"string"!==typeof navigator.userAgent)T.warn("this._detectDevice() | unknown device");else{var e=navigator.userAgent,t=p.default.getParser(e),r=t.getEngine();if(t.satisfies({chrome:">=111",chromium:">=111","microsoft edge":">=111"}))return"Chrome111";if(t.satisfies({chrome:">=74",chromium:">=74","microsoft edge":">=88"}))return"Chrome74";if(t.satisfies({chrome:">=70",chromium:">=70"}))return"Chrome70";if(t.satisfies({chrome:">=67",chromium:">=67"}))return"Chrome67";if(t.satisfies({chrome:">=55",chromium:">=55"}))return"Chrome55";if(t.satisfies({firefox:">=60"}))return"Firefox60";if(t.satisfies({ios:{OS:">=14.3",firefox:">=30.0"}}))return"Safari12";if(t.satisfies({safari:">=12.0"})&&"undefined"!==typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(t.satisfies({safari:">=11"}))return"Safari11";if(t.satisfies({"microsoft edge":">=11"})&&t.satisfies({"microsoft edge":"<=18"}))return"Edge11";if(r.name&&"blink"===r.name.toLowerCase()){var n=e.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(n){var a=Number(n[1]);return a>=111?"Chrome111":a>=74?"Chrome74":a>=70?"Chrome70":a>=67?"Chrome67":"Chrome55"}return"Chrome111"}T.warn("this._detectDevice() | browser not supported [name:%s, version:%s]",t.getBrowserName(),t.getBrowserVersion())}}t.detectDevice=M;var O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.handlerName,n=t.handlerFactory,a=t.Handler;if(i(this,e),this._loaded=!1,this._observer=new f.EnhancedEventEmitter,T.debug("constructor()"),a){if(T.warn("constructor() | Handler option is DEPRECATED, use handlerName or handlerFactory instead"),"string"!==typeof a)throw new TypeError("non string Handler option no longer supported, use handlerFactory instead");r=a}if(r&&n)throw new TypeError("just one of handlerName or handlerInterface can be given");if(n)this._handlerFactory=n;else{if(r)T.debug("constructor() | handler given: %s",r);else{if(!(r=M()))throw new h.UnsupportedError("device not supported");T.debug("constructor() | detected handler: %s",r)}switch(r){case"Chrome111":this._handlerFactory=y.Chrome111.createFactory();break;case"Chrome74":this._handlerFactory=b.Chrome74.createFactory();break;case"Chrome70":this._handlerFactory=_.Chrome70.createFactory();break;case"Chrome67":this._handlerFactory=w.Chrome67.createFactory();break;case"Chrome55":this._handlerFactory=S.Chrome55.createFactory();break;case"Firefox60":this._handlerFactory=k.Firefox60.createFactory();break;case"Safari12":this._handlerFactory=x.Safari12.createFactory();break;case"Safari11":this._handlerFactory=R.Safari11.createFactory();break;case"Edge11":this._handlerFactory=C.Edge11.createFactory();break;case"ReactNativeUnifiedPlan":this._handlerFactory=P.ReactNativeUnifiedPlan.createFactory();break;case"ReactNative":this._handlerFactory=D.ReactNative.createFactory();break;default:throw new TypeError('unknown handlerName "'.concat(r,'"'))}}var s=this._handlerFactory();this._handlerName=s.name,s.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}return s(e,[{key:"handlerName",get:function(){return this._handlerName}},{key:"loaded",get:function(){return this._loaded}},{key:"rtpCapabilities",get:function(){if(!this._loaded)throw new h.InvalidStateError("not loaded");return this._recvRtpCapabilities}},{key:"sctpCapabilities",get:function(){if(!this._loaded)throw new h.InvalidStateError("not loaded");return this._sctpCapabilities}},{key:"observer",get:function(){return this._observer}},{key:"load",value:function(){var e=a(n().mark((function e(t){var r,a,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.routerRtpCapabilities,T.debug("load() [routerRtpCapabilities:%o]",r),r=m.clone(r,void 0),e.prev=3,!this._loaded){e.next=6;break}throw new h.InvalidStateError("already loaded");case 6:return v.validateRtpCapabilities(r),a=this._handlerFactory(),e.next=10,a.getNativeRtpCapabilities();case 10:return i=e.sent,T.debug("load() | got native RTP capabilities:%o",i),v.validateRtpCapabilities(i),this._extendedRtpCapabilities=v.getExtendedRtpCapabilities(i,r),T.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=v.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=v.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=v.getRecvRtpCapabilities(this._extendedRtpCapabilities),v.validateRtpCapabilities(this._recvRtpCapabilities),T.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),e.next=22,a.getNativeSctpCapabilities();case 22:this._sctpCapabilities=e.sent,T.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),v.validateSctpCapabilities(this._sctpCapabilities),T.debug("load() succeeded"),this._loaded=!0,a.close(),e.next=34;break;case 30:throw e.prev=30,e.t0=e.catch(3),a&&a.close(),e.t0;case 34:case"end":return e.stop()}}),e,this,[[3,30]])})));return function(t){return e.apply(this,arguments)}}()},{key:"canProduce",value:function(e){if(!this._loaded)throw new h.InvalidStateError("not loaded");if("audio"!==e&&"video"!==e)throw new TypeError('invalid kind "'.concat(e,'"'));return this._canProduceByKind[e]}},{key:"createSendTransport",value:function(e){var t=e.id,r=e.iceParameters,n=e.iceCandidates,a=e.dtlsParameters,i=e.sctpParameters,s=e.iceServers,c=e.iceTransportPolicy,o=e.additionalSettings,u=e.proprietaryConstraints,d=e.appData;return T.debug("createSendTransport()"),this.createTransport({direction:"send",id:t,iceParameters:r,iceCandidates:n,dtlsParameters:a,sctpParameters:i,iceServers:s,iceTransportPolicy:c,additionalSettings:o,proprietaryConstraints:u,appData:d})}},{key:"createRecvTransport",value:function(e){var t=e.id,r=e.iceParameters,n=e.iceCandidates,a=e.dtlsParameters,i=e.sctpParameters,s=e.iceServers,c=e.iceTransportPolicy,o=e.additionalSettings,u=e.proprietaryConstraints,d=e.appData;return T.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:t,iceParameters:r,iceCandidates:n,dtlsParameters:a,sctpParameters:i,iceServers:s,iceTransportPolicy:c,additionalSettings:o,proprietaryConstraints:u,appData:d})}},{key:"createTransport",value:function(e){var t=e.direction,r=e.id,n=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,s=e.sctpParameters,c=e.iceServers,o=e.iceTransportPolicy,u=e.additionalSettings,d=e.proprietaryConstraints,p=e.appData;if(!this._loaded)throw new h.InvalidStateError("not loaded");if("string"!==typeof r)throw new TypeError("missing id");if("object"!==typeof n)throw new TypeError("missing iceParameters");if(!Array.isArray(a))throw new TypeError("missing iceCandidates");if("object"!==typeof i)throw new TypeError("missing dtlsParameters");if(s&&"object"!==typeof s)throw new TypeError("wrong sctpParameters");if(p&&"object"!==typeof p)throw new TypeError("if given, appData must be an object");var l=new g.Transport({direction:t,id:r,iceParameters:n,iceCandidates:a,dtlsParameters:i,sctpParameters:s,iceServers:c,iceTransportPolicy:o,additionalSettings:u,proprietaryConstraints:d,appData:p,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",l),l}}]),e}();t.Device=O},7318:function(e,t,r){"use strict";var n=r(6690).default,a=r(9728).default,i=r(1588).default,s=r(3808).default,c=r(1655).default,o=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.EnhancedEventEmitter=void 0;var u=r(7465),d=new(r(4115).Logger)("EnhancedEventEmitter"),p=function(e){c(r,e);var t=o(r);function r(){var e;return n(this,r),(e=t.call(this)).setMaxListeners(1/0),e}return a(r,[{key:"emit",value:function(e){for(var t,n=arguments.length,a=new Array(n>1?n-1:0),c=1;c<n;c++)a[c-1]=arguments[c];return(t=i(s(r.prototype),"emit",this)).call.apply(t,[this,e].concat(a))}},{key:"safeEmit",value:function(e){var t=i(s(r.prototype),"listenerCount",this).call(this,e);try{for(var n,a=arguments.length,c=new Array(a>1?a-1:0),o=1;o<a;o++)c[o-1]=arguments[o];return(n=i(s(r.prototype),"emit",this)).call.apply(n,[this,e].concat(c))}catch(u){return d.error("safeEmit() | event listener threw an error [eventName:%s]:%o",e,u),Boolean(t)}}},{key:"on",value:function(e,t){return i(s(r.prototype),"on",this).call(this,e,t),this}},{key:"off",value:function(e,t){return i(s(r.prototype),"off",this).call(this,e,t),this}},{key:"addListener",value:function(e,t){return i(s(r.prototype),"on",this).call(this,e,t),this}},{key:"prependListener",value:function(e,t){return i(s(r.prototype),"prependListener",this).call(this,e,t),this}},{key:"once",value:function(e,t){return i(s(r.prototype),"once",this).call(this,e,t),this}},{key:"prependOnceListener",value:function(e,t){return i(s(r.prototype),"prependOnceListener",this).call(this,e,t),this}},{key:"removeListener",value:function(e,t){return i(s(r.prototype),"off",this).call(this,e,t),this}},{key:"removeAllListeners",value:function(e){return i(s(r.prototype),"removeAllListeners",this).call(this,e),this}},{key:"listenerCount",value:function(e){return i(s(r.prototype),"listenerCount",this).call(this,e)}},{key:"listeners",value:function(e){return i(s(r.prototype),"listeners",this).call(this,e)}},{key:"rawListeners",value:function(e){return i(s(r.prototype),"rawListeners",this).call(this,e)}}]),r}(u.EventEmitter);t.EnhancedEventEmitter=p},4115:function(e,t,r){"use strict";var n=r(6690).default,a=r(9728).default,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var s=i(r(858)),c="mediasoup-client",o=function(){function e(t){n(this,e),t?(this._debug=(0,s.default)("".concat(c,":").concat(t)),this._warn=(0,s.default)("".concat(c,":WARN:").concat(t)),this._error=(0,s.default)("".concat(c,":ERROR:").concat(t))):(this._debug=(0,s.default)(c),this._warn=(0,s.default)("".concat(c,":WARN")),this._error=(0,s.default)("".concat(c,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return a(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}();t.Logger=o},9277:function(e,t,r){"use strict";var n=r(7061).default,a=r(7156).default,i=r(6690).default,s=r(9728).default,c=r(6115).default,o=r(1655).default,u=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Producer=void 0;var d=r(4115),p=r(7318),l=r(6431),f=new d.Logger("Producer"),h=function(e){o(r,e);var t=u(r);function r(e){var n,a=e.id,s=e.localId,o=e.rtpSender,u=e.track,d=e.rtpParameters,l=e.stopTracks,h=e.disableTrackOnPause,m=e.zeroRtpOnPause,v=e.appData;return i(this,r),(n=t.call(this))._closed=!1,n._observer=new p.EnhancedEventEmitter,f.debug("constructor()"),n._id=a,n._localId=s,n._rtpSender=o,n._track=u,n._kind=u.kind,n._rtpParameters=d,n._paused=!!h&&!u.enabled,n._maxSpatialLayer=void 0,n._stopTracks=l,n._disableTrackOnPause=h,n._zeroRtpOnPause=m,n._appData=v||{},n.onTrackEnded=n.onTrackEnded.bind(c(n)),n.handleTrack(),n}return s(r,[{key:"id",get:function(){return this._id}},{key:"localId",get:function(){return this._localId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._kind}},{key:"rtpSender",get:function(){return this._rtpSender}},{key:"track",get:function(){return this._track}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"paused",get:function(){return this._paused}},{key:"maxSpatialLayer",get:function(){return this._maxSpatialLayer}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(f.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(f.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"getStats",value:function(){var e=a(n().mark((function e(){var t=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new l.InvalidStateError("closed");case 2:return e.abrupt("return",new Promise((function(e,r){t.safeEmit("@getstats",e,r)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){var e=this;f.debug("pause()"),this._closed?f.error("pause() | Producer closed"):(this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((function(t,r){e.safeEmit("@pause",t,r)})).catch((function(){})),this._observer.safeEmit("pause"))}},{key:"resume",value:function(){var e=this;f.debug("resume()"),this._closed?f.error("resume() | Producer closed"):(this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((function(t,r){e.safeEmit("@resume",t,r)})).catch((function(){})),this._observer.safeEmit("resume"))}},{key:"replaceTrack",value:function(){var e=a(n().mark((function e(t){var r,a=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.track,f.debug("replaceTrack() [track:%o]",r),!this._closed){e.next=7;break}if(r&&this._stopTracks)try{r.stop()}catch(n){}throw new l.InvalidStateError("closed");case 7:if(!r||"ended"!==r.readyState){e.next=9;break}throw new l.InvalidStateError("track ended");case 9:if(r!==this._track){e.next=12;break}return f.debug("replaceTrack() | same track, ignored"),e.abrupt("return");case 12:return e.next=14,new Promise((function(e,t){a.safeEmit("@replacetrack",r,e,t)}));case 14:this.destroyTrack(),this._track=r,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack();case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=a(n().mark((function e(t){var r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=4;break}throw new l.InvalidStateError("closed");case 4:if("video"===this._kind){e.next=8;break}throw new l.UnsupportedError("not a video Producer");case 8:if("number"===typeof t){e.next=10;break}throw new TypeError("invalid spatialLayer");case 10:if(t!==this._maxSpatialLayer){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,new Promise((function(e,n){r.safeEmit("@setmaxspatiallayer",t,e,n)})).catch((function(){}));case 14:this._maxSpatialLayer=t;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=a(n().mark((function e(t){var r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=4;break}throw new l.InvalidStateError("closed");case 4:if("object"===typeof t){e.next=6;break}throw new TypeError("invalid params");case 6:return e.next=8,new Promise((function(e,n){r.safeEmit("@setrtpencodingparameters",t,e,n)}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrackEnded",value:function(){f.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}},{key:"handleTrack",value:function(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}},{key:"destroyTrack",value:function(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch(e){}}}]),r}(p.EnhancedEventEmitter);t.Producer=h},2617:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1045:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},475:function(e,t,r){"use strict";var n=r(861).default,a=r(7061).default,i=r(7156).default,s=r(4704).default,c=r(1655).default,o=r(6389).default,u=r(9728).default,d=r(6690).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Transport=void 0;var m=r(9647),v=h(r(4183)),g=r(4115),y=r(7318),b=r(6431),_=f(r(3001)),w=f(r(1777)),S=r(9277),k=r(1098),x=r(7358),R=r(6919),C=new g.Logger("Transport"),P=u((function e(t){var r=this;d(this,e),this.consumerOptions=t,this.promise=new Promise((function(e,t){r.resolve=e,r.reject=t}))})),D=function(e){c(r,e);var t=o(r);function r(e){var n,a=e.direction,i=e.id,s=e.iceParameters,c=e.iceCandidates,o=e.dtlsParameters,u=e.sctpParameters,p=e.iceServers,l=e.iceTransportPolicy,f=e.additionalSettings,h=e.proprietaryConstraints,v=e.appData,g=e.handlerFactory,b=e.extendedRtpCapabilities,w=e.canProduceByKind;return d(this,r),(n=t.call(this))._closed=!1,n._connectionState="new",n._producers=new Map,n._consumers=new Map,n._dataProducers=new Map,n._dataConsumers=new Map,n._probatorConsumerCreated=!1,n._awaitQueue=new m.AwaitQueue,n._pendingConsumerTasks=[],n._consumerCreationInProgress=!1,n._pendingPauseConsumers=new Map,n._consumerPauseInProgress=!1,n._pendingResumeConsumers=new Map,n._consumerResumeInProgress=!1,n._pendingCloseConsumers=new Map,n._consumerCloseInProgress=!1,n._observer=new y.EnhancedEventEmitter,C.debug("constructor() [id:%s, direction:%s]",i,a),n._id=i,n._direction=a,n._extendedRtpCapabilities=b,n._canProduceByKind=w,n._maxSctpMessageSize=u?u.maxMessageSize:null,delete(f=_.clone(f,{})).iceServers,delete f.iceTransportPolicy,delete f.bundlePolicy,delete f.rtcpMuxPolicy,delete f.sdpSemantics,n._handler=g(),n._handler.run({direction:a,iceParameters:s,iceCandidates:c,dtlsParameters:o,sctpParameters:u,iceServers:p,iceTransportPolicy:l,additionalSettings:f,proprietaryConstraints:h,extendedRtpCapabilities:b}),n._appData=v||{},n.handleHandler(),n}return u(r,[{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"direction",get:function(){return this._direction}},{key:"handler",get:function(){return this._handler}},{key:"connectionState",get:function(){return this._connectionState}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){if(!this._closed){C.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close();var e,t=s(this._producers.values());try{for(t.s();!(e=t.n()).done;){e.value.transportClosed()}}catch(u){t.e(u)}finally{t.f()}this._producers.clear();var r,n=s(this._consumers.values());try{for(n.s();!(r=n.n()).done;){r.value.transportClosed()}}catch(u){n.e(u)}finally{n.f()}this._consumers.clear();var a,i=s(this._dataProducers.values());try{for(i.s();!(a=i.n()).done;){a.value.transportClosed()}}catch(u){i.e(u)}finally{i.f()}this._dataProducers.clear();var c,o=s(this._dataConsumers.values());try{for(o.s();!(c=o.n()).done;){c.value.transportClosed()}}catch(u){o.e(u)}finally{o.f()}this._dataConsumers.clear(),this._observer.safeEmit("close")}}},{key:"getStats",value:function(){var e=i(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new b.InvalidStateError("closed");case 2:return e.abrupt("return",this._handler.getTransportStats());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=i(a().mark((function e(t){var r,n=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.iceParameters,C.debug("restartIce()"),!this._closed){e.next=6;break}throw new b.InvalidStateError("closed");case 6:if(r){e.next=8;break}throw new TypeError("missing iceParameters");case 8:return e.abrupt("return",this._awaitQueue.push(i(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n._handler.restartIce(r));case 1:case"end":return e.stop()}}),e)}))),"transport.restartIce()"));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateIceServers",value:function(){var e=i(a().mark((function e(){var t,r,n=this,s=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:{},r=t.iceServers,C.debug("updateIceServers()"),!this._closed){e.next=6;break}throw new b.InvalidStateError("closed");case 6:if(Array.isArray(r)){e.next=8;break}throw new TypeError("missing iceServers");case 8:return e.abrupt("return",this._awaitQueue.push(i(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n._handler.updateIceServers(r));case 1:case"end":return e.stop()}}),e)}))),"transport.updateIceServers()"));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"produce",value:function(){var e=i(a().mark((function e(){var t,r,n,s,c,o,u,d,p,l,f,h,m,v=this,g=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=g.length>0&&void 0!==g[0]?g[0]:{},r=t.track,n=t.encodings,s=t.codecOptions,c=t.codec,o=t.stopTracks,u=void 0===o||o,d=t.disableTrackOnPause,p=void 0===d||d,l=t.zeroRtpOnPause,f=void 0!==l&&l,h=t.appData,m=void 0===h?{}:h,C.debug("produce() [track:%o]",r),!this._closed){e.next=6;break}throw new b.InvalidStateError("closed");case 6:if(r){e.next=10;break}throw new TypeError("missing track");case 10:if("send"===this._direction){e.next=14;break}throw new b.UnsupportedError("not a sending Transport");case 14:if(this._canProduceByKind[r.kind]){e.next=18;break}throw new b.UnsupportedError("cannot produce ".concat(r.kind));case 18:if("ended"!==r.readyState){e.next=22;break}throw new b.InvalidStateError("track ended");case 22:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=26;break}throw new TypeError('no "connect" listener set into this transport');case 26:if(0!==this.listenerCount("produce")){e.next=30;break}throw new TypeError('no "produce" listener set into this transport');case 30:if(!m||"object"===typeof m){e.next=32;break}throw new TypeError("if given, appData must be an object");case 32:return e.abrupt("return",this._awaitQueue.push(i(a().mark((function e(){var t,i,o,d,l,h,g,y;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n||Array.isArray(n)){e.next=4;break}throw TypeError("encodings must be an array");case 4:n&&0===n.length?t=void 0:n&&(t=n.map((function(e){var t={active:!0};return!1===e.active&&(t.active=!1),"boolean"===typeof e.dtx&&(t.dtx=e.dtx),"string"===typeof e.scalabilityMode&&(t.scalabilityMode=e.scalabilityMode),"number"===typeof e.scaleResolutionDownBy&&(t.scaleResolutionDownBy=e.scaleResolutionDownBy),"number"===typeof e.maxBitrate&&(t.maxBitrate=e.maxBitrate),"number"===typeof e.maxFramerate&&(t.maxFramerate=e.maxFramerate),"boolean"===typeof e.adaptivePtime&&(t.adaptivePtime=e.adaptivePtime),"string"===typeof e.priority&&(t.priority=e.priority),"string"===typeof e.networkPriority&&(t.networkPriority=e.networkPriority),t})));case 5:return e.next=7,v._handler.send({track:r,encodings:t,codecOptions:s,codec:c});case 7:return i=e.sent,o=i.localId,d=i.rtpParameters,l=i.rtpSender,e.prev=11,w.validateRtpParameters(d),e.next=15,new Promise((function(e,t){v.safeEmit("produce",{kind:r.kind,rtpParameters:d,appData:m},e,t)}));case 15:return h=e.sent,g=h.id,y=new S.Producer({id:g,localId:o,rtpSender:l,track:r,rtpParameters:d,stopTracks:u,disableTrackOnPause:p,zeroRtpOnPause:f,appData:m}),v._producers.set(y.id,y),v.handleProducer(y),v._observer.safeEmit("newproducer",y),e.abrupt("return",y);case 24:throw e.prev=24,e.t0=e.catch(11),v._handler.stopSending(o).catch((function(){})),e.t0;case 28:case"end":return e.stop()}}),e,null,[[11,24]])}))),"transport.produce()").catch((function(e){if(u)try{r.stop()}catch(t){}throw e})));case 33:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"consume",value:function(){var e=i(a().mark((function e(t){var r,n,i,s,c,o,u,d,p=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.id,n=t.producerId,i=t.kind,s=t.rtpParameters,c=t.streamId,o=t.appData,u=void 0===o?{}:o,C.debug("consume()"),s=_.clone(s,void 0),!this._closed){e.next=7;break}throw new b.InvalidStateError("closed");case 7:if("recv"===this._direction){e.next=11;break}throw new b.UnsupportedError("not a receiving Transport");case 11:if("string"===typeof r){e.next=15;break}throw new TypeError("missing id");case 15:if("string"===typeof n){e.next=19;break}throw new TypeError("missing producerId");case 19:if("audio"===i||"video"===i){e.next=23;break}throw new TypeError("invalid kind '".concat(i,"'"));case 23:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=27;break}throw new TypeError('no "connect" listener set into this transport');case 27:if(!u||"object"===typeof u){e.next=29;break}throw new TypeError("if given, appData must be an object");case 29:if(w.canReceive(s,this._extendedRtpCapabilities)){e.next=32;break}throw new b.UnsupportedError("cannot consume this Producer");case 32:return d=new P({id:r,producerId:n,kind:i,rtpParameters:s,streamId:c,appData:u}),this._pendingConsumerTasks.push(d),(0,v.default)((function(){if(p._closed)throw new b.InvalidStateError("closed");!1===p._consumerCreationInProgress&&p.createPendingConsumers()})),e.abrupt("return",d.promise);case 36:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"produceData",value:function(){var e=i(a().mark((function e(){var t,r,n,s,c,o,u,d,p,l,f,h=this,m=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=m.length>0&&void 0!==m[0]?m[0]:{},r=t.ordered,n=void 0===r||r,s=t.maxPacketLifeTime,c=t.maxRetransmits,o=t.label,u=void 0===o?"":o,d=t.protocol,p=void 0===d?"":d,l=t.appData,f=void 0===l?{}:l,C.debug("produceData()"),!this._closed){e.next=6;break}throw new b.InvalidStateError("closed");case 6:if("send"===this._direction){e.next=10;break}throw new b.UnsupportedError("not a sending Transport");case 10:if(this._maxSctpMessageSize){e.next=14;break}throw new b.UnsupportedError("SCTP not enabled by remote Transport");case 14:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=18;break}throw new TypeError('no "connect" listener set into this transport');case 18:if(0!==this.listenerCount("producedata")){e.next=22;break}throw new TypeError('no "producedata" listener set into this transport');case 22:if(!f||"object"===typeof f){e.next=24;break}throw new TypeError("if given, appData must be an object");case 24:return(s||c)&&(n=!1),e.abrupt("return",this._awaitQueue.push(i(a().mark((function e(){var t,r,i,o,d,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h._handler.sendDataChannel({ordered:n,maxPacketLifeTime:s,maxRetransmits:c,label:u,protocol:p});case 2:return t=e.sent,r=t.dataChannel,i=t.sctpStreamParameters,w.validateSctpStreamParameters(i),e.next=8,new Promise((function(e,t){h.safeEmit("producedata",{sctpStreamParameters:i,label:u,protocol:p,appData:f},e,t)}));case 8:return o=e.sent,d=o.id,l=new x.DataProducer({id:d,dataChannel:r,sctpStreamParameters:i,appData:f}),h._dataProducers.set(l.id,l),h.handleDataProducer(l),h._observer.safeEmit("newdataproducer",l),e.abrupt("return",l);case 15:case"end":return e.stop()}}),e)}))),"transport.produceData()"));case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"consumeData",value:function(){var e=i(a().mark((function e(t){var r,n,s,c,o,u,d,p,l,f=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.id,n=t.dataProducerId,s=t.sctpStreamParameters,c=t.label,o=void 0===c?"":c,u=t.protocol,d=void 0===u?"":u,p=t.appData,l=void 0===p?{}:p,C.debug("consumeData()"),s=_.clone(s,void 0),!this._closed){e.next=7;break}throw new b.InvalidStateError("closed");case 7:if("recv"===this._direction){e.next=11;break}throw new b.UnsupportedError("not a receiving Transport");case 11:if(this._maxSctpMessageSize){e.next=15;break}throw new b.UnsupportedError("SCTP not enabled by remote Transport");case 15:if("string"===typeof r){e.next=19;break}throw new TypeError("missing id");case 19:if("string"===typeof n){e.next=23;break}throw new TypeError("missing dataProducerId");case 23:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=27;break}throw new TypeError('no "connect" listener set into this transport');case 27:if(!l||"object"===typeof l){e.next=29;break}throw new TypeError("if given, appData must be an object");case 29:return w.validateSctpStreamParameters(s),e.abrupt("return",this._awaitQueue.push(i(a().mark((function e(){var t,i,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f._handler.receiveDataChannel({sctpStreamParameters:s,label:o,protocol:d});case 2:return t=e.sent,i=t.dataChannel,c=new R.DataConsumer({id:r,dataProducerId:n,dataChannel:i,sctpStreamParameters:s,appData:l}),f._dataConsumers.set(c.id,c),f.handleDataConsumer(c),f._observer.safeEmit("newdataconsumer",c),e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)}))),"transport.consumeData()"));case 31:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createPendingConsumers",value:function(){var e=i(a().mark((function e(){var t=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._consumerCreationInProgress=!0,this._awaitQueue.push(i(a().mark((function e(){var r,i,c,o,u,d,p,l,f,h,m,v,g,y,b,_,S,x,R,P,D,T,M,O,E,L,I,j;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t._pendingConsumerTasks.length){e.next=3;break}return C.debug("createPendingConsumers() | there is no Consumer to be created"),e.abrupt("return");case 3:r=n(t._pendingConsumerTasks),t._pendingConsumerTasks=[],i=void 0,c=[],o=s(r);try{for(o.s();!(u=o.n()).done;)d=u.value,p=d.consumerOptions,l=p.id,f=p.kind,h=p.rtpParameters,m=p.streamId,c.push({trackId:l,kind:f,rtpParameters:h,streamId:m})}catch(a){o.e(a)}finally{o.f()}return e.prev=9,e.next=12,t._handler.receive(c);case 12:for(v=e.sent,g=0;g<v.length;g++)y=r[g],b=v[g],_=y.consumerOptions,S=_.id,x=_.producerId,R=_.kind,P=_.rtpParameters,D=_.appData,T=b.localId,M=b.rtpReceiver,O=b.track,E=new k.Consumer({id:S,localId:T,producerId:x,rtpReceiver:M,track:O,rtpParameters:P,appData:D}),t._consumers.set(E.id,E),t.handleConsumer(E),t._probatorConsumerCreated||i||"video"!==R||(i=E),t._observer.safeEmit("newconsumer",E),y.resolve(E);e.next=20;break;case 16:e.prev=16,e.t0=e.catch(9),L=s(r);try{for(L.s();!(I=L.n()).done;)I.value.reject(e.t0)}catch(a){L.e(a)}finally{L.f()}case 20:if(!i){e.next=32;break}return e.prev=21,j=w.generateProbatorRtpParameters(i.rtpParameters),e.next=25,t._handler.receive([{trackId:"probator",kind:"video",rtpParameters:j}]);case 25:C.debug("createPendingConsumers() | Consumer for RTP probation created"),t._probatorConsumerCreated=!0,e.next=32;break;case 29:e.prev=29,e.t1=e.catch(21),C.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",e.t1);case 32:case"end":return e.stop()}}),e,null,[[9,16],[21,29]])}))),"transport.createPendingConsumers()").then((function(){t._consumerCreationInProgress=!1,t._pendingConsumerTasks.length>0&&t.createPendingConsumers()})).catch((function(){}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pausePendingConsumers",value:function(){var e=this;this._consumerPauseInProgress=!0,this._awaitQueue.push(i(a().mark((function t(){var r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e._pendingPauseConsumers.size){t.next=3;break}return C.debug("pausePendingConsumers() | there is no Consumer to be paused"),t.abrupt("return");case 3:return r=Array.from(e._pendingPauseConsumers.values()),e._pendingPauseConsumers.clear(),t.prev=5,n=r.map((function(e){return e.localId})),t.next=9,e._handler.pauseReceiving(n);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),C.error("pausePendingConsumers() | failed to pause Consumers:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[5,11]])}))),"transport.pausePendingConsumers").then((function(){e._consumerPauseInProgress=!1,e._pendingPauseConsumers.size>0&&e.pausePendingConsumers()})).catch((function(){}))}},{key:"resumePendingConsumers",value:function(){var e=this;this._consumerResumeInProgress=!0,this._awaitQueue.push(i(a().mark((function t(){var r,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e._pendingResumeConsumers.size){t.next=3;break}return C.debug("resumePendingConsumers() | there is no Consumer to be resumed"),t.abrupt("return");case 3:return r=Array.from(e._pendingResumeConsumers.values()),e._pendingResumeConsumers.clear(),t.prev=5,n=r.map((function(e){return e.localId})),t.next=9,e._handler.resumeReceiving(n);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),C.error("resumePendingConsumers() | failed to resume Consumers:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[5,11]])}))),"transport.resumePendingConsumers").then((function(){e._consumerResumeInProgress=!1,e._pendingResumeConsumers.size>0&&e.resumePendingConsumers()})).catch((function(){}))}},{key:"closePendingConsumers",value:function(){var e=this;this._consumerCloseInProgress=!0,this._awaitQueue.push(i(a().mark((function t(){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e._pendingCloseConsumers.size){t.next=3;break}return C.debug("closePendingConsumers() | there is no Consumer to be closed"),t.abrupt("return");case 3:return r=Array.from(e._pendingCloseConsumers.values()),e._pendingCloseConsumers.clear(),t.prev=5,t.next=8,e._handler.stopReceiving(r.map((function(e){return e.localId})));case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(5),C.error("closePendingConsumers() | failed to close Consumers:",t.t0);case 13:case"end":return t.stop()}}),t,null,[[5,10]])}))),"transport.closePendingConsumers").then((function(){e._consumerCloseInProgress=!1,e._pendingCloseConsumers.size>0&&e.closePendingConsumers()})).catch((function(){}))}},{key:"handleHandler",value:function(){var e=this,t=this._handler;t.on("@connect",(function(t,r,n){var a=t.dtlsParameters;e._closed?n(new b.InvalidStateError("closed")):e.safeEmit("connect",{dtlsParameters:a},r,n)})),t.on("@connectionstatechange",(function(t){t!==e._connectionState&&(C.debug("connection state changed to %s",t),e._connectionState=t,e._closed||e.safeEmit("connectionstatechange",t))}))}},{key:"handleProducer",value:function(e){var t=this;e.on("@close",(function(){t._producers.delete(e.id),t._closed||t._awaitQueue.push(i(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t._handler.stopSending(e.localId));case 1:case"end":return r.stop()}}),r)}))),"producer @close event").catch((function(e){return C.warn("producer.close() failed:%o",e)}))})),e.on("@pause",(function(r,n){t._awaitQueue.push(i(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t._handler.pauseSending(e.localId));case 1:case"end":return r.stop()}}),r)}))),"producer @pause event").then(r).catch(n)})),e.on("@resume",(function(r,n){t._awaitQueue.push(i(a().mark((function r(){return a().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t._handler.resumeSending(e.localId));case 1:case"end":return r.stop()}}),r)}))),"producer @resume event").then(r).catch(n)})),e.on("@replacetrack",(function(r,n,s){t._awaitQueue.push(i(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._handler.replaceTrack(e.localId,r));case 1:case"end":return n.stop()}}),n)}))),"producer @replacetrack event").then(n).catch(s)})),e.on("@setmaxspatiallayer",(function(r,n,s){t._awaitQueue.push(i(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._handler.setMaxSpatialLayer(e.localId,r));case 1:case"end":return n.stop()}}),n)}))),"producer @setmaxspatiallayer event").then(n).catch(s)})),e.on("@setrtpencodingparameters",(function(r,n,s){t._awaitQueue.push(i(a().mark((function n(){return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._handler.setRtpEncodingParameters(e.localId,r));case 1:case"end":return n.stop()}}),n)}))),"producer @setrtpencodingparameters event").then(n).catch(s)})),e.on("@getstats",(function(r,n){if(t._closed)return n(new b.InvalidStateError("closed"));t._handler.getSenderStats(e.localId).then(r).catch(n)}))}},{key:"handleConsumer",value:function(e){var t=this;e.on("@close",(function(){t._consumers.delete(e.id),t._pendingPauseConsumers.delete(e.id),t._pendingResumeConsumers.delete(e.id),t._closed||(t._pendingCloseConsumers.set(e.id,e),!1===t._consumerCloseInProgress&&t.closePendingConsumers())})),e.on("@pause",(function(){t._pendingResumeConsumers.has(e.id)&&t._pendingResumeConsumers.delete(e.id),t._pendingPauseConsumers.set(e.id,e),(0,v.default)((function(){t._closed||!1===t._consumerPauseInProgress&&t.pausePendingConsumers()}))})),e.on("@resume",(function(){t._pendingPauseConsumers.has(e.id)&&t._pendingPauseConsumers.delete(e.id),t._pendingResumeConsumers.set(e.id,e),(0,v.default)((function(){t._closed||!1===t._consumerResumeInProgress&&t.resumePendingConsumers()}))})),e.on("@getstats",(function(r,n){if(t._closed)return n(new b.InvalidStateError("closed"));t._handler.getReceiverStats(e.localId).then(r).catch(n)}))}},{key:"handleDataProducer",value:function(e){var t=this;e.on("@close",(function(){t._dataProducers.delete(e.id)}))}},{key:"handleDataConsumer",value:function(e){var t=this;e.on("@close",(function(){t._dataConsumers.delete(e.id)}))}}]),r}(y.EnhancedEventEmitter);t.Transport=D},6431:function(e,t,r){"use strict";var n=r(9728).default,a=r(6690).default,i=r(6115).default,s=r(1655).default,c=r(6389).default,o=r(3496).default;Object.defineProperty(t,"__esModule",{value:!0}),t.InvalidStateError=t.UnsupportedError=void 0;var u=function(e){s(r,e);var t=c(r);function r(e){var n;return a(this,r),(n=t.call(this,e)).name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(i(n),r):n.stack=new Error(e).stack,n}return n(r)}(o(Error));t.UnsupportedError=u;var d=function(e){s(r,e);var t=c(r);function r(e){var n;return a(this,r),(n=t.call(this,e)).name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(i(n),r):n.stack=new Error(e).stack,n}return n(r)}(o(Error));t.InvalidStateError=d},4197:function(e,t,r){"use strict";var n=r(4704).default,a=r(2122).default,i=r(7061).default,s=r(7156).default,c=r(6690).default,o=r(9728).default,u=r(1655).default,d=r(6389).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome111=void 0;var h=f(r(7724)),m=r(4115),v=f(r(3001)),g=f(r(1777)),y=f(r(8978)),b=f(r(8480)),_=f(r(4032)),w=r(4376),S=r(9678),k=r(8732),x=new m.Logger("Chrome111"),R={OS:1024,MIS:1024},C=function(e){u(r,e);var t=d(r);function r(){var e;return c(this,r),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return o(r,[{key:"name",get:function(){return"Chrome111"}},{key:"close",value:function(){if(x.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=s(i().mark((function e(){var t,r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:r=e.sent;try{t.close()}catch(i){}return n=h.parse(r.sdp),a=y.extractRtpCapabilities({sdpObject:n}),_.addNackSuppportForOpus(a),e.abrupt("return",a);case 15:e.prev=15,e.t0=e.catch(2);try{t.close()}catch(s){}throw e.t0;case 19:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:R});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,c=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,d=e.additionalSettings,p=e.proprietaryConstraints,l=e.extendedRtpCapabilities;x.debug("run()"),this._direction=r,this._remoteSdp=new S.RemoteSdp({iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:c}),this._sendingRtpParametersByKind={audio:g.getSendingRtpParameters("audio",l),video:g.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:g.getSendingRemoteRtpParameters("audio",l),video:g.getSendingRemoteRtpParameters("video",l)},s.role&&"auto"!==s.role&&(this._forcedLocalDtlsRole="server"===s.role?"client":"server"),this._pc=new RTCPeerConnection(a({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},d),p),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):(x.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}})))}},{key:"updateIceServers",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=s(i().mark((function e(t){var r,n,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,x.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:return e.next=23,this._pc.createAnswer();case 23:return s=e.sent,x.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),e.next=27,this._pc.setLocalDescription(s);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,_,w,S,R,C,P,D,T,M,O,E,L,I;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.track,a=t.encodings,s=t.codecOptions,c=t.codec,this.assertSendDirection(),x.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),a&&a.length>1){a.forEach((function(e,t){e.rid="r".concat(t)})),u=1,d=1,p=n(a);try{for(p.s();!(l=p.n()).done;)f=l.value,(m=f.scalabilityMode?(0,k.parse)(f.scalabilityMode).temporalLayers:3)>d&&(d=m)}catch(i){p.e(i)}finally{p.f()}_=n(a);try{for(_.s();!(w=_.n()).done;)(S=w.value).rid="r".concat(u++),S.scalabilityMode="L1T".concat(d)}catch(i){_.e(i)}finally{_.f()}}return(R=v.clone(this._sendingRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(R.codecs,c),(C=v.clone(this._sendingRemoteRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(C.codecs,c),P=this._remoteSdp.getNextMediaSectionIdx(),D=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:a}),e.next=12,this._pc.createOffer();case 12:if(T=e.sent,M=h.parse(T.sdp),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:M});case 17:return x.debug("send() | calling pc.setLocalDescription() [offer:%o]",T),e.next=20,this._pc.setLocalDescription(T);case 20:return O=D.mid,R.mid=O,M=h.parse(this._pc.localDescription.sdp),E=M.media[P.idx],R.rtcp.cname=y.getCname({offerMediaObject:E}),a?1===a.length?(L=b.getRtpEncodings({offerMediaObject:E}),Object.assign(L[0],a[0]),R.encodings=L):R.encodings=a:R.encodings=b.getRtpEncodings({offerMediaObject:E}),this._remoteSdp.send({offerMediaObject:E,reuseMid:P.reuseMid,offerRtpParameters:R,answerRtpParameters:C,codecOptions:s,extmapAllowMixed:!0}),I={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("send() | calling pc.setRemoteDescription() [answer:%o]",I),e.next=31,this._pc.setRemoteDescription(I);case 31:return this._mapMidTransceiver.set(O,D),e.abrupt("return",{localId:O,rtpParameters:R,rtpSender:D.sender});case 33:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("stopSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch(i){}return e.next=11,this._pc.createOffer();case 11:return n=e.sent,x.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=15,this._pc.setLocalDescription(n);case 15:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=19,this._pc.setRemoteDescription(a);case 19:this._mapMidTransceiver.delete(t);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("pauseSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return r.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=9,this._pc.createOffer();case 9:return n=e.sent,x.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=13,this._pc.setLocalDescription(n);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=17,this._pc.setRemoteDescription(a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("resumeSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t),this._remoteSdp.resumeSendingMediaSection(t),r){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return r.direction="sendonly",e.next=9,this._pc.createOffer();case 9:return n=e.sent,x.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=13,this._pc.setLocalDescription(n);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=17,this._pc.setRemoteDescription(a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=s(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r?x.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):x.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.next=7,n.sender.replaceTrack(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=s(i().mark((function e(t,r){var n,a,s,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=n.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=9,n.sender.setParameters(a);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=12,this._pc.createOffer();case 12:return s=e.sent,x.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),e.next=16,this._pc.setLocalDescription(s);case 16:return c={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",c),e.next=20,this._pc.setRemoteDescription(c);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=s(i().mark((function e(t,r){var n,s,c,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(s=n.sender.getParameters()).encodings.forEach((function(e,t){s.encodings[t]=a(a({},e),r)})),e.next=9,n.sender.setParameters(s);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings),e.next=12,this._pc.createOffer();case 12:return c=e.sent,x.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",c),e.next=16,this._pc.setLocalDescription(c);case 16:return o={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=20,this._pc.setRemoteDescription(o);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.sender.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,a=t.maxRetransmits,s=t.label,c=t.protocol,this.assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:a,protocol:c},x.debug("sendDataChannel() [options:%o]",u),d=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%R.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=h.parse(p.sdp),f=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:l});case 15:return x.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),m={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=23,this._pc.setRemoteDescription(m);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:d,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,g,b,_,w,S,k,R,C,P=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),a=[],s=new Map,c=n(t);try{for(c.s();!(o=c.n()).done;)u=o.value,d=u.trackId,p=u.kind,l=u.rtpParameters,f=u.streamId,x.debug("receive() [trackId:%s, kind:%s]",d,p),m=l.mid||String(this._mapMidTransceiver.size),s.set(d,m),this._remoteSdp.receive({mid:m,kind:p,offerRtpParameters:l,streamId:f||l.rtcp.cname,trackId:d})}catch(i){c.e(i)}finally{c.f()}return v={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",v),e.next=9,this._pc.setRemoteDescription(v);case 9:return e.next=11,this._pc.createAnswer();case 11:g=e.sent,b=h.parse(g.sdp),_=n(t);try{for(S=function(){var e=w.value,t=e.trackId,r=e.rtpParameters,n=s.get(t),a=b.media.find((function(e){return String(e.mid)===n}));y.applyCodecParameters({offerRtpParameters:r,answerMediaObject:a})},_.s();!(w=_.n()).done;)S()}catch(i){_.e(i)}finally{_.f()}if(g={type:"answer",sdp:h.write(b)},this._transportReady){e.next=19;break}return e.next=19,this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:b});case 19:return x.debug("receive() | calling pc.setLocalDescription() [answer:%o]",g),e.next=22,this._pc.setLocalDescription(g);case 22:k=n(t);try{for(C=function(){var e=R.value.trackId,t=s.get(e),r=P._pc.getTransceivers().find((function(e){return e.mid===t}));if(!r)throw new Error("new RTCRtpTransceiver not found");P._mapMidTransceiver.set(t,r),a.push({localId:t,track:r.receiver.track,rtpReceiver:r.receiver})},k.s();!(R=k.n()).done;)C()}catch(i){k.e(i)}finally{k.f()}return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=13;break}if(s=a.value,x.debug("stopReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:this._remoteSdp.closeMediaSection(c.mid);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return u=e.sent,x.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=31,this._pc.setLocalDescription(u);case 31:d=n(t);try{for(d.s();!(p=d.n()).done;)l=p.value,this._mapMidTransceiver.delete(l)}catch(i){d.e(i)}finally{d.f()}case 33:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=14;break}if(s=a.value,x.debug("pauseReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:c.direction="inactive",this._remoteSdp.pauseMediaSection(s);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=26,this._pc.setRemoteDescription(o);case 26:return e.next=28,this._pc.createAnswer();case 28:return u=e.sent,x.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=32,this._pc.setLocalDescription(u);case 32:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=14;break}if(s=a.value,x.debug("resumeReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:c.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(s);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=26,this._pc.setRemoteDescription(o);case 26:return e.next=28,this._pc.createAnswer();case 28:return u=e.sent,x.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=32,this._pc.setLocalDescription(u);case 32:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,a=t.protocol,this.assertRecvDirection(),c=r.streamId,o=r.ordered,u=r.maxPacketLifeTime,d=r.maxRetransmits,p={negotiated:!0,id:c,ordered:o,maxPacketLifeTime:u,maxRetransmits:d,protocol:a},x.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),f={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=12,this._pc.setRemoteDescription(f);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=h.parse(m.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=s(i().mark((function e(t){var r,n,a,s=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=h.parse(this._pc.localDescription.sdp)),(a=y.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){s.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new r}}}]),r}(w.HandlerInterface);t.Chrome111=C},5939:function(e,t,r){"use strict";var n=r(4704).default,a=r(2122).default,i=r(7061).default,s=r(7156).default,c=r(6690).default,o=r(9728).default,u=r(1655).default,d=r(6389).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome55=void 0;var h=f(r(7724)),m=r(4115),v=r(6431),g=f(r(3001)),y=f(r(1777)),b=f(r(8978)),_=f(r(9547)),w=r(4376),S=r(9678),k=new m.Logger("Chrome55"),x={OS:1024,MIS:1024},R=function(e){u(r,e);var t=d(r);function r(){var e;return c(this,r),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdTrack=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return o(r,[{key:"name",get:function(){return"Chrome55"}},{key:"close",value:function(){if(k.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=s(i().mark((function e(){var t,r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:r=e.sent;try{t.close()}catch(i){}return n=h.parse(r.sdp),a=b.extractRtpCapabilities({sdpObject:n}),e.abrupt("return",a);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(s){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:x});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,c=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,d=e.additionalSettings,p=e.proprietaryConstraints,l=e.extendedRtpCapabilities;k.debug("run()"),this._direction=r,this._remoteSdp=new S.RemoteSdp({iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:c,planB:!0}),this._sendingRtpParametersByKind={audio:y.getSendingRtpParameters("audio",l),video:y.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:y.getSendingRemoteRtpParameters("audio",l),video:y.getSendingRemoteRtpParameters("video",l)},s.role&&"auto"!==s.role&&(this._forcedLocalDtlsRole="server"===s.role?"client":"server"),this._pc=new RTCPeerConnection(a({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},d),p),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(k.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=s(i().mark((function e(t){var r,n,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,k.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:return e.next=23,this._pc.createAnswer();case 23:return s=e.sent,k.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),e.next=27,this._pc.setLocalDescription(s);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,w,S,x;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,a=t.encodings,s=t.codecOptions,c=t.codec,this.assertSendDirection(),k.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),c&&k.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addStream(this._sendStream),e.next=8,this._pc.createOffer();case 8:if(u=e.sent,d=h.parse(u.sdp),(l=g.clone(this._sendingRtpParametersByKind[r.kind],{})).codecs=y.reduceCodecs(l.codecs),(f=g.clone(this._sendingRemoteRtpParametersByKind[r.kind],{})).codecs=y.reduceCodecs(f.codecs),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:d});case 17:return"video"===r.kind&&a&&a.length>1&&(k.debug("send() | enabling simulcast"),d=h.parse(u.sdp),p=d.media.find((function(e){return"video"===e.type})),_.addLegacySimulcast({offerMediaObject:p,track:r,numStreams:a.length}),u={type:"offer",sdp:h.write(d)}),k.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),e.next=21,this._pc.setLocalDescription(u);case 21:if(d=h.parse(this._pc.localDescription.sdp),p=d.media.find((function(e){return e.type===r.kind})),l.rtcp.cname=b.getCname({offerMediaObject:p}),l.encodings=_.getRtpEncodings({offerMediaObject:p,track:r}),a)for(m=0;m<l.encodings.length;++m)a[m]&&Object.assign(l.encodings[m],a[m]);if(l.encodings.length>1&&"video/vp8"===l.codecs[0].mimeType.toLowerCase()){v=n(l.encodings);try{for(v.s();!(w=v.n()).done;)w.value.scalabilityMode="L1T3"}catch(i){v.e(i)}finally{v.f()}}return this._remoteSdp.send({offerMediaObject:p,offerRtpParameters:l,answerRtpParameters:f,codecOptions:s}),S={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("send() | calling pc.setRemoteDescription() [answer:%o]",S),e.next=32,this._pc.setRemoteDescription(S);case 32:return x=String(this._nextSendLocalId),this._nextSendLocalId++,this._mapSendLocalIdTrack.set(x,r),e.abrupt("return",{localId:x,rtpParameters:l});case 36:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),k.debug("stopSending() [localId:%s]",t),r=this._mapSendLocalIdTrack.get(t)){e.next=5;break}throw new Error("track not found");case 5:return this._mapSendLocalIdTrack.delete(t),this._sendStream.removeTrack(r),this._pc.addStream(this._sendStream),e.next=10,this._pc.createOffer();case 10:return n=e.sent,k.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.prev=12,e.next=15,this._pc.setLocalDescription(n);case 15:e.next=23;break;case 17:if(e.prev=17,e.t0=e.catch(12),0!==this._sendStream.getTracks().length){e.next=22;break}return k.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.t0.toString()),e.abrupt("return");case 22:throw e.t0;case 23:if("stable"!==this._pc.signalingState){e.next=25;break}return e.abrupt("return");case 25:return a={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=29,this._pc.setRemoteDescription(a);case 29:case"end":return e.stop()}}),e,this,[[12,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=s(i().mark((function e(t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=s(i().mark((function e(t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.UnsupportedError(" not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=s(i().mark((function e(t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.UnsupportedError("not supported");case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,a=t.maxRetransmits,s=t.label,c=t.protocol,this.assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:a,protocol:c},k.debug("sendDataChannel() [options:%o]",u),d=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%x.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=h.parse(p.sdp),f=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:l});case 15:return k.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),m={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=23,this._pc.setRemoteDescription(m);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:d,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,g,y,_,w,S,x,R,C=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),a=[],s=n(t);try{for(s.s();!(c=s.n()).done;)o=c.value,u=o.trackId,d=o.kind,p=o.rtpParameters,l=o.streamId,k.debug("receive() [trackId:%s, kind:%s]",u,d),f=d,this._remoteSdp.receive({mid:f,kind:d,offerRtpParameters:p,streamId:l||p.rtcp.cname,trackId:u})}catch(i){s.e(i)}finally{s.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),e.next=8,this._pc.setRemoteDescription(m);case 8:return e.next=10,this._pc.createAnswer();case 10:v=e.sent,g=h.parse(v.sdp),y=n(t);try{for(w=function(){var e=_.value,t=e.kind,r=e.rtpParameters,n=t,a=g.media.find((function(e){return String(e.mid)===n}));b.applyCodecParameters({offerRtpParameters:r,answerMediaObject:a})},y.s();!(_=y.n()).done;)w()}catch(i){y.e(i)}finally{y.f()}if(v={type:"answer",sdp:h.write(g)},this._transportReady){e.next=18;break}return e.next=18,this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:g});case 18:return k.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),e.next=21,this._pc.setLocalDescription(v);case 21:S=n(t);try{for(R=function(){var e=x.value,t=e.kind,r=e.trackId,n=e.rtpParameters,i=t,s=r,c=e.streamId||n.rtcp.cname,o=C._pc.getRemoteStreams().find((function(e){return e.id===c})).getTrackById(s);if(!o)throw new Error("remote track not found");C._mapRecvLocalIdInfo.set(s,{mid:i,rtpParameters:n}),a.push({localId:s,track:o})},S.s();!(x=S.n()).done;)R()}catch(i){S.e(i)}finally{S.f()}return e.abrupt("return",a);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t);try{for(r.s();!(a=r.n()).done;)s=a.value,k.debug("stopReceiving() [localId:%s]",s),c=this._mapRecvLocalIdInfo.get(s)||{},o=c.mid,u=c.rtpParameters,this._mapRecvLocalIdInfo.delete(s),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:u})}catch(i){r.e(i)}finally{r.f()}return d={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=7,this._pc.setRemoteDescription(d);case 7:return e.next=9,this._pc.createAnswer();case 9:return p=e.sent,k.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",p),e.next=13,this._pc.setLocalDescription(p);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,a=t.protocol,this.assertRecvDirection(),c=r.streamId,o=r.ordered,u=r.maxPacketLifeTime,d=r.maxRetransmits,p={negotiated:!0,id:c,ordered:o,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:d,protocol:a},k.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),f={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=12,this._pc.setRemoteDescription(f);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=h.parse(m.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return k.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=s(i().mark((function e(t){var r,n,a,s=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=h.parse(this._pc.localDescription.sdp)),(a=b.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){s.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new r}}}]),r}(w.HandlerInterface);t.Chrome55=R},8719:function(e,t,r){"use strict";var n=r(4704).default,a=r(2122).default,i=r(7061).default,s=r(7156).default,c=r(6690).default,o=r(9728).default,u=r(1655).default,d=r(6389).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome67=void 0;var h=f(r(7724)),m=r(4115),v=f(r(3001)),g=f(r(1777)),y=f(r(8978)),b=f(r(9547)),_=r(4376),w=r(9678),S=new m.Logger("Chrome67"),k={OS:1024,MIS:1024},x=function(e){u(r,e);var t=d(r);function r(){var e;return c(this,r),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdRtpSender=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return o(r,[{key:"name",get:function(){return"Chrome67"}},{key:"close",value:function(){if(S.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=s(i().mark((function e(){var t,r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:r=e.sent;try{t.close()}catch(i){}return n=h.parse(r.sdp),a=y.extractRtpCapabilities({sdpObject:n}),e.abrupt("return",a);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(s){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:k});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,c=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,d=e.additionalSettings,p=e.proprietaryConstraints,l=e.extendedRtpCapabilities;S.debug("run()"),this._direction=r,this._remoteSdp=new w.RemoteSdp({iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:c,planB:!0}),this._sendingRtpParametersByKind={audio:g.getSendingRtpParameters("audio",l),video:g.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:g.getSendingRemoteRtpParameters("audio",l),video:g.getSendingRemoteRtpParameters("video",l)},s.role&&"auto"!==s.role&&(this._forcedLocalDtlsRole="server"===s.role?"client":"server"),this._pc=new RTCPeerConnection(a({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},d),p),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(S.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=s(i().mark((function e(t){var r,n,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,S.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},S.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},S.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:return e.next=23,this._pc.createAnswer();case 23:return s=e.sent,S.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),e.next=27,this._pc.setLocalDescription(s);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,_,w,k,x,R;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,a=t.encodings,s=t.codecOptions,c=t.codec,this.assertSendDirection(),S.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),c&&S.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addTrack(r,this._sendStream),e.next=8,this._pc.createOffer();case 8:if(u=e.sent,d=h.parse(u.sdp),(l=v.clone(this._sendingRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(l.codecs),(f=v.clone(this._sendingRemoteRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(f.codecs),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:d});case 17:return"video"===r.kind&&a&&a.length>1&&(S.debug("send() | enabling simulcast"),d=h.parse(u.sdp),p=d.media.find((function(e){return"video"===e.type})),b.addLegacySimulcast({offerMediaObject:p,track:r,numStreams:a.length}),u={type:"offer",sdp:h.write(d)}),S.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),e.next=21,this._pc.setLocalDescription(u);case 21:if(d=h.parse(this._pc.localDescription.sdp),p=d.media.find((function(e){return e.type===r.kind})),l.rtcp.cname=y.getCname({offerMediaObject:p}),l.encodings=b.getRtpEncodings({offerMediaObject:p,track:r}),a)for(m=0;m<l.encodings.length;++m)a[m]&&Object.assign(l.encodings[m],a[m]);if(l.encodings.length>1&&"video/vp8"===l.codecs[0].mimeType.toLowerCase()){_=n(l.encodings);try{for(_.s();!(w=_.n()).done;)w.value.scalabilityMode="L1T3"}catch(i){_.e(i)}finally{_.f()}}return this._remoteSdp.send({offerMediaObject:p,offerRtpParameters:l,answerRtpParameters:f,codecOptions:s}),k={type:"answer",sdp:this._remoteSdp.getSdp()},S.debug("send() | calling pc.setRemoteDescription() [answer:%o]",k),e.next=32,this._pc.setRemoteDescription(k);case 32:return x=String(this._nextSendLocalId),this._nextSendLocalId++,R=this._pc.getSenders().find((function(e){return e.track===r})),this._mapSendLocalIdRtpSender.set(x,R),e.abrupt("return",{localId:x,rtpParameters:l,rtpSender:R});case 37:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),S.debug("stopSending() [localId:%s]",t),r=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return this._pc.removeTrack(r),r.track&&this._sendStream.removeTrack(r.track),this._mapSendLocalIdRtpSender.delete(t),e.next=10,this._pc.createOffer();case 10:return n=e.sent,S.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.prev=12,e.next=15,this._pc.setLocalDescription(n);case 15:e.next=23;break;case 17:if(e.prev=17,e.t0=e.catch(12),0!==this._sendStream.getTracks().length){e.next=22;break}return S.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.t0.toString()),e.abrupt("return");case 22:throw e.t0;case 23:if("stable"!==this._pc.signalingState){e.next=25;break}return e.abrupt("return");case 25:return a={type:"answer",sdp:this._remoteSdp.getSdp()},S.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=29,this._pc.setRemoteDescription(a);case 29:case"end":return e.stop()}}),e,this,[[12,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=s(i().mark((function e(t,r){var n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r?S.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):S.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return a=n.track,e.next=8,n.replaceTrack(r);case 8:a&&this._sendStream.removeTrack(a),r&&this._sendStream.addTrack(r);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=s(i().mark((function e(t,r){var n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),S.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(a=n.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=9,n.setParameters(a);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=s(i().mark((function e(t,r){var n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),S.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(s=n.getParameters()).encodings.forEach((function(e,t){s.encodings[t]=a(a({},e),r)})),e.next=9,n.setParameters(s);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return e.abrupt("return",r.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,a=t.maxRetransmits,s=t.label,c=t.protocol,this.assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:a,protocol:c},S.debug("sendDataChannel() [options:%o]",u),d=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%k.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=h.parse(p.sdp),f=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:l});case 15:return S.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),m={type:"answer",sdp:this._remoteSdp.getSdp()},S.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=23,this._pc.setRemoteDescription(m);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:d,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,g,b,_,w,k,x,R,C=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),a=[],s=n(t);try{for(s.s();!(c=s.n()).done;)o=c.value,u=o.trackId,d=o.kind,p=o.rtpParameters,l=o.streamId,S.debug("receive() [trackId:%s, kind:%s]",u,d),f=d,this._remoteSdp.receive({mid:f,kind:d,offerRtpParameters:p,streamId:l||p.rtcp.cname,trackId:u})}catch(i){s.e(i)}finally{s.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},S.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),e.next=8,this._pc.setRemoteDescription(m);case 8:return e.next=10,this._pc.createAnswer();case 10:v=e.sent,g=h.parse(v.sdp),b=n(t);try{for(w=function(){var e=_.value,t=e.kind,r=e.rtpParameters,n=t,a=g.media.find((function(e){return String(e.mid)===n}));y.applyCodecParameters({offerRtpParameters:r,answerMediaObject:a})},b.s();!(_=b.n()).done;)w()}catch(i){b.e(i)}finally{b.f()}if(v={type:"answer",sdp:h.write(g)},this._transportReady){e.next=18;break}return e.next=18,this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:g});case 18:return S.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),e.next=21,this._pc.setLocalDescription(v);case 21:k=n(t);try{for(R=function(){var e=x.value,t=e.kind,r=e.trackId,n=e.rtpParameters,i=r,s=t,c=C._pc.getReceivers().find((function(e){return e.track&&e.track.id===i}));if(!c)throw new Error("new RTCRtpReceiver not");C._mapRecvLocalIdInfo.set(i,{mid:s,rtpParameters:n,rtpReceiver:c}),a.push({localId:i,track:c.track,rtpReceiver:c})},k.s();!(x=k.n()).done;)R()}catch(i){k.e(i)}finally{k.f()}return e.abrupt("return",a);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t);try{for(r.s();!(a=r.n()).done;)s=a.value,S.debug("stopReceiving() [localId:%s]",s),c=this._mapRecvLocalIdInfo.get(s)||{},o=c.mid,u=c.rtpParameters,this._mapRecvLocalIdInfo.delete(s),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:u})}catch(i){r.e(i)}finally{r.f()}return d={type:"offer",sdp:this._remoteSdp.getSdp()},S.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=7,this._pc.setRemoteDescription(d);case 7:return e.next=9,this._pc.createAnswer();case 9:return p=e.sent,S.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",p),e.next=13,this._pc.setLocalDescription(p);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=s(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapRecvLocalIdInfo.get(t)||{},n=r.rtpReceiver){e.next=4;break}throw new Error("associated RTCRtpReceiver not found");case 4:return e.abrupt("return",n.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,a=t.protocol,this.assertRecvDirection(),c=r.streamId,o=r.ordered,u=r.maxPacketLifeTime,d=r.maxRetransmits,p={negotiated:!0,id:c,ordered:o,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:d,protocol:a},S.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),f={type:"offer",sdp:this._remoteSdp.getSdp()},S.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=12,this._pc.setRemoteDescription(f);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=h.parse(m.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return S.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=s(i().mark((function e(t){var r,n,a,s=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=h.parse(this._pc.localDescription.sdp)),(a=y.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){s.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new r}}}]),r}(_.HandlerInterface);t.Chrome67=x},1521:function(e,t,r){"use strict";var n=r(4704).default,a=r(2122).default,i=r(7061).default,s=r(7156).default,c=r(6690).default,o=r(9728).default,u=r(1655).default,d=r(6389).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome70=void 0;var h=f(r(7724)),m=r(4115),v=f(r(3001)),g=f(r(1777)),y=f(r(8978)),b=f(r(8480)),_=r(4376),w=r(9678),S=r(8732),k=new m.Logger("Chrome70"),x={OS:1024,MIS:1024},R=function(e){u(r,e);var t=d(r);function r(){var e;return c(this,r),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return o(r,[{key:"name",get:function(){return"Chrome70"}},{key:"close",value:function(){if(k.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=s(i().mark((function e(){var t,r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:r=e.sent;try{t.close()}catch(i){}return n=h.parse(r.sdp),a=y.extractRtpCapabilities({sdpObject:n}),e.abrupt("return",a);case 14:e.prev=14,e.t0=e.catch(2);try{t.close()}catch(s){}throw e.t0;case 18:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:x});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,c=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,d=e.additionalSettings,p=e.proprietaryConstraints,l=e.extendedRtpCapabilities;k.debug("run()"),this._direction=r,this._remoteSdp=new w.RemoteSdp({iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:c}),this._sendingRtpParametersByKind={audio:g.getSendingRtpParameters("audio",l),video:g.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:g.getSendingRemoteRtpParameters("audio",l),video:g.getSendingRemoteRtpParameters("video",l)},s.role&&"auto"!==s.role&&(this._forcedLocalDtlsRole="server"===s.role?"client":"server"),this._pc=new RTCPeerConnection(a({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},d),p),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(k.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=s(i().mark((function e(t){var r,n,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,k.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:return e.next=23,this._pc.createAnswer();case 23:return s=e.sent,k.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),e.next=27,this._pc.setLocalDescription(s);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,_,w,x,R,C,P,D,T,M,O,E,L;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,a=t.encodings,s=t.codecOptions,c=t.codec,this.assertSendDirection(),k.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),(u=v.clone(this._sendingRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(u.codecs,c),(d=v.clone(this._sendingRemoteRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(d.codecs,c),p=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]}),e.next=11,this._pc.createOffer();case 11:if(f=e.sent,m=h.parse(f.sdp),this._transportReady){e.next=16;break}return e.next=16,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:m});case 16:return a&&a.length>1&&(k.debug("send() | enabling legacy simulcast"),m=h.parse(f.sdp),_=m.media[p.idx],b.addLegacySimulcast({offerMediaObject:_,numStreams:a.length}),f={type:"offer",sdp:h.write(m)}),w=!1,x=(0,S.parse)((a||[{}])[0].scalabilityMode),a&&1===a.length&&x.spatialLayers>1&&"video/vp9"===u.codecs[0].mimeType.toLowerCase()&&(k.debug("send() | enabling legacy simulcast for VP9 SVC"),w=!0,m=h.parse(f.sdp),_=m.media[p.idx],b.addLegacySimulcast({offerMediaObject:_,numStreams:x.spatialLayers}),f={type:"offer",sdp:h.write(m)}),k.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=23,this._pc.setLocalDescription(f);case 23:if(!a){e.next=38;break}k.debug("send() | applying given encodings"),R=l.sender.getParameters(),C=0;case 27:if(!(C<(R.encodings||[]).length)){e.next=36;break}if(P=R.encodings[C],D=a[C]){e.next=32;break}return e.abrupt("break",36);case 32:R.encodings[C]=Object.assign(P,D);case 33:++C,e.next=27;break;case 36:return e.next=38,l.sender.setParameters(R);case 38:if(T=l.mid,u.mid=T,m=h.parse(this._pc.localDescription.sdp),_=m.media[p.idx],u.rtcp.cname=y.getCname({offerMediaObject:_}),u.encodings=b.getRtpEncodings({offerMediaObject:_}),a)for(M=0;M<u.encodings.length;++M)a[M]&&Object.assign(u.encodings[M],a[M]);if(w&&(u.encodings=[u.encodings[0]]),u.encodings.length>1&&("video/vp8"===u.codecs[0].mimeType.toLowerCase()||"video/h264"===u.codecs[0].mimeType.toLowerCase())){O=n(u.encodings);try{for(O.s();!(E=O.n()).done;)E.value.scalabilityMode="L1T3"}catch(i){O.e(i)}finally{O.f()}}return this._remoteSdp.send({offerMediaObject:_,reuseMid:p.reuseMid,offerRtpParameters:u,answerRtpParameters:d,codecOptions:s}),L={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("send() | calling pc.setRemoteDescription() [answer:%o]",L),e.next=52,this._pc.setRemoteDescription(L);case 52:return this._mapMidTransceiver.set(T,l),e.abrupt("return",{localId:T,rtpParameters:u,rtpSender:l.sender});case 54:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),k.debug("stopSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch(i){}return e.next=11,this._pc.createOffer();case 11:return n=e.sent,k.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=15,this._pc.setLocalDescription(n);case 15:return a={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=19,this._pc.setRemoteDescription(a);case 19:this._mapMidTransceiver.delete(t);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=s(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r?k.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):k.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.next=7,n.sender.replaceTrack(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=s(i().mark((function e(t,r){var n,a,s,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),k.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=n.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=9,n.sender.setParameters(a);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=12,this._pc.createOffer();case 12:return s=e.sent,k.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),e.next=16,this._pc.setLocalDescription(s);case 16:return c={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",c),e.next=20,this._pc.setRemoteDescription(c);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=s(i().mark((function e(t,r){var n,s,c,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),k.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(s=n.sender.getParameters()).encodings.forEach((function(e,t){s.encodings[t]=a(a({},e),r)})),e.next=9,n.sender.setParameters(s);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings),e.next=12,this._pc.createOffer();case 12:return c=e.sent,k.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",c),e.next=16,this._pc.setLocalDescription(c);case 16:return o={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=20,this._pc.setRemoteDescription(o);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.sender.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,a=t.maxRetransmits,s=t.label,c=t.protocol,this.assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:a,protocol:c},k.debug("sendDataChannel() [options:%o]",u),d=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%x.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=h.parse(p.sdp),f=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:l});case 15:return k.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),m={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=23,this._pc.setRemoteDescription(m);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:d,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,g,b,_,w,S,x,R,C,P=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),a=[],s=new Map,c=n(t);try{for(c.s();!(o=c.n()).done;)u=o.value,d=u.trackId,p=u.kind,l=u.rtpParameters,f=u.streamId,k.debug("receive() [trackId:%s, kind:%s]",d,p),m=l.mid||String(this._mapMidTransceiver.size),s.set(d,m),this._remoteSdp.receive({mid:m,kind:p,offerRtpParameters:l,streamId:f||l.rtcp.cname,trackId:d})}catch(i){c.e(i)}finally{c.f()}return v={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",v),e.next=9,this._pc.setRemoteDescription(v);case 9:return e.next=11,this._pc.createAnswer();case 11:g=e.sent,b=h.parse(g.sdp),_=n(t);try{for(S=function(){var e=w.value,t=e.trackId,r=e.rtpParameters,n=s.get(t),a=b.media.find((function(e){return String(e.mid)===n}));y.applyCodecParameters({offerRtpParameters:r,answerMediaObject:a})},_.s();!(w=_.n()).done;)S()}catch(i){_.e(i)}finally{_.f()}if(g={type:"answer",sdp:h.write(b)},this._transportReady){e.next=19;break}return e.next=19,this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:b});case 19:return k.debug("receive() | calling pc.setLocalDescription() [answer:%o]",g),e.next=22,this._pc.setLocalDescription(g);case 22:x=n(t);try{for(C=function(){var e=R.value.trackId,t=s.get(e),r=P._pc.getTransceivers().find((function(e){return e.mid===t}));if(!r)throw new Error("new RTCRtpTransceiver not found");P._mapMidTransceiver.set(t,r),a.push({localId:t,track:r.receiver.track,rtpReceiver:r.receiver})},x.s();!(R=x.n()).done;)C()}catch(i){x.e(i)}finally{x.f()}return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=13;break}if(s=a.value,k.debug("stopReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:this._remoteSdp.closeMediaSection(c.mid);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return u=e.sent,k.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=31,this._pc.setLocalDescription(u);case 31:d=n(t);try{for(d.s();!(p=d.n()).done;)l=p.value,this._mapMidTransceiver.delete(l)}catch(i){d.e(i)}finally{d.f()}case 33:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,a=t.protocol,this.assertRecvDirection(),c=r.streamId,o=r.ordered,u=r.maxPacketLifeTime,d=r.maxRetransmits,p={negotiated:!0,id:c,ordered:o,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:d,protocol:a},k.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),f={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=12,this._pc.setRemoteDescription(f);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=h.parse(m.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return k.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=s(i().mark((function e(t){var r,n,a,s=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=h.parse(this._pc.localDescription.sdp)),(a=y.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){s.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new r}}}]),r}(_.HandlerInterface);t.Chrome70=R},6139:function(e,t,r){"use strict";var n=r(4704).default,a=r(2122).default,i=r(7061).default,s=r(7156).default,c=r(6690).default,o=r(9728).default,u=r(1655).default,d=r(6389).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Chrome74=void 0;var h=f(r(7724)),m=r(4115),v=f(r(3001)),g=f(r(1777)),y=f(r(8978)),b=f(r(8480)),_=f(r(4032)),w=r(4376),S=r(9678),k=r(8732),x=new m.Logger("Chrome74"),R={OS:1024,MIS:1024},C=function(e){u(r,e);var t=d(r);function r(){var e;return c(this,r),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return o(r,[{key:"name",get:function(){return"Chrome74"}},{key:"close",value:function(){if(x.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=s(i().mark((function e(){var t,r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:r=e.sent;try{t.close()}catch(i){}return n=h.parse(r.sdp),a=y.extractRtpCapabilities({sdpObject:n}),_.addNackSuppportForOpus(a),e.abrupt("return",a);case 15:e.prev=15,e.t0=e.catch(2);try{t.close()}catch(s){}throw e.t0;case 19:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:R});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,c=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,d=e.additionalSettings,p=e.proprietaryConstraints,l=e.extendedRtpCapabilities;x.debug("run()"),this._direction=r,this._remoteSdp=new S.RemoteSdp({iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:c}),this._sendingRtpParametersByKind={audio:g.getSendingRtpParameters("audio",l),video:g.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:g.getSendingRemoteRtpParameters("audio",l),video:g.getSendingRemoteRtpParameters("video",l)},s.role&&"auto"!==s.role&&(this._forcedLocalDtlsRole="server"===s.role?"client":"server"),this._pc=new RTCPeerConnection(a({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},d),p),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):(x.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}})))}},{key:"updateIceServers",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=s(i().mark((function e(t){var r,n,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,x.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:return e.next=23,this._pc.createAnswer();case 23:return s=e.sent,x.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),e.next=27,this._pc.setLocalDescription(s);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,_,w,S,R,C,P,D,T,M;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,a=t.encodings,s=t.codecOptions,c=t.codec,this.assertSendDirection(),x.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),a&&a.length>1&&a.forEach((function(e,t){e.rid="r".concat(t)})),(u=v.clone(this._sendingRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(u.codecs,c),(d=v.clone(this._sendingRemoteRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(d.codecs,c),p=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:a}),e.next=12,this._pc.createOffer();case 12:if(f=e.sent,m=h.parse(f.sdp),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:m});case 17:return w=!1,S=(0,k.parse)((a||[{}])[0].scalabilityMode),a&&1===a.length&&S.spatialLayers>1&&"video/vp9"===u.codecs[0].mimeType.toLowerCase()&&(x.debug("send() | enabling legacy simulcast for VP9 SVC"),w=!0,m=h.parse(f.sdp),_=m.media[p.idx],b.addLegacySimulcast({offerMediaObject:_,numStreams:S.spatialLayers}),f={type:"offer",sdp:h.write(m)}),x.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=23,this._pc.setLocalDescription(f);case 23:if(R=l.mid,u.mid=R,m=h.parse(this._pc.localDescription.sdp),_=m.media[p.idx],u.rtcp.cname=y.getCname({offerMediaObject:_}),a?1===a.length?(C=b.getRtpEncodings({offerMediaObject:_}),Object.assign(C[0],a[0]),w&&(C=[C[0]]),u.encodings=C):u.encodings=a:u.encodings=b.getRtpEncodings({offerMediaObject:_}),u.encodings.length>1&&("video/vp8"===u.codecs[0].mimeType.toLowerCase()||"video/h264"===u.codecs[0].mimeType.toLowerCase())){P=n(u.encodings);try{for(P.s();!(D=P.n()).done;)(T=D.value).scalabilityMode?T.scalabilityMode="L1T".concat(S.temporalLayers):T.scalabilityMode="L1T3"}catch(i){P.e(i)}finally{P.f()}}return this._remoteSdp.send({offerMediaObject:_,reuseMid:p.reuseMid,offerRtpParameters:u,answerRtpParameters:d,codecOptions:s,extmapAllowMixed:!0}),M={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("send() | calling pc.setRemoteDescription() [answer:%o]",M),e.next=35,this._pc.setRemoteDescription(M);case 35:return this._mapMidTransceiver.set(R,l),e.abrupt("return",{localId:R,rtpParameters:u,rtpSender:l.sender});case 37:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("stopSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch(i){}return e.next=11,this._pc.createOffer();case 11:return n=e.sent,x.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=15,this._pc.setLocalDescription(n);case 15:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=19,this._pc.setRemoteDescription(a);case 19:this._mapMidTransceiver.delete(t);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("pauseSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return r.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=9,this._pc.createOffer();case 9:return n=e.sent,x.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=13,this._pc.setLocalDescription(n);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=17,this._pc.setRemoteDescription(a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("resumeSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t),this._remoteSdp.resumeSendingMediaSection(t),r){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return r.direction="sendonly",e.next=9,this._pc.createOffer();case 9:return n=e.sent,x.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=13,this._pc.setLocalDescription(n);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=17,this._pc.setRemoteDescription(a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=s(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r?x.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):x.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.next=7,n.sender.replaceTrack(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=s(i().mark((function e(t,r){var n,a,s,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=n.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=9,n.sender.setParameters(a);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=12,this._pc.createOffer();case 12:return s=e.sent,x.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),e.next=16,this._pc.setLocalDescription(s);case 16:return c={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",c),e.next=20,this._pc.setRemoteDescription(c);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=s(i().mark((function e(t,r){var n,s,c,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(s=n.sender.getParameters()).encodings.forEach((function(e,t){s.encodings[t]=a(a({},e),r)})),e.next=9,n.sender.setParameters(s);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings),e.next=12,this._pc.createOffer();case 12:return c=e.sent,x.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",c),e.next=16,this._pc.setLocalDescription(c);case 16:return o={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=20,this._pc.setRemoteDescription(o);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.sender.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,a=t.maxRetransmits,s=t.label,c=t.protocol,this.assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:a,protocol:c},x.debug("sendDataChannel() [options:%o]",u),d=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%R.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=h.parse(p.sdp),f=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:l});case 15:return x.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),m={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=23,this._pc.setRemoteDescription(m);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:d,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,g,b,_,w,S,k,R,C,P=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),a=[],s=new Map,c=n(t);try{for(c.s();!(o=c.n()).done;)u=o.value,d=u.trackId,p=u.kind,l=u.rtpParameters,f=u.streamId,x.debug("receive() [trackId:%s, kind:%s]",d,p),m=l.mid||String(this._mapMidTransceiver.size),s.set(d,m),this._remoteSdp.receive({mid:m,kind:p,offerRtpParameters:l,streamId:f||l.rtcp.cname,trackId:d})}catch(i){c.e(i)}finally{c.f()}return v={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",v),e.next=9,this._pc.setRemoteDescription(v);case 9:return e.next=11,this._pc.createAnswer();case 11:g=e.sent,b=h.parse(g.sdp),_=n(t);try{for(S=function(){var e=w.value,t=e.trackId,r=e.rtpParameters,n=s.get(t),a=b.media.find((function(e){return String(e.mid)===n}));y.applyCodecParameters({offerRtpParameters:r,answerMediaObject:a})},_.s();!(w=_.n()).done;)S()}catch(i){_.e(i)}finally{_.f()}if(g={type:"answer",sdp:h.write(b)},this._transportReady){e.next=19;break}return e.next=19,this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:b});case 19:return x.debug("receive() | calling pc.setLocalDescription() [answer:%o]",g),e.next=22,this._pc.setLocalDescription(g);case 22:k=n(t);try{for(C=function(){var e=R.value.trackId,t=s.get(e),r=P._pc.getTransceivers().find((function(e){return e.mid===t}));if(!r)throw new Error("new RTCRtpTransceiver not found");P._mapMidTransceiver.set(t,r),a.push({localId:t,track:r.receiver.track,rtpReceiver:r.receiver})},k.s();!(R=k.n()).done;)C()}catch(i){k.e(i)}finally{k.f()}return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=13;break}if(s=a.value,x.debug("stopReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:this._remoteSdp.closeMediaSection(c.mid);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return u=e.sent,x.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=31,this._pc.setLocalDescription(u);case 31:d=n(t);try{for(d.s();!(p=d.n()).done;)l=p.value,this._mapMidTransceiver.delete(l)}catch(i){d.e(i)}finally{d.f()}case 33:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=14;break}if(s=a.value,x.debug("pauseReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:c.direction="inactive",this._remoteSdp.pauseMediaSection(s);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=26,this._pc.setRemoteDescription(o);case 26:return e.next=28,this._pc.createAnswer();case 28:return u=e.sent,x.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=32,this._pc.setLocalDescription(u);case 32:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=14;break}if(s=a.value,x.debug("resumeReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:c.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(s);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=26,this._pc.setRemoteDescription(o);case 26:return e.next=28,this._pc.createAnswer();case 28:return u=e.sent,x.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=32,this._pc.setLocalDescription(u);case 32:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,a=t.protocol,this.assertRecvDirection(),c=r.streamId,o=r.ordered,u=r.maxPacketLifeTime,d=r.maxRetransmits,p={negotiated:!0,id:c,ordered:o,maxPacketLifeTime:u,maxRetransmits:d,protocol:a},x.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),f={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=12,this._pc.setRemoteDescription(f);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=h.parse(m.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=s(i().mark((function e(t){var r,n,a,s=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=h.parse(this._pc.localDescription.sdp)),(a=y.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){s.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new r}}}]),r}(w.HandlerInterface);t.Chrome74=C},7516:function(e,t,r){"use strict";var n=r(2122).default,a=r(7061).default,i=r(7156).default,s=r(4704).default,c=r(6690).default,o=r(9728).default,u=r(1655).default,d=r(6389).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Edge11=void 0;var h=r(4115),m=r(6431),v=f(r(3001)),g=f(r(1777)),y=f(r(9132)),b=r(4376),_=new h.Logger("Edge11"),w=function(e){u(r,e);var t=d(r);function r(){var e;return c(this,r),(e=t.call(this))._rtpSenders=new Map,e._rtpReceivers=new Map,e._nextSendLocalId=0,e._transportReady=!1,e}return o(r,[{key:"name",get:function(){return"Edge11"}},{key:"close",value:function(){_.debug("close()");try{this._iceGatherer.close()}catch(c){}try{this._iceTransport.stop()}catch(c){}try{this._dtlsTransport.stop()}catch(c){}var e,t=s(this._rtpSenders.values());try{for(t.s();!(e=t.n()).done;){var r=e.value;try{r.stop()}catch(c){}}}catch(o){t.e(o)}finally{t.f()}var n,a=s(this._rtpReceivers.values());try{for(a.s();!(n=a.n()).done;){var i=n.value;try{i.stop()}catch(c){}}}catch(o){a.e(o)}finally{a.f()}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=i(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _.debug("getNativeRtpCapabilities()"),e.abrupt("return",y.getCapabilities());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=i(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:{OS:0,MIS:0}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){e.direction;var t=e.iceParameters,r=e.iceCandidates,n=e.dtlsParameters,a=(e.sctpParameters,e.iceServers),i=e.iceTransportPolicy,s=(e.additionalSettings,e.proprietaryConstraints,e.extendedRtpCapabilities);_.debug("run()"),this._sendingRtpParametersByKind={audio:g.getSendingRtpParameters("audio",s),video:g.getSendingRtpParameters("video",s)},this._remoteIceParameters=t,this._remoteIceCandidates=r,this._remoteDtlsParameters=n,this._cname="CNAME-".concat(v.generateRandomNumber()),this.setIceGatherer({iceServers:a,iceTransportPolicy:i}),this.setIceTransport(),this.setDtlsTransport()}},{key:"updateIceServers",value:function(){var e=i(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new m.UnsupportedError("not supported");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=i(a().mark((function e(t){var r,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.debug("restartIce()"),this._remoteIceParameters=t,this._transportReady){e.next=4;break}return e.abrupt("return");case 4:_.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,t,"controlling"),r=s(this._remoteIceCandidates);try{for(r.s();!(n=r.n()).done;)i=n.value,this._iceTransport.addRemoteCandidate(i)}catch(a){r.e(a)}finally{r.f()}this._iceTransport.addRemoteCandidate({});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=i(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._iceTransport.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=i(a().mark((function e(t){var r,n,i,c,o,u,d,p,l,f,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.track,n=t.encodings,t.codecOptions,i=t.codec,_.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),this._transportReady){e.next=5;break}return e.next=5,this.setupTransport({localDtlsRole:"server"});case 5:_.debug("send() | calling new RTCRtpSender()"),c=new RTCRtpSender(r,this._dtlsTransport),(o=v.clone(this._sendingRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(o.codecs,i),u=o.codecs.some((function(e){return/.+\/rtx$/i.test(e.mimeType)})),n||(n=[{}]),d=s(n);try{for(d.s();!(p=d.n()).done;)(l=p.value).ssrc=v.generateRandomNumber(),u&&(l.rtx={ssrc:v.generateRandomNumber()})}catch(a){d.e(a)}finally{d.f()}return o.encodings=n,o.rtcp={cname:this._cname,reducedSize:!0,mux:!0},f=y.mangleRtpParameters(o),_.debug("send() | calling rtpSender.send() [params:%o]",f),e.next=19,c.send(f);case 19:return h=String(this._nextSendLocalId),this._nextSendLocalId++,this._rtpSenders.set(h,c),e.abrupt("return",{localId:h,rtpParameters:o,rtpSender:c});case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=i(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.debug("stopSending() [localId:%s]",t),r=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:this._rtpSenders.delete(t),e.prev=5,_.debug("stopSending() | calling rtpSender.stop()"),r.stop(),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(5),_.warn("stopSending() | rtpSender.stop() failed:%o",e.t0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[5,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=i(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=i(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=i(a().mark((function e(t,r){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r?_.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):_.debug("replaceTrack() [localId:%s, no track]",t),n=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:n.setTrack(r);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=i(a().mark((function e(t,r){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:return(i=n.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=8,n.setParameters(i);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=i(a().mark((function e(t,r){var i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),i=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:return(s=i.getParameters()).encodings.forEach((function(e,t){s.encodings[t]=n(n({},e),r)})),e.next=8,i.setParameters(s);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=i(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._rtpSenders.get(t)){e.next=3;break}throw new Error("RTCRtpSender not found");case 3:return e.abrupt("return",r.getStats());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=i(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new m.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=i(a().mark((function e(t){var r,n,i,c,o,u,d,p,l,f,h,m,v,g,b;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],n=s(t);try{for(n.s();!(i=n.n()).done;)c=i.value,o=c.trackId,u=c.kind,_.debug("receive() [trackId:%s, kind:%s]",o,u)}catch(a){n.e(a)}finally{n.f()}if(this._transportReady){e.next=6;break}return e.next=6,this.setupTransport({localDtlsRole:"server"});case 6:d=s(t),e.prev=7,d.s();case 9:if((p=d.n()).done){e.next=24;break}return l=p.value,f=l.trackId,h=l.kind,m=l.rtpParameters,_.debug("receive() | calling new RTCRtpReceiver()"),(v=new RTCRtpReceiver(this._dtlsTransport,h)).addEventListener("error",(function(e){_.error('rtpReceiver "error" event [event:%o]',e)})),g=y.mangleRtpParameters(m),_.debug("receive() | calling rtpReceiver.receive() [params:%o]",g),e.next=19,v.receive(g);case 19:b=f,this._rtpReceivers.set(b,v),r.push({localId:b,track:v.track,rtpReceiver:v});case 22:e.next=9;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(7),d.e(e.t0);case 29:return e.prev=29,d.f(),e.finish(29);case 32:return e.abrupt("return",r);case 33:case"end":return e.stop()}}),e,this,[[7,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=i(a().mark((function e(t){var r,n,i,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=s(t),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=13;break}if(i=n.value,_.debug("stopReceiving() [localId:%s]",i),c=this._rtpReceivers.get(i)){e.next=9;break}throw new Error("RTCRtpReceiver not found");case 9:this._rtpReceivers.delete(i);try{_.debug("stopReceiving() | calling rtpReceiver.stop()"),c.stop()}catch(a){_.warn("stopReceiving() | rtpReceiver.stop() failed:%o",a)}case 11:e.next=3;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[1,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=i(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=i(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=i(a().mark((function e(t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._rtpReceivers.get(t)){e.next=3;break}throw new Error("RTCRtpReceiver not found");case 3:return e.abrupt("return",r.getStats());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=i(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new m.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setIceGatherer",value:function(e){var t=e.iceServers,r=e.iceTransportPolicy,n=new RTCIceGatherer({iceServers:t||[],gatherPolicy:r||"all"});n.addEventListener("error",(function(e){_.error('iceGatherer "error" event [event:%o]',e)}));try{n.gather()}catch(a){_.debug("setIceGatherer() | iceGatherer.gather() failed: %s",a.toString())}this._iceGatherer=n}},{key:"setIceTransport",value:function(){var e=this,t=new RTCIceTransport(this._iceGatherer);t.addEventListener("statechange",(function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}})),t.addEventListener("icestatechange",(function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}})),t.addEventListener("candidatepairchange",(function(e){_.debug('iceTransport "candidatepairchange" event [pair:%o]',e.pair)})),this._iceTransport=t}},{key:"setDtlsTransport",value:function(){var e=this,t=new RTCDtlsTransport(this._iceTransport);t.addEventListener("statechange",(function(){_.debug('dtlsTransport "statechange" event [state:%s]',t.state)})),t.addEventListener("dtlsstatechange",(function(){_.debug('dtlsTransport "dtlsstatechange" event [state:%s]',t.state),"closed"===t.state&&e.emit("@connectionstatechange","closed")})),t.addEventListener("error",(function(e){_.error('dtlsTransport "error" event [event:%o]',e)})),this._dtlsTransport=t}},{key:"setupTransport",value:function(){var e=i(a().mark((function e(t){var r,n,i,c,o,u=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,_.debug("setupTransport()"),(n=this._dtlsTransport.getLocalParameters()).role=r,e.next=6,new Promise((function(e,t){u.safeEmit("@connect",{dtlsParameters:n},e,t)}));case 6:this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling"),i=s(this._remoteIceCandidates);try{for(i.s();!(c=i.n()).done;)o=c.value,this._iceTransport.addRemoteCandidate(o)}catch(a){i.e(a)}finally{i.f()}this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter((function(e){return"sha-256"===e.algorithm||"sha-384"===e.algorithm||"sha-512"===e.algorithm})),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0;case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"createFactory",value:function(){return function(){return new r}}}]),r}(b.HandlerInterface);t.Edge11=w},1714:function(e,t,r){"use strict";var n=r(4704).default,a=r(2122).default,i=r(7061).default,s=r(7156).default,c=r(6690).default,o=r(9728).default,u=r(1655).default,d=r(6389).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Firefox60=void 0;var h=f(r(7724)),m=r(4115),v=r(6431),g=f(r(3001)),y=f(r(1777)),b=f(r(8978)),_=f(r(8480)),w=r(4376),S=r(9678),k=r(8732),x=new m.Logger("Firefox60"),R={OS:16,MIS:2048},C=function(e){u(r,e);var t=d(r);function r(){var e;return c(this,r),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return o(r,[{key:"name",get:function(){return"Firefox60"}},{key:"close",value:function(){if(x.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=s(i().mark((function e(){var t,r,n,a,s,c,o,u,d,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),(r=document.createElement("canvas")).getContext("2d"),n=r.captureStream(),a=n.getVideoTracks()[0],e.prev=6,t.addTransceiver("audio",{direction:"sendrecv"}),s=t.addTransceiver(a,{direction:"sendrecv"}),c=s.sender.getParameters(),o=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}],c.encodings=o,e.next=14,s.sender.setParameters(c);case 14:return e.next=16,t.createOffer();case 16:u=e.sent;try{r.remove()}catch(i){}try{a.stop()}catch(i){}try{t.close()}catch(i){}return d=h.parse(u.sdp),p=b.extractRtpCapabilities({sdpObject:d}),e.abrupt("return",p);case 25:e.prev=25,e.t0=e.catch(6);try{r.remove()}catch(l){}try{a.stop()}catch(l){}try{t.close()}catch(l){}throw e.t0;case 31:case"end":return e.stop()}}),e,null,[[6,25]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:R});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,c=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,d=e.additionalSettings,p=e.proprietaryConstraints,l=e.extendedRtpCapabilities;x.debug("run()"),this._direction=r,this._remoteSdp=new S.RemoteSdp({iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:c}),this._sendingRtpParametersByKind={audio:y.getSendingRtpParameters("audio",l),video:y.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:y.getSendingRemoteRtpParameters("audio",l),video:y.getSendingRemoteRtpParameters("video",l)},this._pc=new RTCPeerConnection(a({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},d),p),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(x.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.UnsupportedError("not supported");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=s(i().mark((function e(t){var r,n,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,x.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:return e.next=23,this._pc.createAnswer();case 23:return s=e.sent,x.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),e.next=27,this._pc.setLocalDescription(s);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,w,S,R,C,P,D;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.track,a=t.encodings,s=t.codecOptions,c=t.codec,this.assertSendDirection(),x.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),a&&(a=g.clone(a,[])).length>1&&(a.forEach((function(e,t){e.rid="r".concat(t)})),a.reverse()),(o=g.clone(this._sendingRtpParametersByKind[r.kind],{})).codecs=y.reduceCodecs(o.codecs,c),(u=g.clone(this._sendingRemoteRtpParametersByKind[r.kind],{})).codecs=y.reduceCodecs(u.codecs,c),d=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]}),!a){e.next=14;break}return(p=d.sender.getParameters()).encodings=a,e.next=14,d.sender.setParameters(p);case 14:return e.next=16,this._pc.createOffer();case 16:if(l=e.sent,f=h.parse(l.sdp),this._transportReady){e.next=21;break}return e.next=21,this.setupTransport({localDtlsRole:"client",localSdpObject:f});case 21:return m=(0,k.parse)((a||[{}])[0].scalabilityMode),x.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),e.next=25,this._pc.setLocalDescription(l);case 25:if(v=d.mid,o.mid=v,f=h.parse(this._pc.localDescription.sdp),w=f.media[f.media.length-1],o.rtcp.cname=b.getCname({offerMediaObject:w}),a?1===a.length?(S=_.getRtpEncodings({offerMediaObject:w}),Object.assign(S[0],a[0]),o.encodings=S):o.encodings=a.reverse():o.encodings=_.getRtpEncodings({offerMediaObject:w}),o.encodings.length>1&&("video/vp8"===o.codecs[0].mimeType.toLowerCase()||"video/h264"===o.codecs[0].mimeType.toLowerCase())){R=n(o.encodings);try{for(R.s();!(C=R.n()).done;)(P=C.value).scalabilityMode?P.scalabilityMode="L1T".concat(m.temporalLayers):P.scalabilityMode="L1T3"}catch(i){R.e(i)}finally{R.f()}}return this._remoteSdp.send({offerMediaObject:w,offerRtpParameters:o,answerRtpParameters:u,codecOptions:s,extmapAllowMixed:!0}),D={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("send() | calling pc.setRemoteDescription() [answer:%o]",D),e.next=37,this._pc.setRemoteDescription(D);case 37:return this._mapMidTransceiver.set(v,d),e.abrupt("return",{localId:v,rtpParameters:o,rtpSender:d.sender});case 39:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.debug("stopSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated transceiver not found");case 4:return r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.disableMediaSection(r.mid),e.next=9,this._pc.createOffer();case 9:return n=e.sent,x.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=13,this._pc.setLocalDescription(n);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=17,this._pc.setRemoteDescription(a);case 17:this._mapMidTransceiver.delete(t);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("pauseSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return r.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=9,this._pc.createOffer();case 9:return n=e.sent,x.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=13,this._pc.setLocalDescription(n);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=17,this._pc.setRemoteDescription(a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("resumeSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return r.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(t),e.next=9,this._pc.createOffer();case 9:return n=e.sent,x.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=13,this._pc.setLocalDescription(n);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=17,this._pc.setRemoteDescription(a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=s(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r?x.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):x.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.next=7,n.sender.replaceTrack(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=s(i().mark((function e(t,r){var n,a,s,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated transceiver not found");case 5:return a=n.sender.getParameters(),r=a.encodings.length-1-r,a.encodings.forEach((function(e,t){e.active=t>=r})),e.next=10,n.sender.setParameters(a);case 10:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=13,this._pc.createOffer();case 13:return s=e.sent,x.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),e.next=17,this._pc.setLocalDescription(s);case 17:return c={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",c),e.next=21,this._pc.setRemoteDescription(c);case 21:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=s(i().mark((function e(t,r){var n,s,c,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(s=n.sender.getParameters()).encodings.forEach((function(e,t){s.encodings[t]=a(a({},e),r)})),e.next=9,n.sender.setParameters(s);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings),e.next=12,this._pc.createOffer();case 12:return c=e.sent,x.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",c),e.next=16,this._pc.setLocalDescription(c);case 16:return o={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=20,this._pc.setRemoteDescription(o);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.sender.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,a=t.maxRetransmits,s=t.label,c=t.protocol,this.assertSendDirection(),o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:a,protocol:c},x.debug("sendDataChannel() [options:%o]",o),u=this._pc.createDataChannel(s,o),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%R.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(d=e.sent,p=h.parse(d.sdp),l=p.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:"client",localSdpObject:p});case 15:return x.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:l}),f={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=23,this._pc.setRemoteDescription(f);case 23:this._hasDataChannelMediaSection=!0;case 24:return m={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits},e.abrupt("return",{dataChannel:u,sctpStreamParameters:m});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,g,y,_,w,S,k,R,C=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],a=new Map,s=n(t);try{for(s.s();!(c=s.n()).done;)o=c.value,u=o.trackId,d=o.kind,p=o.rtpParameters,l=o.streamId,x.debug("receive() [trackId:%s, kind:%s]",u,d),f=p.mid||String(this._mapMidTransceiver.size),a.set(u,f),this._remoteSdp.receive({mid:f,kind:d,offerRtpParameters:p,streamId:l||p.rtcp.cname,trackId:u})}catch(i){s.e(i)}finally{s.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),e.next=9,this._pc.setRemoteDescription(m);case 9:return e.next=11,this._pc.createAnswer();case 11:v=e.sent,g=h.parse(v.sdp),y=n(t);try{for(w=function(){var e=_.value,t=e.trackId,r=e.rtpParameters,n=a.get(t),i=g.media.find((function(e){return String(e.mid)===n}));b.applyCodecParameters({offerRtpParameters:r,answerMediaObject:i}),v={type:"answer",sdp:h.write(g)}},y.s();!(_=y.n()).done;)w()}catch(i){y.e(i)}finally{y.f()}if(this._transportReady){e.next=18;break}return e.next=18,this.setupTransport({localDtlsRole:"client",localSdpObject:g});case 18:return x.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),e.next=21,this._pc.setLocalDescription(v);case 21:S=n(t);try{for(R=function(){var e=k.value.trackId,t=a.get(e),n=C._pc.getTransceivers().find((function(e){return e.mid===t}));if(!n)throw new Error("new RTCRtpTransceiver not found");C._mapMidTransceiver.set(t,n),r.push({localId:t,track:n.receiver.track,rtpReceiver:n.receiver})},S.s();!(k=S.n()).done;)R()}catch(i){S.e(i)}finally{S.f()}return e.abrupt("return",r);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=13;break}if(s=a.value,x.debug("stopReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:this._remoteSdp.closeMediaSection(c.mid);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return u=e.sent,x.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=31,this._pc.setLocalDescription(u);case 31:d=n(t);try{for(d.s();!(p=d.n()).done;)l=p.value,this._mapMidTransceiver.delete(l)}catch(i){d.e(i)}finally{d.f()}case 33:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=14;break}if(s=a.value,x.debug("pauseReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:c.direction="inactive",this._remoteSdp.pauseMediaSection(s);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=26,this._pc.setRemoteDescription(o);case 26:return e.next=28,this._pc.createAnswer();case 28:return u=e.sent,x.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=32,this._pc.setLocalDescription(u);case 32:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=14;break}if(s=a.value,x.debug("resumeReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:c.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(s);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=26,this._pc.setRemoteDescription(o);case 26:return e.next=28,this._pc.createAnswer();case 28:return u=e.sent,x.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=32,this._pc.setLocalDescription(u);case 32:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,a=t.protocol,this.assertRecvDirection(),s=r.streamId,c=r.ordered,o=r.maxPacketLifeTime,u=r.maxRetransmits,d={negotiated:!0,id:s,ordered:c,maxPacketLifeTime:o,maxRetransmits:u,protocol:a},x.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(n,d),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),l={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",l),e.next=12,this._pc.setRemoteDescription(l);case 12:return e.next=14,this._pc.createAnswer();case 14:if(f=e.sent,this._transportReady){e.next=19;break}return m=h.parse(f.sdp),e.next=19,this.setupTransport({localDtlsRole:"client",localSdpObject:m});case 19:return x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=22,this._pc.setLocalDescription(f);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:p});case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=s(i().mark((function e(t){var r,n,a,s=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=h.parse(this._pc.localDescription.sdp)),(a=b.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){s.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new r}}}]),r}(w.HandlerInterface);t.Firefox60=C},4376:function(e,t,r){"use strict";var n=r(9728).default,a=r(6690).default,i=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.HandlerInterface=void 0;var c=function(e){i(r,e);var t=s(r);function r(){return a(this,r),t.call(this)}return n(r)}(r(7318).EnhancedEventEmitter);t.HandlerInterface=c},3997:function(e,t,r){"use strict";var n=r(4704).default,a=r(2122).default,i=r(7061).default,s=r(7156).default,c=r(6690).default,o=r(9728).default,u=r(1655).default,d=r(6389).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactNative=void 0;var h=f(r(7724)),m=r(4115),v=r(6431),g=f(r(3001)),y=f(r(1777)),b=f(r(8978)),_=f(r(9547)),w=r(4376),S=r(9678),k=new m.Logger("ReactNative"),x={OS:1024,MIS:1024},R=function(e){u(r,e);var t=d(r);function r(){var e;return c(this,r),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdTrack=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return o(r,[{key:"name",get:function(){return"ReactNative"}},{key:"close",value:function(){if(k.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=s(i().mark((function e(){var t,r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:r=e.sent;try{t.close()}catch(i){}return n=h.parse(r.sdp),a=b.extractRtpCapabilities({sdpObject:n}),e.abrupt("return",a);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(s){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:x});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,c=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,d=e.additionalSettings,p=e.proprietaryConstraints,l=e.extendedRtpCapabilities;k.debug("run()"),this._direction=r,this._remoteSdp=new S.RemoteSdp({iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:c,planB:!0}),this._sendingRtpParametersByKind={audio:y.getSendingRtpParameters("audio",l),video:y.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:y.getSendingRemoteRtpParameters("audio",l),video:y.getSendingRemoteRtpParameters("video",l)},s.role&&"auto"!==s.role&&(this._forcedLocalDtlsRole="server"===s.role?"client":"server"),this._pc=new RTCPeerConnection(a({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},d),p),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(k.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=s(i().mark((function e(t){var r,n,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,k.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:return e.next=23,this._pc.createAnswer();case 23:return s=e.sent,k.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),e.next=27,this._pc.setLocalDescription(s);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,w,S,x;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,a=t.encodings,s=t.codecOptions,c=t.codec,this.assertSendDirection(),k.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),c&&k.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addStream(this._sendStream),e.next=8,this._pc.createOffer();case 8:if(u=e.sent,d=h.parse(u.sdp),(l=g.clone(this._sendingRtpParametersByKind[r.kind],{})).codecs=y.reduceCodecs(l.codecs),(f=g.clone(this._sendingRemoteRtpParametersByKind[r.kind],{})).codecs=y.reduceCodecs(f.codecs),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:d});case 17:return"video"===r.kind&&a&&a.length>1&&(k.debug("send() | enabling simulcast"),d=h.parse(u.sdp),p=d.media.find((function(e){return"video"===e.type})),_.addLegacySimulcast({offerMediaObject:p,track:r,numStreams:a.length}),u={type:"offer",sdp:h.write(d)}),k.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),e.next=21,this._pc.setLocalDescription(u);case 21:if(d=h.parse(this._pc.localDescription.sdp),p=d.media.find((function(e){return e.type===r.kind})),l.rtcp.cname=b.getCname({offerMediaObject:p}),l.encodings=_.getRtpEncodings({offerMediaObject:p,track:r}),a)for(m=0;m<l.encodings.length;++m)a[m]&&Object.assign(l.encodings[m],a[m]);if(l.encodings.length>1&&("video/vp8"===l.codecs[0].mimeType.toLowerCase()||"video/h264"===l.codecs[0].mimeType.toLowerCase())){v=n(l.encodings);try{for(v.s();!(w=v.n()).done;)w.value.scalabilityMode="L1T3"}catch(i){v.e(i)}finally{v.f()}}return this._remoteSdp.send({offerMediaObject:p,offerRtpParameters:l,answerRtpParameters:f,codecOptions:s}),S={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("send() | calling pc.setRemoteDescription() [answer:%o]",S),e.next=32,this._pc.setRemoteDescription(S);case 32:return x=String(this._nextSendLocalId),this._nextSendLocalId++,this._mapSendLocalIdTrack.set(x,r),e.abrupt("return",{localId:x,rtpParameters:l});case 36:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),k.debug("stopSending() [localId:%s]",t),r=this._mapSendLocalIdTrack.get(t)){e.next=5;break}throw new Error("track not found");case 5:return this._mapSendLocalIdTrack.delete(t),this._sendStream.removeTrack(r),this._pc.addStream(this._sendStream),e.next=10,this._pc.createOffer();case 10:return n=e.sent,k.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.prev=12,e.next=15,this._pc.setLocalDescription(n);case 15:e.next=23;break;case 17:if(e.prev=17,e.t0=e.catch(12),0!==this._sendStream.getTracks().length){e.next=22;break}return k.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.t0.toString()),e.abrupt("return");case 22:throw e.t0;case 23:if("stable"!==this._pc.signalingState){e.next=25;break}return e.abrupt("return");case 25:return a={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=29,this._pc.setRemoteDescription(a);case 29:case"end":return e.stop()}}),e,this,[[12,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=s(i().mark((function e(t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=s(i().mark((function e(t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=s(i().mark((function e(t,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,a=t.maxRetransmits,s=t.label,c=t.protocol,this.assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmitTime:n,maxRetransmits:a,protocol:c},k.debug("sendDataChannel() [options:%o]",u),d=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%x.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=h.parse(p.sdp),f=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:l});case 15:return k.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),m={type:"answer",sdp:this._remoteSdp.getSdp()},k.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=23,this._pc.setRemoteDescription(m);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:d,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,y,_,w,S,x,R,C,P,D=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),a=[],s=new Map,c=n(t);try{for(c.s();!(o=c.n()).done;)u=o.value,d=u.trackId,p=u.kind,l=u.rtpParameters,k.debug("receive() [trackId:%s, kind:%s]",d,p),f=p,m=u.streamId||l.rtcp.cname,k.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),m+="-hack-".concat(g.generateRandomNumber()),s.set(d,m),this._remoteSdp.receive({mid:f,kind:p,offerRtpParameters:l,streamId:m,trackId:d})}catch(i){c.e(i)}finally{c.f()}return v={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",v),e.next=9,this._pc.setRemoteDescription(v);case 9:return e.next=11,this._pc.createAnswer();case 11:y=e.sent,_=h.parse(y.sdp),w=n(t);try{for(x=function(){var e=S.value,t=e.kind,r=e.rtpParameters,n=t,a=_.media.find((function(e){return String(e.mid)===n}));b.applyCodecParameters({offerRtpParameters:r,answerMediaObject:a})},w.s();!(S=w.n()).done;)x()}catch(i){w.e(i)}finally{w.f()}if(y={type:"answer",sdp:h.write(_)},this._transportReady){e.next=19;break}return e.next=19,this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:_});case 19:return k.debug("receive() | calling pc.setLocalDescription() [answer:%o]",y),e.next=22,this._pc.setLocalDescription(y);case 22:R=n(t);try{for(P=function(){var e=C.value,t=e.kind,r=e.trackId,n=e.rtpParameters,i=r,c=t,o=s.get(r),u=D._pc.getRemoteStreams().find((function(e){return e.id===o})).getTrackById(i);if(!u)throw new Error("remote track not found");D._mapRecvLocalIdInfo.set(i,{mid:c,rtpParameters:n}),a.push({localId:i,track:u})},R.s();!(C=R.n()).done;)P()}catch(i){R.e(i)}finally{R.f()}return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t);try{for(r.s();!(a=r.n()).done;)s=a.value,k.debug("stopReceiving() [localId:%s]",s),c=this._mapRecvLocalIdInfo.get(s)||{},o=c.mid,u=c.rtpParameters,this._mapRecvLocalIdInfo.delete(s),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:u})}catch(i){r.e(i)}finally{r.f()}return d={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=7,this._pc.setRemoteDescription(d);case 7:return e.next=9,this._pc.createAnswer();case 9:return p=e.sent,k.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",p),e.next=13,this._pc.setLocalDescription(p);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new v.UnsupportedError("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,a=t.protocol,this.assertRecvDirection(),c=r.streamId,o=r.ordered,u=r.maxPacketLifeTime,d=r.maxRetransmits,p={negotiated:!0,id:c,ordered:o,maxPacketLifeTime:u,maxRetransmitTime:u,maxRetransmits:d,protocol:a},k.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),f={type:"offer",sdp:this._remoteSdp.getSdp()},k.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=12,this._pc.setRemoteDescription(f);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=h.parse(m.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return k.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=s(i().mark((function e(t){var r,n,a,s=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=h.parse(this._pc.localDescription.sdp)),(a=b.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){s.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new r}}}]),r}(w.HandlerInterface);t.ReactNative=R},3685:function(e,t,r){"use strict";var n=r(4704).default,a=r(2122).default,i=r(7061).default,s=r(7156).default,c=r(6690).default,o=r(9728).default,u=r(1655).default,d=r(6389).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ReactNativeUnifiedPlan=void 0;var h=f(r(7724)),m=r(4115),v=f(r(3001)),g=f(r(1777)),y=f(r(8978)),b=f(r(8480)),_=f(r(4032)),w=r(4376),S=r(9678),k=r(8732),x=new m.Logger("ReactNativeUnifiedPlan"),R={OS:1024,MIS:1024},C=function(e){u(r,e);var t=d(r);function r(){var e;return c(this,r),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return o(r,[{key:"name",get:function(){return"ReactNativeUnifiedPlan"}},{key:"close",value:function(){if(x.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=s(i().mark((function e(){var t,r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:r=e.sent;try{t.close()}catch(i){}return n=h.parse(r.sdp),a=y.extractRtpCapabilities({sdpObject:n}),_.addNackSuppportForOpus(a),e.abrupt("return",a);case 15:e.prev=15,e.t0=e.catch(2);try{t.close()}catch(s){}throw e.t0;case 19:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:R});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,c=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,d=e.additionalSettings,p=e.proprietaryConstraints,l=e.extendedRtpCapabilities;x.debug("run()"),this._direction=r,this._remoteSdp=new S.RemoteSdp({iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:c}),this._sendingRtpParametersByKind={audio:g.getSendingRtpParameters("audio",l),video:g.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:g.getSendingRemoteRtpParameters("audio",l),video:g.getSendingRemoteRtpParameters("video",l)},s.role&&"auto"!==s.role&&(this._forcedLocalDtlsRole="server"===s.role?"client":"server"),this._pc=new RTCPeerConnection(a({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},d),p),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(x.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=s(i().mark((function e(t){var r,n,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,x.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:return e.next=23,this._pc.createAnswer();case 23:return s=e.sent,x.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),e.next=27,this._pc.setLocalDescription(s);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,_,w,S,R,C,P,D,T,M;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,a=t.encodings,s=t.codecOptions,c=t.codec,this.assertSendDirection(),x.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),a&&a.length>1&&a.forEach((function(e,t){e.rid="r".concat(t)})),(u=v.clone(this._sendingRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(u.codecs,c),(d=v.clone(this._sendingRemoteRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(d.codecs,c),p=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream],sendEncodings:a}),e.next=12,this._pc.createOffer();case 12:if(f=e.sent,m=h.parse(f.sdp),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:m});case 17:return w=!1,S=(0,k.parse)((a||[{}])[0].scalabilityMode),a&&1===a.length&&S.spatialLayers>1&&"video/vp9"===u.codecs[0].mimeType.toLowerCase()&&(x.debug("send() | enabling legacy simulcast for VP9 SVC"),w=!0,m=h.parse(f.sdp),_=m.media[p.idx],b.addLegacySimulcast({offerMediaObject:_,numStreams:S.spatialLayers}),f={type:"offer",sdp:h.write(m)}),x.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=23,this._pc.setLocalDescription(f);case 23:if(R=l.mid,u.mid=R,m=h.parse(this._pc.localDescription.sdp),_=m.media[p.idx],u.rtcp.cname=y.getCname({offerMediaObject:_}),a?1===a.length?(C=b.getRtpEncodings({offerMediaObject:_}),Object.assign(C[0],a[0]),w&&(C=[C[0]]),u.encodings=C):u.encodings=a:u.encodings=b.getRtpEncodings({offerMediaObject:_}),u.encodings.length>1&&("video/vp8"===u.codecs[0].mimeType.toLowerCase()||"video/h264"===u.codecs[0].mimeType.toLowerCase())){P=n(u.encodings);try{for(P.s();!(D=P.n()).done;)(T=D.value).scalabilityMode?T.scalabilityMode="L1T".concat(S.temporalLayers):T.scalabilityMode="L1T3"}catch(i){P.e(i)}finally{P.f()}}return this._remoteSdp.send({offerMediaObject:_,reuseMid:p.reuseMid,offerRtpParameters:u,answerRtpParameters:d,codecOptions:s,extmapAllowMixed:!0}),M={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("send() | calling pc.setRemoteDescription() [answer:%o]",M),e.next=35,this._pc.setRemoteDescription(M);case 35:return this._mapMidTransceiver.set(R,l),e.abrupt("return",{localId:R,rtpParameters:u,rtpSender:l.sender});case 37:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("stopSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch(i){}return e.next=11,this._pc.createOffer();case 11:return n=e.sent,x.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=15,this._pc.setLocalDescription(n);case 15:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=19,this._pc.setRemoteDescription(a);case 19:this._mapMidTransceiver.delete(t);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("pauseSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return r.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=9,this._pc.createOffer();case 9:return n=e.sent,x.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=13,this._pc.setLocalDescription(n);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=17,this._pc.setRemoteDescription(a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("resumeSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t),this._remoteSdp.resumeSendingMediaSection(t),r){e.next=6;break}throw new Error("associated RTCRtpTransceiver not found");case 6:return r.direction="sendonly",e.next=9,this._pc.createOffer();case 9:return n=e.sent,x.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=13,this._pc.setLocalDescription(n);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=17,this._pc.setRemoteDescription(a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=s(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r?x.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):x.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.next=7,n.sender.replaceTrack(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=s(i().mark((function e(t,r){var n,a,s,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=n.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=9,n.sender.setParameters(a);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=12,this._pc.createOffer();case 12:return s=e.sent,x.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),e.next=16,this._pc.setLocalDescription(s);case 16:return c={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",c),e.next=20,this._pc.setRemoteDescription(c);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=s(i().mark((function e(t,r){var n,s,c,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(s=n.sender.getParameters()).encodings.forEach((function(e,t){s.encodings[t]=a(a({},e),r)})),e.next=9,n.sender.setParameters(s);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings),e.next=12,this._pc.createOffer();case 12:return c=e.sent,x.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",c),e.next=16,this._pc.setLocalDescription(c);case 16:return o={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=20,this._pc.setRemoteDescription(o);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.sender.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,a=t.maxRetransmits,s=t.label,c=t.protocol,this.assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:a,protocol:c},x.debug("sendDataChannel() [options:%o]",u),d=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%R.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=h.parse(p.sdp),f=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:l});case 15:return x.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),m={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=23,this._pc.setRemoteDescription(m);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:d,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,g,b,_,w,S,k,R,C,P=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),a=[],s=new Map,c=n(t);try{for(c.s();!(o=c.n()).done;)u=o.value,d=u.trackId,p=u.kind,l=u.rtpParameters,f=u.streamId,x.debug("receive() [trackId:%s, kind:%s]",d,p),m=l.mid||String(this._mapMidTransceiver.size),s.set(d,m),this._remoteSdp.receive({mid:m,kind:p,offerRtpParameters:l,streamId:f||l.rtcp.cname,trackId:d})}catch(i){c.e(i)}finally{c.f()}return v={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",v),e.next=9,this._pc.setRemoteDescription(v);case 9:return e.next=11,this._pc.createAnswer();case 11:g=e.sent,b=h.parse(g.sdp),_=n(t);try{for(S=function(){var e=w.value,t=e.trackId,r=e.rtpParameters,n=s.get(t),a=b.media.find((function(e){return String(e.mid)===n}));y.applyCodecParameters({offerRtpParameters:r,answerMediaObject:a})},_.s();!(w=_.n()).done;)S()}catch(i){_.e(i)}finally{_.f()}if(g={type:"answer",sdp:h.write(b)},this._transportReady){e.next=19;break}return e.next=19,this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:b});case 19:return x.debug("receive() | calling pc.setLocalDescription() [answer:%o]",g),e.next=22,this._pc.setLocalDescription(g);case 22:k=n(t);try{for(C=function(){var e=R.value.trackId,t=s.get(e),r=P._pc.getTransceivers().find((function(e){return e.mid===t}));if(!r)throw new Error("new RTCRtpTransceiver not found");P._mapMidTransceiver.set(t,r),a.push({localId:t,track:r.receiver.track,rtpReceiver:r.receiver})},k.s();!(R=k.n()).done;)C()}catch(i){k.e(i)}finally{k.f()}return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=13;break}if(s=a.value,x.debug("stopReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:this._remoteSdp.closeMediaSection(c.mid);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return u=e.sent,x.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=31,this._pc.setLocalDescription(u);case 31:d=n(t);try{for(d.s();!(p=d.n()).done;)l=p.value,this._mapMidTransceiver.delete(l)}catch(i){d.e(i)}finally{d.f()}case 33:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=14;break}if(s=a.value,x.debug("pauseReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:c.direction="inactive",this._remoteSdp.pauseMediaSection(s);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=26,this._pc.setRemoteDescription(o);case 26:return e.next=28,this._pc.createAnswer();case 28:return u=e.sent,x.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=32,this._pc.setLocalDescription(u);case 32:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=14;break}if(s=a.value,x.debug("resumeReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:c.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(s);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=26,this._pc.setRemoteDescription(o);case 26:return e.next=28,this._pc.createAnswer();case 28:return u=e.sent,x.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=32,this._pc.setLocalDescription(u);case 32:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,a=t.protocol,this.assertRecvDirection(),c=r.streamId,o=r.ordered,u=r.maxPacketLifeTime,d=r.maxRetransmits,p={negotiated:!0,id:c,ordered:o,maxPacketLifeTime:u,maxRetransmits:d,protocol:a},x.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),f={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=12,this._pc.setRemoteDescription(f);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=h.parse(m.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=s(i().mark((function e(t){var r,n,a,s=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=h.parse(this._pc.localDescription.sdp)),(a=y.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){s.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new r}}}]),r}(w.HandlerInterface);t.ReactNativeUnifiedPlan=C},9942:function(e,t,r){"use strict";var n=r(4704).default,a=r(2122).default,i=r(7061).default,s=r(7156).default,c=r(6690).default,o=r(9728).default,u=r(1655).default,d=r(6389).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Safari11=void 0;var h=f(r(7724)),m=r(4115),v=f(r(3001)),g=f(r(1777)),y=f(r(8978)),b=f(r(9547)),_=r(4376),w=r(9678),S=new m.Logger("Safari11"),k={OS:1024,MIS:1024},x=function(e){u(r,e);var t=d(r);function r(){var e;return c(this,r),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdRtpSender=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return o(r,[{key:"name",get:function(){return"Safari11"}},{key:"close",value:function(){if(S.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=s(i().mark((function e(){var t,r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:r=e.sent;try{t.close()}catch(i){}return n=h.parse(r.sdp),a=y.extractRtpCapabilities({sdpObject:n}),e.abrupt("return",a);case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(s){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:k});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,c=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,d=e.additionalSettings,p=e.proprietaryConstraints,l=e.extendedRtpCapabilities;S.debug("run()"),this._direction=r,this._remoteSdp=new w.RemoteSdp({iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:c,planB:!0}),this._sendingRtpParametersByKind={audio:g.getSendingRtpParameters("audio",l),video:g.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:g.getSendingRemoteRtpParameters("audio",l),video:g.getSendingRemoteRtpParameters("video",l)},s.role&&"auto"!==s.role&&(this._forcedLocalDtlsRole="server"===s.role?"client":"server"),this._pc=new RTCPeerConnection(a({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},d),p),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(S.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=s(i().mark((function e(t){var r,n,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,S.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},S.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},S.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:return e.next=23,this._pc.createAnswer();case 23:return s=e.sent,S.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),e.next=27,this._pc.setLocalDescription(s);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,_,w,k,x,R;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,a=t.encodings,s=t.codecOptions,c=t.codec,this.assertSendDirection(),S.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),c&&S.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(r),this._pc.addTrack(r,this._sendStream),e.next=8,this._pc.createOffer();case 8:if(u=e.sent,d=h.parse(u.sdp),(l=v.clone(this._sendingRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(l.codecs),(f=v.clone(this._sendingRemoteRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(f.codecs),this._transportReady){e.next=17;break}return e.next=17,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:d});case 17:return"video"===r.kind&&a&&a.length>1&&(S.debug("send() | enabling simulcast"),d=h.parse(u.sdp),p=d.media.find((function(e){return"video"===e.type})),b.addLegacySimulcast({offerMediaObject:p,track:r,numStreams:a.length}),u={type:"offer",sdp:h.write(d)}),S.debug("send() | calling pc.setLocalDescription() [offer:%o]",u),e.next=21,this._pc.setLocalDescription(u);case 21:if(d=h.parse(this._pc.localDescription.sdp),p=d.media.find((function(e){return e.type===r.kind})),l.rtcp.cname=y.getCname({offerMediaObject:p}),l.encodings=b.getRtpEncodings({offerMediaObject:p,track:r}),a)for(m=0;m<l.encodings.length;++m)a[m]&&Object.assign(l.encodings[m],a[m]);if(l.encodings.length>1&&"video/vp8"===l.codecs[0].mimeType.toLowerCase()){_=n(l.encodings);try{for(_.s();!(w=_.n()).done;)w.value.scalabilityMode="L1T3"}catch(i){_.e(i)}finally{_.f()}}return this._remoteSdp.send({offerMediaObject:p,offerRtpParameters:l,answerRtpParameters:f,codecOptions:s}),k={type:"answer",sdp:this._remoteSdp.getSdp()},S.debug("send() | calling pc.setRemoteDescription() [answer:%o]",k),e.next=32,this._pc.setRemoteDescription(k);case 32:return x=String(this._nextSendLocalId),this._nextSendLocalId++,R=this._pc.getSenders().find((function(e){return e.track===r})),this._mapSendLocalIdRtpSender.set(x,R),e.abrupt("return",{localId:x,rtpParameters:l,rtpSender:R});case 37:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return r.track&&this._sendStream.removeTrack(r.track),this._mapSendLocalIdRtpSender.delete(t),e.next=8,this._pc.createOffer();case 8:return n=e.sent,S.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.prev=10,e.next=13,this._pc.setLocalDescription(n);case 13:e.next=21;break;case 15:if(e.prev=15,e.t0=e.catch(10),0!==this._sendStream.getTracks().length){e.next=20;break}return S.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.t0.toString()),e.abrupt("return");case 20:throw e.t0;case 21:if("stable"!==this._pc.signalingState){e.next=23;break}return e.abrupt("return");case 23:return a={type:"answer",sdp:this._remoteSdp.getSdp()},S.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=27,this._pc.setRemoteDescription(a);case 27:case"end":return e.stop()}}),e,this,[[10,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=s(i().mark((function e(t,r){var n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r?S.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):S.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return a=n.track,e.next=8,n.replaceTrack(r);case 8:a&&this._sendStream.removeTrack(a),r&&this._sendStream.addTrack(r);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=s(i().mark((function e(t,r){var n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),S.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(a=n.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=9,n.setParameters(a);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=s(i().mark((function e(t,r){var n,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),S.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapSendLocalIdRtpSender.get(t)){e.next=5;break}throw new Error("associated RTCRtpSender not found");case 5:return(s=n.getParameters()).encodings.forEach((function(e,t){s.encodings[t]=a(a({},e),r)})),e.next=9,n.setParameters(s);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return e.abrupt("return",r.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,a=t.maxRetransmits,s=t.label,c=t.protocol,this.assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:a,protocol:c},S.debug("sendDataChannel() [options:%o]",u),d=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%k.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=h.parse(p.sdp),f=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:l});case 15:return S.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),m={type:"answer",sdp:this._remoteSdp.getSdp()},S.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=23,this._pc.setRemoteDescription(m);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:d,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,g,b,_,w,k,x,R,C=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),a=[],s=n(t);try{for(s.s();!(c=s.n()).done;)o=c.value,u=o.trackId,d=o.kind,p=o.rtpParameters,l=o.streamId,S.debug("receive() [trackId:%s, kind:%s]",u,d),f=d,this._remoteSdp.receive({mid:f,kind:d,offerRtpParameters:p,streamId:l||p.rtcp.cname,trackId:u})}catch(i){s.e(i)}finally{s.f()}return m={type:"offer",sdp:this._remoteSdp.getSdp()},S.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",m),e.next=8,this._pc.setRemoteDescription(m);case 8:return e.next=10,this._pc.createAnswer();case 10:v=e.sent,g=h.parse(v.sdp),b=n(t);try{for(w=function(){var e=_.value,t=e.kind,r=e.rtpParameters,n=t,a=g.media.find((function(e){return String(e.mid)===n}));y.applyCodecParameters({offerRtpParameters:r,answerMediaObject:a})},b.s();!(_=b.n()).done;)w()}catch(i){b.e(i)}finally{b.f()}if(v={type:"answer",sdp:h.write(g)},this._transportReady){e.next=18;break}return e.next=18,this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:g});case 18:return S.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),e.next=21,this._pc.setLocalDescription(v);case 21:k=n(t);try{for(R=function(){var e=x.value,t=e.kind,r=e.trackId,n=e.rtpParameters,i=t,s=r,c=C._pc.getReceivers().find((function(e){return e.track&&e.track.id===s}));if(!c)throw new Error("new RTCRtpReceiver not");C._mapRecvLocalIdInfo.set(s,{mid:i,rtpParameters:n,rtpReceiver:c}),a.push({localId:s,track:c.track,rtpReceiver:c})},k.s();!(x=k.n()).done;)R()}catch(i){k.e(i)}finally{k.f()}return e.abrupt("return",a);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t);try{for(r.s();!(a=r.n()).done;)s=a.value,S.debug("stopReceiving() [localId:%s]",s),c=this._mapRecvLocalIdInfo.get(s)||{},o=c.mid,u=c.rtpParameters,this._mapRecvLocalIdInfo.delete(s),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:u})}catch(i){r.e(i)}finally{r.f()}return d={type:"offer",sdp:this._remoteSdp.getSdp()},S.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",d),e.next=7,this._pc.setRemoteDescription(d);case 7:return e.next=9,this._pc.createAnswer();case 9:return p=e.sent,S.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",p),e.next=13,this._pc.setLocalDescription(p);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=s(i().mark((function e(t){var r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapRecvLocalIdInfo.get(t)||{},n=r.rtpReceiver){e.next=4;break}throw new Error("associated RTCRtpReceiver not found");case 4:return e.abrupt("return",n.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,a=t.protocol,this.assertRecvDirection(),c=r.streamId,o=r.ordered,u=r.maxPacketLifeTime,d=r.maxRetransmits,p={negotiated:!0,id:c,ordered:o,maxPacketLifeTime:u,maxRetransmits:d,protocol:a},S.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),f={type:"offer",sdp:this._remoteSdp.getSdp()},S.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=12,this._pc.setRemoteDescription(f);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=h.parse(m.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return S.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=s(i().mark((function e(t){var r,n,a,s=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=h.parse(this._pc.localDescription.sdp)),(a=y.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){s.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new r}}}]),r}(_.HandlerInterface);t.Safari11=x},3767:function(e,t,r){"use strict";var n=r(4704).default,a=r(2122).default,i=r(7061).default,s=r(7156).default,c=r(6690).default,o=r(9728).default,u=r(1655).default,d=r(6389).default,p=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&p(t,e,r);return l(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Safari12=void 0;var h=f(r(7724)),m=r(4115),v=f(r(3001)),g=f(r(1777)),y=f(r(8978)),b=f(r(8480)),_=f(r(4032)),w=r(4376),S=r(9678),k=r(8732),x=new m.Logger("Safari12"),R={OS:1024,MIS:1024},C=function(e){u(r,e);var t=d(r);function r(){var e;return c(this,r),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return o(r,[{key:"name",get:function(){return"Safari12"}},{key:"close",value:function(){if(x.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=s(i().mark((function e(){var t,r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=7,t.createOffer();case 7:r=e.sent;try{t.close()}catch(i){}return n=h.parse(r.sdp),a=y.extractRtpCapabilities({sdpObject:n}),_.addNackSuppportForOpus(a),e.abrupt("return",a);case 15:e.prev=15,e.t0=e.catch(2);try{t.close()}catch(s){}throw e.t0;case 19:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.debug("getNativeSctpCapabilities()"),e.abrupt("return",{numStreams:R});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,r=e.direction,n=e.iceParameters,i=e.iceCandidates,s=e.dtlsParameters,c=e.sctpParameters,o=e.iceServers,u=e.iceTransportPolicy,d=e.additionalSettings,p=e.proprietaryConstraints,l=e.extendedRtpCapabilities;x.debug("run()"),this._direction=r,this._remoteSdp=new S.RemoteSdp({iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:c}),this._sendingRtpParametersByKind={audio:g.getSendingRtpParameters("audio",l),video:g.getSendingRtpParameters("video",l)},this._sendingRemoteRtpParametersByKind={audio:g.getSendingRemoteRtpParameters("audio",l),video:g.getSendingRemoteRtpParameters("video",l)},s.role&&"auto"!==s.role&&(this._forcedLocalDtlsRole="server"===s.role?"client":"server"),this._pc=new RTCPeerConnection(a({iceServers:o||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},d),p),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(x.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x.debug("updateIceServers()"),(r=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(r);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=s(i().mark((function e(t){var r,n,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),this._transportReady){e.next=4;break}return e.abrupt("return");case 4:if("send"!==this._direction){e.next=17;break}return e.next=7,this._pc.createOffer({iceRestart:!0});case 7:return r=e.sent,x.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return n={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=15,this._pc.setRemoteDescription(n);case 15:e.next=27;break;case 17:return a={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=21,this._pc.setRemoteDescription(a);case 21:return e.next=23,this._pc.createAnswer();case 23:return s=e.sent,x.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",s),e.next=27,this._pc.setLocalDescription(s);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=s(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,_,w,S,R,C,P,D,T;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.track,a=t.encodings,s=t.codecOptions,c=t.codec,this.assertSendDirection(),x.debug("send() [kind:%s, track.id:%s]",r.kind,r.id),(u=v.clone(this._sendingRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(u.codecs,c),(d=v.clone(this._sendingRemoteRtpParametersByKind[r.kind],{})).codecs=g.reduceCodecs(d.codecs,c),p=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(r,{direction:"sendonly",streams:[this._sendStream]}),e.next=11,this._pc.createOffer();case 11:if(f=e.sent,m=h.parse(f.sdp),this._transportReady){e.next=16;break}return e.next=16,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:m});case 16:return w=(0,k.parse)((a||[{}])[0].scalabilityMode),a&&a.length>1&&(x.debug("send() | enabling legacy simulcast"),m=h.parse(f.sdp),_=m.media[p.idx],b.addLegacySimulcast({offerMediaObject:_,numStreams:a.length}),f={type:"offer",sdp:h.write(m)}),x.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=21,this._pc.setLocalDescription(f);case 21:if(S=l.mid,u.mid=S,m=h.parse(this._pc.localDescription.sdp),_=m.media[p.idx],u.rtcp.cname=y.getCname({offerMediaObject:_}),u.encodings=b.getRtpEncodings({offerMediaObject:_}),a)for(R=0;R<u.encodings.length;++R)a[R]&&Object.assign(u.encodings[R],a[R]);if(u.encodings.length>1&&("video/vp8"===u.codecs[0].mimeType.toLowerCase()||"video/h264"===u.codecs[0].mimeType.toLowerCase())){C=n(u.encodings);try{for(C.s();!(P=C.n()).done;)(D=P.value).scalabilityMode?D.scalabilityMode="L1T".concat(w.temporalLayers):D.scalabilityMode="L1T3"}catch(i){C.e(i)}finally{C.f()}}return this._remoteSdp.send({offerMediaObject:_,reuseMid:p.reuseMid,offerRtpParameters:u,answerRtpParameters:d,codecOptions:s}),T={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("send() | calling pc.setRemoteDescription() [answer:%o]",T),e.next=34,this._pc.setRemoteDescription(T);case 34:return this._mapMidTransceiver.set(S,l),e.abrupt("return",{localId:S,rtpParameters:u,rtpSender:l.sender});case 36:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("stopSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch(i){}return e.next=11,this._pc.createOffer();case 11:return n=e.sent,x.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=15,this._pc.setLocalDescription(n);case 15:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=19,this._pc.setRemoteDescription(a);case 19:this._mapMidTransceiver.delete(t);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("pauseSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return r.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=9,this._pc.createOffer();case 9:return n=e.sent,x.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=13,this._pc.setLocalDescription(n);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=17,this._pc.setRemoteDescription(a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=s(i().mark((function e(t){var r,n,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("resumeSending() [localId:%s]",t),r=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return r.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(t),e.next=9,this._pc.createOffer();case 9:return n=e.sent,x.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),e.next=13,this._pc.setLocalDescription(n);case 13:return a={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=17,this._pc.setRemoteDescription(a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=s(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r?x.debug("replaceTrack() [localId:%s, track.id:%s]",t,r.id):x.debug("replaceTrack() [localId:%s, no track]",t),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return e.next=7,n.sender.replaceTrack(r);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=s(i().mark((function e(t,r){var n,a,s,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(a=n.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=r})),e.next=9,n.sender.setParameters(a);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=12,this._pc.createOffer();case 12:return s=e.sent,x.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),e.next=16,this._pc.setLocalDescription(s);case 16:return c={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",c),e.next=20,this._pc.setRemoteDescription(c);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=s(i().mark((function e(t,r){var n,s,c,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),x.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,r),n=this._mapMidTransceiver.get(t)){e.next=5;break}throw new Error("associated RTCRtpTransceiver not found");case 5:return(s=n.sender.getParameters()).encodings.forEach((function(e,t){s.encodings[t]=a(a({},e),r)})),e.next=9,n.sender.setParameters(s);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,s.encodings),e.next=12,this._pc.createOffer();case 12:return c=e.sent,x.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",c),e.next=16,this._pc.setLocalDescription(c);case 16:return o={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=20,this._pc.setRemoteDescription(o);case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.sender.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ordered,n=t.maxPacketLifeTime,a=t.maxRetransmits,s=t.label,c=t.protocol,this.assertSendDirection(),u={negotiated:!0,id:this._nextSendSctpStreamId,ordered:r,maxPacketLifeTime:n,maxRetransmits:a,protocol:c},x.debug("sendDataChannel() [options:%o]",u),d=this._pc.createDataChannel(s,u),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%R.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=9,this._pc.createOffer();case 9:if(p=e.sent,l=h.parse(p.sdp),f=l.media.find((function(e){return"application"===e.type})),this._transportReady){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:l});case 15:return x.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",p),e.next=18,this._pc.setLocalDescription(p);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),m={type:"answer",sdp:this._remoteSdp.getSdp()},x.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=23,this._pc.setRemoteDescription(m);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:u.id,ordered:u.ordered,maxPacketLifeTime:u.maxPacketLifeTime,maxRetransmits:u.maxRetransmits},e.abrupt("return",{dataChannel:d,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l,f,m,v,g,b,_,w,S,k,R,C,P=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),a=[],s=new Map,c=n(t);try{for(c.s();!(o=c.n()).done;)u=o.value,d=u.trackId,p=u.kind,l=u.rtpParameters,f=u.streamId,x.debug("receive() [trackId:%s, kind:%s]",d,p),m=l.mid||String(this._mapMidTransceiver.size),s.set(d,m),this._remoteSdp.receive({mid:m,kind:p,offerRtpParameters:l,streamId:f||l.rtcp.cname,trackId:d})}catch(i){c.e(i)}finally{c.f()}return v={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",v),e.next=9,this._pc.setRemoteDescription(v);case 9:return e.next=11,this._pc.createAnswer();case 11:g=e.sent,b=h.parse(g.sdp),_=n(t);try{for(S=function(){var e=w.value,t=e.trackId,r=e.rtpParameters,n=s.get(t),a=b.media.find((function(e){return String(e.mid)===n}));y.applyCodecParameters({offerRtpParameters:r,answerMediaObject:a})},_.s();!(w=_.n()).done;)S()}catch(i){_.e(i)}finally{_.f()}if(g={type:"answer",sdp:h.write(b)},this._transportReady){e.next=19;break}return e.next=19,this.setupTransport({localDtlsRole:null!==(r=this._forcedLocalDtlsRole)&&void 0!==r?r:"client",localSdpObject:b});case 19:return x.debug("receive() | calling pc.setLocalDescription() [answer:%o]",g),e.next=22,this._pc.setLocalDescription(g);case 22:k=n(t);try{for(C=function(){var e=R.value.trackId,t=s.get(e),r=P._pc.getTransceivers().find((function(e){return e.mid===t}));if(!r)throw new Error("new RTCRtpTransceiver not found");P._mapMidTransceiver.set(t,r),a.push({localId:t,track:r.receiver.track,rtpReceiver:r.receiver})},k.s();!(R=k.n()).done;)C()}catch(i){k.e(i)}finally{k.f()}return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u,d,p,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=13;break}if(s=a.value,x.debug("stopReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:this._remoteSdp.closeMediaSection(c.mid);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return u=e.sent,x.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=31,this._pc.setLocalDescription(u);case 31:d=n(t);try{for(d.s();!(p=d.n()).done;)l=p.value,this._mapMidTransceiver.delete(l)}catch(i){d.e(i)}finally{d.f()}case 33:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=14;break}if(s=a.value,x.debug("pauseReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:c.direction="inactive",this._remoteSdp.pauseMediaSection(s);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=26,this._pc.setRemoteDescription(o);case 26:return e.next=28,this._pc.createAnswer();case 28:return u=e.sent,x.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=32,this._pc.setLocalDescription(u);case 32:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=s(i().mark((function e(t){var r,a,s,c,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=n(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=14;break}if(s=a.value,x.debug("resumeReceiving() [localId:%s]",s),c=this._mapMidTransceiver.get(s)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:c.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(s);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(2),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return o={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=26,this._pc.setRemoteDescription(o);case 26:return e.next=28,this._pc.createAnswer();case 28:return u=e.sent,x.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",u),e.next=32,this._pc.setLocalDescription(u);case 32:case"end":return e.stop()}}),e,this,[[2,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=s(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",r.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=s(i().mark((function e(t){var r,n,a,s,c,o,u,d,p,l,f,m,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.sctpStreamParameters,n=t.label,a=t.protocol,this.assertRecvDirection(),c=r.streamId,o=r.ordered,u=r.maxPacketLifeTime,d=r.maxRetransmits,p={negotiated:!0,id:c,ordered:o,maxPacketLifeTime:u,maxRetransmits:d,protocol:a},x.debug("receiveDataChannel() [options:%o]",p),l=this._pc.createDataChannel(n,p),this._hasDataChannelMediaSection){e.next=23;break}return this._remoteSdp.receiveSctpAssociation(),f={type:"offer",sdp:this._remoteSdp.getSdp()},x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=12,this._pc.setRemoteDescription(f);case 12:return e.next=14,this._pc.createAnswer();case 14:if(m=e.sent,this._transportReady){e.next=19;break}return v=h.parse(m.sdp),e.next=19,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:v});case 19:return x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",m),e.next=22,this._pc.setLocalDescription(m);case 22:this._hasDataChannelMediaSection=!0;case 23:return e.abrupt("return",{dataChannel:l});case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=s(i().mark((function e(t){var r,n,a,s=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.localDtlsRole,(n=t.localSdpObject)||(n=h.parse(this._pc.localDescription.sdp)),(a=y.extractDtlsParameters({sdpObject:n})).role=r,this._remoteSdp.updateDtlsRole("client"===r?"server":"client"),e.next=7,new Promise((function(e,t){s.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new r}}}]),r}(w.HandlerInterface);t.Safari12=C},9132:function(e,t,r){"use strict";var n=r(4704).default,a=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.mangleRtpParameters=t.getCapabilities=void 0;var c=s(r(3001));t.getCapabilities=function(){var e,t=RTCRtpReceiver.getCapabilities(),r=c.clone(t,{}),a=n(r.codecs);try{for(a.s();!(e=a.n()).done;){var i=e.value;if(i.channels=i.numChannels,delete i.numChannels,i.mimeType=i.mimeType||"".concat(i.kind,"/").concat(i.name),i.parameters){var s=i.parameters;s.apt&&(s.apt=Number(s.apt)),s["packetization-mode"]&&(s["packetization-mode"]=Number(s["packetization-mode"]))}var o,u=n(i.rtcpFeedback||[]);try{for(u.s();!(o=u.n()).done;){var d=o.value;d.parameter||(d.parameter="")}}catch(p){u.e(p)}finally{u.f()}}}catch(p){a.e(p)}finally{a.f()}return r},t.mangleRtpParameters=function(e){var t=c.clone(e,{});t.mid&&(t.muxId=t.mid,delete t.mid);var r,a=n(t.codecs);try{for(a.s();!(r=a.n()).done;){var i=r.value;i.channels&&(i.numChannels=i.channels,delete i.channels),i.mimeType&&!i.name&&(i.name=i.mimeType.split("/")[1]),delete i.mimeType}}catch(s){a.e(s)}finally{a.f()}return t}},4032:function(e,t,r){"use strict";var n=r(4704).default;Object.defineProperty(t,"__esModule",{value:!0}),t.addNackSuppportForOpus=void 0,t.addNackSuppportForOpus=function(e){var t,r,a=n(e.codecs||[]);try{for(a.s();!(r=a.n()).done;){var i=r.value;"audio/opus"!==i.mimeType.toLowerCase()&&"audio/multiopus"!==i.mimeType.toLowerCase()||(null===(t=i.rtcpFeedback)||void 0===t?void 0:t.some((function(e){return"nack"===e.type&&!e.parameter})))||(i.rtcpFeedback||(i.rtcpFeedback=[]),i.rtcpFeedback.push({type:"nack"}))}}catch(s){a.e(s)}finally{a.f()}}},4112:function(e,t,r){"use strict";var n=r(1655).default,a=r(6389).default,i=r(4704).default,s=r(6690).default,c=r(9728).default,o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),u=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),d=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return u(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.OfferMediaSection=t.AnswerMediaSection=t.MediaSection=void 0;var p=d(r(7724)),l=d(r(3001)),f=function(){function e(t){var r=t.iceParameters,n=t.iceCandidates,a=t.dtlsParameters,c=t.planB,o=void 0!==c&&c;if(s(this,e),this._mediaObject={},this._planB=o,r&&this.setIceParameters(r),n){this._mediaObject.candidates=[];var u,d=i(n);try{for(d.s();!(u=d.n()).done;){var p=u.value,l={component:1};l.foundation=p.foundation,l.ip=p.ip,l.port=p.port,l.priority=p.priority,l.transport=p.protocol,l.type=p.type,p.tcpType&&(l.tcptype=p.tcpType),this._mediaObject.candidates.push(l)}}catch(f){d.e(f)}finally{d.f()}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}a&&this.setDtlsRole(a.role)}return c(e,[{key:"mid",get:function(){return String(this._mediaObject.mid)}},{key:"closed",get:function(){return 0===this._mediaObject.port}},{key:"getObject",value:function(){return this._mediaObject}},{key:"setIceParameters",value:function(e){this._mediaObject.iceUfrag=e.usernameFragment,this._mediaObject.icePwd=e.password}},{key:"pause",value:function(){this._mediaObject.direction="inactive"}},{key:"disable",value:function(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}},{key:"close",value:function(){this.disable(),this._mediaObject.port=0}}]),e}();t.MediaSection=f;var h=function(e){n(r,e);var t=a(r);function r(e){var n,a=e.iceParameters,c=e.iceCandidates,o=e.dtlsParameters,u=e.sctpParameters,d=e.plainRtpParameters,p=e.planB,f=void 0!==p&&p,h=e.offerMediaObject,m=e.offerRtpParameters,g=e.answerRtpParameters,y=e.codecOptions,b=e.extmapAllowMixed,_=void 0!==b&&b;switch(s(this,r),(n=t.call(this,{iceParameters:a,iceCandidates:c,dtlsParameters:o,planB:f}))._mediaObject.mid=String(h.mid),n._mediaObject.type=h.type,n._mediaObject.protocol=h.protocol,d?(n._mediaObject.connection={ip:d.ip,version:d.ipVersion},n._mediaObject.port=d.port):(n._mediaObject.connection={ip:"127.0.0.1",version:4},n._mediaObject.port=7),h.type){case"audio":case"video":n._mediaObject.direction="recvonly",n._mediaObject.rtp=[],n._mediaObject.rtcpFb=[],n._mediaObject.fmtp=[];var w,S=i(g.codecs);try{var k=function(){var e=w.value,t={payload:e.payloadType,codec:v(e),rate:e.clockRate};e.channels>1&&(t.encoding=e.channels),n._mediaObject.rtp.push(t);var r=l.clone(e.parameters,{}),a=l.clone(e.rtcpFeedback,[]);if(y){var s=y.opusStereo,c=y.opusFec,o=y.opusDtx,u=y.opusMaxPlaybackRate,d=y.opusMaxAverageBitrate,p=y.opusPtime,f=y.opusNack,h=y.videoGoogleStartBitrate,g=y.videoGoogleMaxBitrate,b=y.videoGoogleMinBitrate,_=m.codecs.find((function(t){return t.payloadType===e.payloadType}));switch(e.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":void 0!==s&&(_.parameters["sprop-stereo"]=s?1:0,r.stereo=s?1:0),void 0!==c&&(_.parameters.useinbandfec=c?1:0,r.useinbandfec=c?1:0),void 0!==o&&(_.parameters.usedtx=o?1:0,r.usedtx=o?1:0),void 0!==u&&(r.maxplaybackrate=u),void 0!==d&&(r.maxaveragebitrate=d),void 0!==p&&(_.parameters.ptime=p,r.ptime=p),f||(_.rtcpFeedback=_.rtcpFeedback.filter((function(e){return"nack"!==e.type||e.parameter})),a=a.filter((function(e){return"nack"!==e.type||e.parameter})));break;case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":void 0!==h&&(r["x-google-start-bitrate"]=h),void 0!==g&&(r["x-google-max-bitrate"]=g),void 0!==b&&(r["x-google-min-bitrate"]=b)}}for(var S={payload:e.payloadType,config:""},k=0,x=Object.keys(r);k<x.length;k++){var R=x[k];S.config&&(S.config+=";"),S.config+="".concat(R,"=").concat(r[R])}S.config&&n._mediaObject.fmtp.push(S);var C,P=i(a);try{for(P.s();!(C=P.n()).done;){var D=C.value;n._mediaObject.rtcpFb.push({payload:e.payloadType,type:D.type,subtype:D.parameter})}}catch(T){P.e(T)}finally{P.f()}};for(S.s();!(w=S.n()).done;)k()}catch(L){S.e(L)}finally{S.f()}n._mediaObject.payloads=g.codecs.map((function(e){return e.payloadType})).join(" "),n._mediaObject.ext=[];var x,R=i(g.headerExtensions);try{var C=function(){var e=x.value;if(!(h.ext||[]).some((function(t){return t.uri===e.uri})))return"continue";n._mediaObject.ext.push({uri:e.uri,value:e.id})};for(R.s();!(x=R.n()).done;)C()}catch(L){R.e(L)}finally{R.f()}if(_&&"extmap-allow-mixed"===h.extmapAllowMixed&&(n._mediaObject.extmapAllowMixed="extmap-allow-mixed"),h.simulcast){n._mediaObject.simulcast={dir1:"recv",list1:h.simulcast.list1},n._mediaObject.rids=[];var P,D=i(h.rids||[]);try{for(D.s();!(P=D.n()).done;){var T=P.value;"send"===T.direction&&n._mediaObject.rids.push({id:T.id,direction:"recv"})}}catch(L){D.e(L)}finally{D.f()}}else if(h.simulcast_03){n._mediaObject.simulcast_03={value:h.simulcast_03.value.replace(/send/g,"recv")},n._mediaObject.rids=[];var M,O=i(h.rids||[]);try{for(O.s();!(M=O.n()).done;){var E=M.value;"send"===E.direction&&n._mediaObject.rids.push({id:E.id,direction:"recv"})}}catch(L){O.e(L)}finally{O.f()}}n._mediaObject.rtcpMux="rtcp-mux",n._mediaObject.rtcpRsize="rtcp-rsize",n._planB&&"video"===n._mediaObject.type&&(n._mediaObject.xGoogleFlag="conference");break;case"application":"number"===typeof h.sctpPort?(n._mediaObject.payloads="webrtc-datachannel",n._mediaObject.sctpPort=u.port,n._mediaObject.maxMessageSize=u.maxMessageSize):h.sctpmap&&(n._mediaObject.payloads=u.port,n._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:u.port,maxMessageSize:u.maxMessageSize})}return n}return c(r,[{key:"setDtlsRole",value:function(e){switch(e){case"client":this._mediaObject.setup="active";break;case"server":this._mediaObject.setup="passive";break;case"auto":this._mediaObject.setup="actpass"}}},{key:"resume",value:function(){this._mediaObject.direction="recvonly"}},{key:"muxSimulcastStreams",value:function(e){var t;if(this._mediaObject.simulcast&&this._mediaObject.simulcast.list1){var r,n={},a=i(e);try{for(a.s();!(r=a.n()).done;){var s=r.value;s.rid&&(n[s.rid]=s)}}catch(v){a.e(v)}finally{a.f()}var c,o=this._mediaObject.simulcast.list1,u=p.parseSimulcastStreamList(o),d=i(u);try{for(d.s();!(c=d.n()).done;){var l,f=c.value,h=i(f);try{for(h.s();!(l=h.n()).done;){var m=l.value;m.paused=!(null===(t=n[m.scid])||void 0===t?void 0:t.active)}}catch(v){h.e(v)}finally{h.f()}}}catch(v){d.e(v)}finally{d.f()}this._mediaObject.simulcast.list1=u.map((function(e){return e.map((function(e){return"".concat(e.paused?"~":"").concat(e.scid)})).join(",")})).join(";")}}}]),r}(f);t.AnswerMediaSection=h;var m=function(e){n(r,e);var t=a(r);function r(e){var n,a=e.iceParameters,c=e.iceCandidates,o=e.dtlsParameters,u=e.sctpParameters,d=e.plainRtpParameters,p=e.planB,l=void 0!==p&&p,f=e.mid,h=e.kind,m=e.offerRtpParameters,g=e.streamId,y=e.trackId,b=e.oldDataChannelSpec,_=void 0!==b&&b;switch(s(this,r),(n=t.call(this,{iceParameters:a,iceCandidates:c,dtlsParameters:o,planB:l}))._mediaObject.mid=String(f),n._mediaObject.type=h,d?(n._mediaObject.connection={ip:d.ip,version:d.ipVersion},n._mediaObject.protocol="RTP/AVP",n._mediaObject.port=d.port):(n._mediaObject.connection={ip:"127.0.0.1",version:4},n._mediaObject.protocol=u?"UDP/DTLS/SCTP":"UDP/TLS/RTP/SAVPF",n._mediaObject.port=7),h){case"audio":case"video":n._mediaObject.direction="sendonly",n._mediaObject.rtp=[],n._mediaObject.rtcpFb=[],n._mediaObject.fmtp=[],n._planB||(n._mediaObject.msid="".concat(g||"-"," ").concat(y));var w,S=i(m.codecs);try{for(S.s();!(w=S.n()).done;){var k=w.value,x={payload:k.payloadType,codec:v(k),rate:k.clockRate};k.channels>1&&(x.encoding=k.channels),n._mediaObject.rtp.push(x);for(var R={payload:k.payloadType,config:""},C=0,P=Object.keys(k.parameters);C<P.length;C++){var D=P[C];R.config&&(R.config+=";"),R.config+="".concat(D,"=").concat(k.parameters[D])}R.config&&n._mediaObject.fmtp.push(R);var T,M=i(k.rtcpFeedback);try{for(M.s();!(T=M.n()).done;){var O=T.value;n._mediaObject.rtcpFb.push({payload:k.payloadType,type:O.type,subtype:O.parameter})}}catch(B){M.e(B)}finally{M.f()}}}catch(B){S.e(B)}finally{S.f()}n._mediaObject.payloads=m.codecs.map((function(e){return e.payloadType})).join(" "),n._mediaObject.ext=[];var E,L=i(m.headerExtensions);try{for(L.s();!(E=L.n()).done;){var I=E.value;n._mediaObject.ext.push({uri:I.uri,value:I.id})}}catch(B){L.e(B)}finally{L.f()}n._mediaObject.rtcpMux="rtcp-mux",n._mediaObject.rtcpRsize="rtcp-rsize";var j=m.encodings[0],F=j.ssrc,A=j.rtx&&j.rtx.ssrc?j.rtx.ssrc:void 0;n._mediaObject.ssrcs=[],n._mediaObject.ssrcGroups=[],m.rtcp.cname&&n._mediaObject.ssrcs.push({id:F,attribute:"cname",value:m.rtcp.cname}),n._planB&&n._mediaObject.ssrcs.push({id:F,attribute:"msid",value:"".concat(g||"-"," ").concat(y)}),A&&(m.rtcp.cname&&n._mediaObject.ssrcs.push({id:A,attribute:"cname",value:m.rtcp.cname}),n._planB&&n._mediaObject.ssrcs.push({id:A,attribute:"msid",value:"".concat(g||"-"," ").concat(y)}),n._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(F," ").concat(A)}));break;case"application":_?(n._mediaObject.payloads=u.port,n._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:u.port,maxMessageSize:u.maxMessageSize}):(n._mediaObject.payloads="webrtc-datachannel",n._mediaObject.sctpPort=u.port,n._mediaObject.maxMessageSize=u.maxMessageSize)}return n}return c(r,[{key:"setDtlsRole",value:function(e){this._mediaObject.setup="actpass"}},{key:"resume",value:function(){this._mediaObject.direction="sendonly"}},{key:"planBReceive",value:function(e){var t,r=this,n=e.offerRtpParameters,a=e.streamId,s=e.trackId,c=n.encodings[0],o=c.ssrc,u=c.rtx&&c.rtx.ssrc?c.rtx.ssrc:void 0,d=this._mediaObject.payloads.split(" "),p=i(n.codecs);try{for(p.s();!(t=p.n()).done;){var l=t.value;if(!d.includes(String(l.payloadType))){var f={payload:l.payloadType,codec:v(l),rate:l.clockRate};l.channels>1&&(f.encoding=l.channels),this._mediaObject.rtp.push(f);for(var h={payload:l.payloadType,config:""},m=0,g=Object.keys(l.parameters);m<g.length;m++){var y=g[m];h.config&&(h.config+=";"),h.config+="".concat(y,"=").concat(l.parameters[y])}h.config&&this._mediaObject.fmtp.push(h);var b,_=i(l.rtcpFeedback);try{for(_.s();!(b=_.n()).done;){var w=b.value;this._mediaObject.rtcpFb.push({payload:l.payloadType,type:w.type,subtype:w.parameter})}}catch(S){_.e(S)}finally{_.f()}}}}catch(S){p.e(S)}finally{p.f()}this._mediaObject.payloads+=" ".concat(n.codecs.filter((function(e){return!r._mediaObject.payloads.includes(e.payloadType)})).map((function(e){return e.payloadType})).join(" ")),this._mediaObject.payloads=this._mediaObject.payloads.trim(),n.rtcp.cname&&this._mediaObject.ssrcs.push({id:o,attribute:"cname",value:n.rtcp.cname}),this._mediaObject.ssrcs.push({id:o,attribute:"msid",value:"".concat(a||"-"," ").concat(s)}),u&&(n.rtcp.cname&&this._mediaObject.ssrcs.push({id:u,attribute:"cname",value:n.rtcp.cname}),this._mediaObject.ssrcs.push({id:u,attribute:"msid",value:"".concat(a||"-"," ").concat(s)}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(o," ").concat(u)}))}},{key:"planBStopReceiving",value:function(e){var t=e.offerRtpParameters.encodings[0],r=t.ssrc,n=t.rtx&&t.rtx.ssrc?t.rtx.ssrc:void 0;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter((function(e){return e.id!==r&&e.id!==n})),n&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter((function(e){return e.ssrcs!=="".concat(r," ").concat(n)})))}}]),r}(f);function v(e){var t=new RegExp("^(audio|video)/(.+)","i").exec(e.mimeType);if(!t)throw new TypeError("invalid codec.mimeType");return t[2]}t.OfferMediaSection=m},9678:function(e,t,r){"use strict";var n=r(4704).default,a=r(6690).default,i=r(9728).default,s=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),c=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&s(t,e,r);return c(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteSdp=void 0;var u=o(r(7724)),d=r(4115),p=r(4112),l=new d.Logger("RemoteSdp"),f=function(){function e(t){var r=t.iceParameters,n=t.iceCandidates,i=t.dtlsParameters,s=t.sctpParameters,c=t.plainRtpParameters,o=t.planB,u=void 0!==o&&o;if(a(this,e),this._mediaSections=[],this._midToIndex=new Map,this._iceParameters=r,this._iceCandidates=n,this._dtlsParameters=i,this._sctpParameters=s,this._plainRtpParameters=c,this._planB=u,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},r&&r.iceLite&&(this._sdpObject.icelite="ice-lite"),i){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};var d=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:i.fingerprints[d-1].algorithm,hash:i.fingerprints[d-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}c&&(this._sdpObject.origin.address=c.ip,this._sdpObject.origin.ipVer=c.ipVersion)}return i(e,[{key:"updateIceParameters",value:function(e){l.debug("updateIceParameters() [iceParameters:%o]",e),this._iceParameters=e,this._sdpObject.icelite=e.iceLite?"ice-lite":void 0;var t,r=n(this._mediaSections);try{for(r.s();!(t=r.n()).done;){t.value.setIceParameters(e)}}catch(a){r.e(a)}finally{r.f()}}},{key:"updateDtlsRole",value:function(e){l.debug("updateDtlsRole() [role:%s]",e),this._dtlsParameters.role=e;var t,r=n(this._mediaSections);try{for(r.s();!(t=r.n()).done;){t.value.setDtlsRole(e)}}catch(a){r.e(a)}finally{r.f()}}},{key:"getNextMediaSectionIdx",value:function(){for(var e=0;e<this._mediaSections.length;++e){var t=this._mediaSections[e];if(t.closed)return{idx:e,reuseMid:t.mid}}return{idx:this._mediaSections.length}}},{key:"send",value:function(e){var t=e.offerMediaObject,r=e.reuseMid,n=e.offerRtpParameters,a=e.answerRtpParameters,i=e.codecOptions,s=e.extmapAllowMixed,c=void 0!==s&&s,o=new p.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:t,offerRtpParameters:n,answerRtpParameters:a,codecOptions:i,extmapAllowMixed:c});r?this._replaceMediaSection(o,r):this._midToIndex.has(o.mid)?this._replaceMediaSection(o):this._addMediaSection(o)}},{key:"receive",value:function(e){var t,r=e.mid,n=e.kind,a=e.offerRtpParameters,i=e.streamId,s=e.trackId,c=this._midToIndex.get(r);if(void 0!==c&&(t=this._mediaSections[c]),t)t.planBReceive({offerRtpParameters:a,streamId:i,trackId:s}),this._replaceMediaSection(t);else{t=new p.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:r,kind:n,offerRtpParameters:a,streamId:i,trackId:s});var o=this._mediaSections.find((function(e){return e.closed}));o?this._replaceMediaSection(t,o.mid):this._addMediaSection(t)}}},{key:"pauseMediaSection",value:function(e){this._findMediaSection(e).pause()}},{key:"resumeSendingMediaSection",value:function(e){this._findMediaSection(e).resume()}},{key:"resumeReceivingMediaSection",value:function(e){this._findMediaSection(e).resume()}},{key:"disableMediaSection",value:function(e){this._findMediaSection(e).disable()}},{key:"closeMediaSection",value:function(e){var t=this._findMediaSection(e);return e===this._firstMid?(l.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",e),this.disableMediaSection(e),!1):(t.close(),this._regenerateBundleMids(),!0)}},{key:"muxMediaSectionSimulcast",value:function(e,t){var r=this._findMediaSection(e);r.muxSimulcastStreams(t),this._replaceMediaSection(r)}},{key:"planBStopReceiving",value:function(e){var t=e.mid,r=e.offerRtpParameters,n=this._findMediaSection(t);n.planBStopReceiving({offerRtpParameters:r}),this._replaceMediaSection(n)}},{key:"sendSctpAssociation",value:function(e){var t=e.offerMediaObject,r=new p.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:t});this._addMediaSection(r)}},{key:"receiveSctpAssociation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.oldDataChannelSpec,r=void 0!==t&&t,n=new p.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:r});this._addMediaSection(n)}},{key:"getSdp",value:function(){return this._sdpObject.origin.sessionVersion++,u.write(this._sdpObject)}},{key:"_addMediaSection",value:function(e){this._firstMid||(this._firstMid=e.mid),this._mediaSections.push(e),this._midToIndex.set(e.mid,this._mediaSections.length-1),this._sdpObject.media.push(e.getObject()),this._regenerateBundleMids()}},{key:"_replaceMediaSection",value:function(e,t){if("string"===typeof t){var r=this._midToIndex.get(t);if(void 0===r)throw new Error("no media section found for reuseMid '".concat(t,"'"));var n=this._mediaSections[r];this._mediaSections[r]=e,this._midToIndex.delete(n.mid),this._midToIndex.set(e.mid,r),this._sdpObject.media[r]=e.getObject(),this._regenerateBundleMids()}else{var a=this._midToIndex.get(e.mid);if(void 0===a)throw new Error("no media section found with mid '".concat(e.mid,"'"));this._mediaSections[a]=e,this._sdpObject.media[a]=e.getObject()}}},{key:"_findMediaSection",value:function(e){var t=this._midToIndex.get(e);if(void 0===t)throw new Error("no media section found with mid '".concat(e,"'"));return this._mediaSections[t]}},{key:"_regenerateBundleMids",value:function(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter((function(e){return!e.closed})).map((function(e){return e.mid})).join(" "))}}]),e}();t.RemoteSdp=f},8978:function(e,t,r){"use strict";var n=r(4704).default,a=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.applyCodecParameters=t.getCname=t.extractDtlsParameters=t.extractRtpCapabilities=void 0;var c=s(r(7724));t.extractRtpCapabilities=function(e){var t,r=e.sdpObject,a=new Map,i=[],s=!1,o=!1,u=n(r.media);try{for(u.s();!(t=u.n()).done;){var d=t.value,p=d.type;switch(p){case"audio":if(s)continue;s=!0;break;case"video":if(o)continue;o=!0;break;default:continue}var l,f=n(d.rtp);try{for(f.s();!(l=f.n()).done;){var h=l.value,m={kind:p,mimeType:"".concat(p,"/").concat(h.codec),preferredPayloadType:h.payload,clockRate:h.rate,channels:h.encoding,parameters:{},rtcpFeedback:[]};a.set(m.preferredPayloadType,m)}}catch(L){f.e(L)}finally{f.f()}var v,g=n(d.fmtp||[]);try{for(g.s();!(v=g.n()).done;){var y=v.value,b=c.parseParams(y.config),_=a.get(y.payload);_&&(b&&b.hasOwnProperty("profile-level-id")&&(b["profile-level-id"]=String(b["profile-level-id"])),_.parameters=b)}}catch(L){g.e(L)}finally{g.f()}var w,S=n(d.rtcpFb||[]);try{for(S.s();!(w=S.n()).done;){var k=w.value,x={type:k.type,parameter:k.subtype};if(x.parameter||delete x.parameter,"*"!==k.payload){var R=a.get(k.payload);if(!R)continue;R.rtcpFeedback.push(x)}else{var C,P=n(a.values());try{for(P.s();!(C=P.n()).done;){var D=C.value;D.kind!==p||/.+\/rtx$/i.test(D.mimeType)||D.rtcpFeedback.push(x)}}catch(L){P.e(L)}finally{P.f()}}}}catch(L){S.e(L)}finally{S.f()}var T,M=n(d.ext||[]);try{for(M.s();!(T=M.n()).done;){var O=T.value;if(!O["encrypt-uri"]){var E={kind:p,uri:O.uri,preferredId:O.value};i.push(E)}}}catch(L){M.e(L)}finally{M.f()}}}catch(L){u.e(L)}finally{u.f()}return{codecs:Array.from(a.values()),headerExtensions:i}},t.extractDtlsParameters=function(e){var t=e.sdpObject,r=(t.media||[]).find((function(e){return e.iceUfrag&&0!==e.port}));if(!r)throw new Error("no active media section found");var n,a=r.fingerprint||t.fingerprint;switch(r.setup){case"active":n="client";break;case"passive":n="server";break;case"actpass":n="auto"}return{role:n,fingerprints:[{algorithm:a.type,value:a.hash}]}},t.getCname=function(e){var t=(e.offerMediaObject.ssrcs||[]).find((function(e){return"cname"===e.attribute}));return t?t.value:""},t.applyCodecParameters=function(e){var t,r=e.offerRtpParameters,a=e.answerMediaObject,i=n(r.codecs);try{var s=function(){var e=t.value,r=e.mimeType.toLowerCase();if("audio/opus"!==r)return"continue";if(!(a.rtp||[]).find((function(t){return t.payload===e.payloadType})))return"continue";a.fmtp=a.fmtp||[];var n=a.fmtp.find((function(t){return t.payload===e.payloadType}));n||(n={payload:e.payloadType,config:""},a.fmtp.push(n));var i=c.parseParams(n.config);if("audio/opus"===r){var s=e.parameters["sprop-stereo"];void 0!==s&&(i.stereo=s?1:0)}n.config="";for(var o=0,u=Object.keys(i);o<u.length;o++){var d=u[o];n.config&&(n.config+=";"),n.config+="".concat(d,"=").concat(i[d])}};for(i.s();!(t=i.n()).done;)s()}catch(o){i.e(o)}finally{i.f()}}},9547:function(e,t,r){"use strict";var n=r(7424).default,a=r(4704).default;Object.defineProperty(t,"__esModule",{value:!0}),t.addLegacySimulcast=t.getRtpEncodings=void 0,t.getRtpEncodings=function(e){var t,r,i=e.offerMediaObject,s=e.track,c=new Set,o=a(i.ssrcs||[]);try{for(o.s();!(r=o.n()).done;){var u=r.value;if("msid"===u.attribute)if(u.value.split(" ")[1]===s.id){var d=u.id;c.add(d),t||(t=d)}}}catch(T){o.e(T)}finally{o.f()}if(0===c.size)throw new Error("a=ssrc line with msid information not found [track.id:".concat(s.id,"]"));var p,l=new Map,f=a(i.ssrcGroups||[]);try{for(f.s();!(p=f.n()).done;){var h=p.value;if("FID"===h.semantics){var m=h.ssrcs.split(/\s+/),v=n(m,2),g=v[0],y=v[1];g=Number(g),y=Number(y),c.has(g)&&(c.delete(g),c.delete(y),l.set(g,y))}}}catch(T){f.e(T)}finally{f.f()}var b,_=a(c);try{for(_.s();!(b=_.n()).done;){var w=b.value;l.set(w,null)}}catch(T){_.e(T)}finally{_.f()}var S,k=[],x=a(l);try{for(x.s();!(S=x.n()).done;){var R=n(S.value,2),C=R[0],P=R[1],D={ssrc:C};P&&(D.rtx={ssrc:P}),k.push(D)}}catch(T){x.e(T)}finally{x.f()}return k},t.addLegacySimulcast=function(e){var t,r,n,a=e.offerMediaObject,i=e.track,s=e.numStreams;if(s<=1)throw new TypeError("numStreams must be greater than 1");if(!(a.ssrcs||[]).find((function(e){return"msid"===e.attribute&&(e.value.split(" ")[1]===i.id&&(t=e.id,n=e.value.split(" ")[0],!0))})))throw new Error("a=ssrc line with msid information not found [track.id:".concat(i.id,"]"));(a.ssrcGroups||[]).some((function(e){if("FID"!==e.semantics)return!1;var n=e.ssrcs.split(/\s+/);return Number(n[0])===t&&(r=Number(n[1]),!0)}));var c=a.ssrcs.find((function(e){return"cname"===e.attribute&&e.id===t}));if(!c)throw new Error("a=ssrc line with cname information not found [track.id:".concat(i.id,"]"));for(var o=c.value,u=[],d=[],p=0;p<s;++p)u.push(t+p),r&&d.push(r+p);a.ssrcGroups=a.ssrcGroups||[],a.ssrcs=a.ssrcs||[],a.ssrcGroups.push({semantics:"SIM",ssrcs:u.join(" ")});for(var l=0;l<u.length;++l){var f=u[l];a.ssrcs.push({id:f,attribute:"cname",value:o}),a.ssrcs.push({id:f,attribute:"msid",value:"".concat(n," ").concat(i.id)})}for(var h=0;h<d.length;++h){var m=u[h],v=d[h];a.ssrcs.push({id:v,attribute:"cname",value:o}),a.ssrcs.push({id:v,attribute:"msid",value:"".concat(n," ").concat(i.id)}),a.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(m," ").concat(v)})}}},8480:function(e,t,r){"use strict";var n=r(7424).default,a=r(4704).default;Object.defineProperty(t,"__esModule",{value:!0}),t.addLegacySimulcast=t.getRtpEncodings=void 0,t.getRtpEncodings=function(e){var t,r=e.offerMediaObject,i=new Set,s=a(r.ssrcs||[]);try{for(s.s();!(t=s.n()).done;){var c=t.value.id;i.add(c)}}catch(C){s.e(C)}finally{s.f()}if(0===i.size)throw new Error("no a=ssrc lines found");var o,u=new Map,d=a(r.ssrcGroups||[]);try{for(d.s();!(o=d.n()).done;){var p=o.value;if("FID"===p.semantics){var l=p.ssrcs.split(/\s+/),f=n(l,2),h=f[0],m=f[1];h=Number(h),m=Number(m),i.has(h)&&(i.delete(h),i.delete(m),u.set(h,m))}}}catch(C){d.e(C)}finally{d.f()}var v,g=a(i);try{for(g.s();!(v=g.n()).done;){var y=v.value;u.set(y,null)}}catch(C){g.e(C)}finally{g.f()}var b,_=[],w=a(u);try{for(w.s();!(b=w.n()).done;){var S=n(b.value,2),k=S[0],x=S[1],R={ssrc:k};x&&(R.rtx={ssrc:x}),_.push(R)}}catch(C){w.e(C)}finally{w.f()}return _},t.addLegacySimulcast=function(e){var t=e.offerMediaObject,r=e.numStreams;if(r<=1)throw new TypeError("numStreams must be greater than 1");var a=(t.ssrcs||[]).find((function(e){return"msid"===e.attribute}));if(!a)throw new Error("a=ssrc line with msid information not found");var i,s=a.value.split(" "),c=n(s,2),o=c[0],u=c[1],d=a.id;(t.ssrcGroups||[]).some((function(e){if("FID"!==e.semantics)return!1;var t=e.ssrcs.split(/\s+/);return Number(t[0])===d&&(i=Number(t[1]),!0)}));var p=t.ssrcs.find((function(e){return"cname"===e.attribute}));if(!p)throw new Error("a=ssrc line with cname information not found");for(var l=p.value,f=[],h=[],m=0;m<r;++m)f.push(d+m),i&&h.push(i+m);t.ssrcGroups=[],t.ssrcs=[],t.ssrcGroups.push({semantics:"SIM",ssrcs:f.join(" ")});for(var v=0;v<f.length;++v){var g=f[v];t.ssrcs.push({id:g,attribute:"cname",value:l}),t.ssrcs.push({id:g,attribute:"msid",value:"".concat(o," ").concat(u)})}for(var y=0;y<h.length;++y){var b=f[y],_=h[y];t.ssrcs.push({id:_,attribute:"cname",value:l}),t.ssrcs.push({id:_,attribute:"msid",value:"".concat(o," ").concat(u)}),t.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(b," ").concat(_)})}}},1947:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=t.parseScalabilityMode=t.detectDevice=t.Device=t.version=t.types=void 0;var c=s(r(858));t.debug=c.default;var o=r(5703);Object.defineProperty(t,"Device",{enumerable:!0,get:function(){return o.Device}}),Object.defineProperty(t,"detectDevice",{enumerable:!0,get:function(){return o.detectDevice}});var u=i(r(6517));t.types=u,t.version="3.6.82";var d=r(8732);Object.defineProperty(t,"parseScalabilityMode",{enumerable:!0,get:function(){return d.parse}})},1777:function(e,t,r){"use strict";var n=r(4704).default,a=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.canReceive=t.canSend=t.generateProbatorRtpParameters=t.reduceCodecs=t.getSendingRemoteRtpParameters=t.getSendingRtpParameters=t.getRecvRtpCapabilities=t.getExtendedRtpCapabilities=t.validateSctpStreamParameters=t.validateSctpParameters=t.validateNumSctpStreams=t.validateSctpCapabilities=t.validateRtcpParameters=t.validateRtpEncodingParameters=t.validateRtpHeaderExtensionParameters=t.validateRtpCodecParameters=t.validateRtpParameters=t.validateRtpHeaderExtension=t.validateRtcpFeedback=t.validateRtpCodecCapability=t.validateRtpCapabilities=void 0;var c=s(r(4434)),o=s(r(3001));function u(e){var t=new RegExp("^(audio|video)/(.+)","i");if("object"!==typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!==typeof e.mimeType)throw new TypeError("missing codec.mimeType");var r=t.exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if(e.kind=r[1].toLowerCase(),e.preferredPayloadType&&"number"!==typeof e.preferredPayloadType)throw new TypeError("invalid codec.preferredPayloadType");if("number"!==typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===e.kind?"number"!==typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(var a=0,i=Object.keys(e.parameters);a<i.length;a++){var s=i[a],c=e.parameters[s];if(void 0===c&&(e.parameters[s]="",c=""),"string"!==typeof c&&"number"!==typeof c)throw new TypeError("invalid codec parameter [key:".concat(s,"s, value:").concat(c,"]"));if("apt"===s&&"number"!==typeof c)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);var o,u=n(e.rtcpFeedback);try{for(u.s();!(o=u.n()).done;){d(o.value)}}catch(p){u.e(p)}finally{u.f()}}function d(e){if("object"!==typeof e)throw new TypeError("fb is not an object");if(!e.type||"string"!==typeof e.type)throw new TypeError("missing fb.type");e.parameter&&"string"===typeof e.parameter||(e.parameter="")}function p(e){if("object"!==typeof e)throw new TypeError("ext is not an object");if("audio"!==e.kind&&"video"!==e.kind)throw new TypeError("invalid ext.kind");if(!e.uri||"string"!==typeof e.uri)throw new TypeError("missing ext.uri");if("number"!==typeof e.preferredId)throw new TypeError("missing ext.preferredId");if(e.preferredEncrypt&&"boolean"!==typeof e.preferredEncrypt)throw new TypeError("invalid ext.preferredEncrypt");if(e.preferredEncrypt||(e.preferredEncrypt=!1),e.direction&&"string"!==typeof e.direction)throw new TypeError("invalid ext.direction");e.direction||(e.direction="sendrecv")}function l(e){if("object"!==typeof e)throw new TypeError("params is not an object");if(e.mid&&"string"!==typeof e.mid)throw new TypeError("params.mid is not a string");if(!Array.isArray(e.codecs))throw new TypeError("missing params.codecs");var t,r=n(e.codecs);try{for(r.s();!(t=r.n()).done;){f(t.value)}}catch(o){r.e(o)}finally{r.f()}if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("params.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);var a,i=n(e.headerExtensions);try{for(i.s();!(a=i.n()).done;){h(a.value)}}catch(o){i.e(o)}finally{i.f()}if(e.encodings&&!Array.isArray(e.encodings))throw new TypeError("params.encodings is not an array");e.encodings||(e.encodings=[]);var s,c=n(e.encodings);try{for(c.s();!(s=c.n()).done;){m(s.value)}}catch(o){c.e(o)}finally{c.f()}if(e.rtcp&&"object"!==typeof e.rtcp)throw new TypeError("params.rtcp is not an object");e.rtcp||(e.rtcp={}),v(e.rtcp)}function f(e){var t=new RegExp("^(audio|video)/(.+)","i");if("object"!==typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!==typeof e.mimeType)throw new TypeError("missing codec.mimeType");var r=t.exec(e.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if("number"!==typeof e.payloadType)throw new TypeError("missing codec.payloadType");if("number"!==typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===r[1].toLowerCase()?"number"!==typeof e.channels&&(e.channels=1):delete e.channels,e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(var a=0,i=Object.keys(e.parameters);a<i.length;a++){var s=i[a],c=e.parameters[s];if(void 0===c&&(e.parameters[s]="",c=""),"string"!==typeof c&&"number"!==typeof c)throw new TypeError("invalid codec parameter [key:".concat(s,"s, value:").concat(c,"]"));if("apt"===s&&"number"!==typeof c)throw new TypeError("invalid codec apt parameter")}e.rtcpFeedback&&Array.isArray(e.rtcpFeedback)||(e.rtcpFeedback=[]);var o,u=n(e.rtcpFeedback);try{for(u.s();!(o=u.n()).done;){d(o.value)}}catch(p){u.e(p)}finally{u.f()}}function h(e){if("object"!==typeof e)throw new TypeError("ext is not an object");if(!e.uri||"string"!==typeof e.uri)throw new TypeError("missing ext.uri");if("number"!==typeof e.id)throw new TypeError("missing ext.id");if(e.encrypt&&"boolean"!==typeof e.encrypt)throw new TypeError("invalid ext.encrypt");e.encrypt||(e.encrypt=!1),e.parameters&&"object"===typeof e.parameters||(e.parameters={});for(var t=0,r=Object.keys(e.parameters);t<r.length;t++){var n=r[t],a=e.parameters[n];if(void 0===a&&(e.parameters[n]="",a=""),"string"!==typeof a&&"number"!==typeof a)throw new TypeError("invalid header extension parameter")}}function m(e){if("object"!==typeof e)throw new TypeError("encoding is not an object");if(e.ssrc&&"number"!==typeof e.ssrc)throw new TypeError("invalid encoding.ssrc");if(e.rid&&"string"!==typeof e.rid)throw new TypeError("invalid encoding.rid");if(e.rtx&&"object"!==typeof e.rtx)throw new TypeError("invalid encoding.rtx");if(e.rtx&&"number"!==typeof e.rtx.ssrc)throw new TypeError("missing encoding.rtx.ssrc");if(e.dtx&&"boolean"===typeof e.dtx||(e.dtx=!1),e.scalabilityMode&&"string"!==typeof e.scalabilityMode)throw new TypeError("invalid encoding.scalabilityMode")}function v(e){if("object"!==typeof e)throw new TypeError("rtcp is not an object");if(e.cname&&"string"!==typeof e.cname)throw new TypeError("invalid rtcp.cname");e.reducedSize&&"boolean"===typeof e.reducedSize||(e.reducedSize=!0)}function g(e){if("object"!==typeof e)throw new TypeError("numStreams is not an object");if("number"!==typeof e.OS)throw new TypeError("missing numStreams.OS");if("number"!==typeof e.MIS)throw new TypeError("missing numStreams.MIS")}function y(e){return!!e&&/.+\/rtx$/i.test(e.mimeType)}function b(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.strict,a=void 0!==n&&n,i=r.modify,s=void 0!==i&&i,o=e.mimeType.toLowerCase(),u=t.mimeType.toLowerCase();if(o!==u)return!1;if(e.clockRate!==t.clockRate)return!1;if(e.channels!==t.channels)return!1;switch(o){case"video/h264":if(a){var d,p=e.parameters["packetization-mode"]||0,l=t.parameters["packetization-mode"]||0;if(p!==l)return!1;if(!c.isSameProfile(e.parameters,t.parameters))return!1;try{d=c.generateProfileLevelIdForAnswer(e.parameters,t.parameters)}catch(m){return!1}s&&(d?(e.parameters["profile-level-id"]=d,t.parameters["profile-level-id"]=d):(delete e.parameters["profile-level-id"],delete t.parameters["profile-level-id"]))}break;case"video/vp9":if(a){var f=e.parameters["profile-id"]||0,h=t.parameters["profile-id"]||0;if(f!==h)return!1}}return!0}function _(e,t){var r,a=[],i=n(e.rtcpFeedback||[]);try{var s=function(){var e=r.value,n=(t.rtcpFeedback||[]).find((function(t){return t.type===e.type&&(t.parameter===e.parameter||!t.parameter&&!e.parameter)}));n&&a.push(n)};for(i.s();!(r=i.n()).done;)s()}catch(c){i.e(c)}finally{i.f()}return a}t.validateRtpCapabilities=function(e){if("object"!==typeof e)throw new TypeError("caps is not an object");if(e.codecs&&!Array.isArray(e.codecs))throw new TypeError("caps.codecs is not an array");e.codecs||(e.codecs=[]);var t,r=n(e.codecs);try{for(r.s();!(t=r.n()).done;){u(t.value)}}catch(s){r.e(s)}finally{r.f()}if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);var a,i=n(e.headerExtensions);try{for(i.s();!(a=i.n()).done;){p(a.value)}}catch(s){i.e(s)}finally{i.f()}},t.validateRtpCodecCapability=u,t.validateRtcpFeedback=d,t.validateRtpHeaderExtension=p,t.validateRtpParameters=l,t.validateRtpCodecParameters=f,t.validateRtpHeaderExtensionParameters=h,t.validateRtpEncodingParameters=m,t.validateRtcpParameters=v,t.validateSctpCapabilities=function(e){if("object"!==typeof e)throw new TypeError("caps is not an object");if(!e.numStreams||"object"!==typeof e.numStreams)throw new TypeError("missing caps.numStreams");g(e.numStreams)},t.validateNumSctpStreams=g,t.validateSctpParameters=function(e){if("object"!==typeof e)throw new TypeError("params is not an object");if("number"!==typeof e.port)throw new TypeError("missing params.port");if("number"!==typeof e.OS)throw new TypeError("missing params.OS");if("number"!==typeof e.MIS)throw new TypeError("missing params.MIS");if("number"!==typeof e.maxMessageSize)throw new TypeError("missing params.maxMessageSize")},t.validateSctpStreamParameters=function(e){if("object"!==typeof e)throw new TypeError("params is not an object");if("number"!==typeof e.streamId)throw new TypeError("missing params.streamId");var t=!1;if("boolean"===typeof e.ordered?t=!0:e.ordered=!0,e.maxPacketLifeTime&&"number"!==typeof e.maxPacketLifeTime)throw new TypeError("invalid params.maxPacketLifeTime");if(e.maxRetransmits&&"number"!==typeof e.maxRetransmits)throw new TypeError("invalid params.maxRetransmits");if(e.maxPacketLifeTime&&e.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(t&&e.ordered&&(e.maxPacketLifeTime||e.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(t||!e.maxPacketLifeTime&&!e.maxRetransmits||(e.ordered=!1),e.label&&"string"!==typeof e.label)throw new TypeError("invalid params.label");if(e.protocol&&"string"!==typeof e.protocol)throw new TypeError("invalid params.protocol")},t.getExtendedRtpCapabilities=function(e,t){var r,a={codecs:[],headerExtensions:[]},i=n(t.codecs||[]);try{var s=function(){var t=r.value;if(y(t))return"continue";var n=(e.codecs||[]).find((function(e){return b(e,t,{strict:!0,modify:!0})}));if(!n)return"continue";var i={mimeType:n.mimeType,kind:n.kind,clockRate:n.clockRate,channels:n.channels,localPayloadType:n.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:t.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:n.parameters,remoteParameters:t.parameters,rtcpFeedback:_(n,t)};a.codecs.push(i)};for(i.s();!(r=i.n()).done;)s()}catch(f){i.e(f)}finally{i.f()}var c,o=n(a.codecs);try{var u=function(){var r=c.value,n=e.codecs.find((function(e){return y(e)&&e.parameters.apt===r.localPayloadType})),a=t.codecs.find((function(e){return y(e)&&e.parameters.apt===r.remotePayloadType}));n&&a&&(r.localRtxPayloadType=n.preferredPayloadType,r.remoteRtxPayloadType=a.preferredPayloadType)};for(o.s();!(c=o.n()).done;)u()}catch(f){o.e(f)}finally{o.f()}var d,p=n(t.headerExtensions);try{var l=function(){var t=d.value,r=e.headerExtensions.find((function(e){return function(e,t){if(e.kind&&t.kind&&e.kind!==t.kind)return!1;if(e.uri!==t.uri)return!1;return!0}(e,t)}));if(!r)return"continue";var n={kind:t.kind,uri:t.uri,sendId:r.preferredId,recvId:t.preferredId,encrypt:r.preferredEncrypt,direction:"sendrecv"};switch(t.direction){case"sendrecv":n.direction="sendrecv";break;case"recvonly":n.direction="sendonly";break;case"sendonly":n.direction="recvonly";break;case"inactive":n.direction="inactive"}a.headerExtensions.push(n)};for(p.s();!(d=p.n()).done;)l()}catch(f){p.e(f)}finally{p.f()}return a},t.getRecvRtpCapabilities=function(e){var t,r={codecs:[],headerExtensions:[]},a=n(e.codecs);try{for(a.s();!(t=a.n()).done;){var i=t.value,s={mimeType:i.mimeType,kind:i.kind,preferredPayloadType:i.remotePayloadType,clockRate:i.clockRate,channels:i.channels,parameters:i.localParameters,rtcpFeedback:i.rtcpFeedback};if(r.codecs.push(s),i.remoteRtxPayloadType){var c={mimeType:"".concat(i.kind,"/rtx"),kind:i.kind,preferredPayloadType:i.remoteRtxPayloadType,clockRate:i.clockRate,parameters:{apt:i.remotePayloadType},rtcpFeedback:[]};r.codecs.push(c)}}}catch(l){a.e(l)}finally{a.f()}var o,u=n(e.headerExtensions);try{for(u.s();!(o=u.n()).done;){var d=o.value;if("sendrecv"===d.direction||"recvonly"===d.direction){var p={kind:d.kind,uri:d.uri,preferredId:d.recvId,preferredEncrypt:d.encrypt,direction:d.direction};r.headerExtensions.push(p)}}}catch(l){u.e(l)}finally{u.f()}return r},t.getSendingRtpParameters=function(e,t){var r,a={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},i=n(t.codecs);try{for(i.s();!(r=i.n()).done;){var s=r.value;if(s.kind===e){var c={mimeType:s.mimeType,payloadType:s.localPayloadType,clockRate:s.clockRate,channels:s.channels,parameters:s.localParameters,rtcpFeedback:s.rtcpFeedback};if(a.codecs.push(c),s.localRtxPayloadType){var o={mimeType:"".concat(s.kind,"/rtx"),payloadType:s.localRtxPayloadType,clockRate:s.clockRate,parameters:{apt:s.localPayloadType},rtcpFeedback:[]};a.codecs.push(o)}}}}catch(f){i.e(f)}finally{i.f()}var u,d=n(t.headerExtensions);try{for(d.s();!(u=d.n()).done;){var p=u.value;if(!(p.kind&&p.kind!==e||"sendrecv"!==p.direction&&"sendonly"!==p.direction)){var l={uri:p.uri,id:p.sendId,encrypt:p.encrypt,parameters:{}};a.headerExtensions.push(l)}}}catch(f){d.e(f)}finally{d.f()}return a},t.getSendingRemoteRtpParameters=function(e,t){var r,a={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},i=n(t.codecs);try{for(i.s();!(r=i.n()).done;){var s=r.value;if(s.kind===e){var c={mimeType:s.mimeType,payloadType:s.localPayloadType,clockRate:s.clockRate,channels:s.channels,parameters:s.remoteParameters,rtcpFeedback:s.rtcpFeedback};if(a.codecs.push(c),s.localRtxPayloadType){var o={mimeType:"".concat(s.kind,"/rtx"),payloadType:s.localRtxPayloadType,clockRate:s.clockRate,parameters:{apt:s.localPayloadType},rtcpFeedback:[]};a.codecs.push(o)}}}}catch(S){i.e(S)}finally{i.f()}var u,d=n(t.headerExtensions);try{for(d.s();!(u=d.n()).done;){var p=u.value;if(!(p.kind&&p.kind!==e||"sendrecv"!==p.direction&&"sendonly"!==p.direction)){var l={uri:p.uri,id:p.sendId,encrypt:p.encrypt,parameters:{}};a.headerExtensions.push(l)}}}catch(S){d.e(S)}finally{d.f()}if(a.headerExtensions.some((function(e){return"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.uri}))){var f,h=n(a.codecs);try{for(h.s();!(f=h.n()).done;){var m=f.value;m.rtcpFeedback=(m.rtcpFeedback||[]).filter((function(e){return"goog-remb"!==e.type}))}}catch(S){h.e(S)}finally{h.f()}}else if(a.headerExtensions.some((function(e){return"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.uri}))){var v,g=n(a.codecs);try{for(g.s();!(v=g.n()).done;){var y=v.value;y.rtcpFeedback=(y.rtcpFeedback||[]).filter((function(e){return"transport-cc"!==e.type}))}}catch(S){g.e(S)}finally{g.f()}}else{var b,_=n(a.codecs);try{for(_.s();!(b=_.n()).done;){var w=b.value;w.rtcpFeedback=(w.rtcpFeedback||[]).filter((function(e){return"transport-cc"!==e.type&&"goog-remb"!==e.type}))}}catch(S){_.e(S)}finally{_.f()}}return a},t.reduceCodecs=function(e,t){var r=[];if(t){for(var n=0;n<e.length;++n)if(b(e[n],t)){r.push(e[n]),y(e[n+1])&&r.push(e[n+1]);break}if(0===r.length)throw new TypeError("no matching codec found")}else r.push(e[0]),y(e[1])&&r.push(e[1]);return r},t.generateProbatorRtpParameters=function(e){l(e=o.clone(e,{}));var t={mid:"probator",codecs:[],headerExtensions:[],encodings:[{ssrc:1234}],rtcp:{cname:"probator"}};return t.codecs.push(e.codecs[0]),t.codecs[0].payloadType=127,t.headerExtensions=e.headerExtensions,t},t.canSend=function(e,t){return t.codecs.some((function(t){return t.kind===e}))},t.canReceive=function(e,t){if(l(e),0===e.codecs.length)return!1;var r=e.codecs[0];return t.codecs.some((function(e){return e.remotePayloadType===r.payloadType}))}},8732:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;var r=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");t.parse=function(e){var t=r.exec(e||"");return t?{spatialLayers:Number(t[1]),temporalLayers:Number(t[2])}:{spatialLayers:1,temporalLayers:1}}},6517:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var a=Object.getOwnPropertyDescriptor(t,r);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,a)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(5703),t),a(r(475),t),a(r(9277),t),a(r(1098),t),a(r(7358),t),a(r(6919),t),a(r(2617),t),a(r(1045),t),a(r(4376),t),a(r(6431),t)},3001:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateRandomNumber=t.clone=void 0,t.clone=function(e,t){return"undefined"===typeof e?t:JSON.parse(JSON.stringify(e))},t.generateRandomNumber=function(){return Math.round(1e7*Math.random())}},858:function(e,t,r){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,a=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(a=n))})),t.splice(a,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(r){}!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_STRIPE_PUBLIC_KEY:"pk_live_eVMbIifj5lnvgBleBCRaCv4E00aeXQkPxQ",REACT_APP_RECAPTCHA_SITE_KEY:"6LeDGP4UAAAAAGYZZenyU-3fRdhL3p0BaBmiK9mM",REACT_APP_FIREBASE_CONFIG:'{"apiKey":"AIzaSyA2fkXeFokJ-Ei_jnzDso5AmjbIaMdzuEc","authDomain":"watchparty-273604.firebaseapp.com","databaseURL":"https://watchparty-273604.firebaseio.com","projectId":"watchparty-273604","storageBucket":"watchparty-273604.appspot.com","messagingSenderId":"769614672795","appId":"1:769614672795:web:54bbda86288ab1a034273e"}'}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=r(5915)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},5915:function(e,t,r){var n=r(861).default;e.exports=function(e){function t(e){var r,n,i,s=null;function c(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(c.enabled){var i=c,s=Number(new Date),o=s-(r||s);i.diff=o,i.prev=r,i.curr=s,r=s,n[0]=t.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");var u=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";u++;var a=t.formatters[r];if("function"===typeof a){var s=n[u];e=a.call(i,s),n.splice(u,1),u--}return e})),t.formatArgs.call(i,n);var d=i.log||t.log;d.apply(i,n)}}return c.namespace=e,c.useColors=t.useColors(),c.color=t.selectColor(e),c.extend=a,c.destroy=t.destroy,Object.defineProperty(c,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==s?s:(n!==t.namespaces&&(n=t.namespaces,i=t.enabled(e)),i)},set:function(e){s=e}}),"function"===typeof t.init&&t.init(c),c}function a(e,r){var n=t(this.namespace+("undefined"===typeof r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(n(t.names.map(i)),n(t.skips.map(i).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var n=("string"===typeof e?e:"").split(/[\s,]+/),a=n.length;for(r=0;r<a;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(9572),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},9572:function(e){var t=1e3,r=60*t,n=60*r,a=24*n,i=7*a,s=365.25*a;function c(e,t,r,n){var a=t>=1.5*r;return Math.round(e/r)+" "+n+(a?"s":"")}e.exports=function(e,o){o=o||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var c=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!c)return;var o=parseFloat(c[1]);switch((c[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return o*s;case"weeks":case"week":case"w":return o*i;case"days":case"day":case"d":return o*a;case"hours":case"hour":case"hrs":case"hr":case"h":return o*n;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===u&&isFinite(e))return o.long?function(e){var i=Math.abs(e);if(i>=a)return c(e,i,a,"day");if(i>=n)return c(e,i,n,"hour");if(i>=r)return c(e,i,r,"minute");if(i>=t)return c(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=a)return Math.round(e/a)+"d";if(i>=n)return Math.round(e/n)+"h";if(i>=r)return Math.round(e/r)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},4183:function(e,t,r){var n;e.exports="function"===typeof queueMicrotask?queueMicrotask.bind("undefined"!==typeof window?window:r.g):function(e){return(n||(n=Promise.resolve())).then(e).catch((function(e){return setTimeout((function(){throw e}),0)}))}},6712:function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},7724:function(e,t,r){var n=r(1775),a=r(2921);t.write=a,t.parse=n.parse,t.parseParams=n.parseParams,t.parseFmtpConfig=n.parseFmtpConfig,t.parsePayloads=n.parsePayloads,t.parseRemoteCandidates=n.parseRemoteCandidates,t.parseImageAttributes=n.parseImageAttributes,t.parseSimulcastStreamList=n.parseSimulcastStreamList},1775:function(e,t,r){var n=function(e){return String(Number(e))===e?Number(e):e},a=function(e,t,r){var a=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:a&&!t[e.name]&&(t[e.name]={});var i=e.push?{}:a?t[e.name]:t;!function(e,t,r,a){if(a&&!r)t[a]=n(e[1]);else for(var i=0;i<r.length;i+=1)null!=e[i+1]&&(t[r[i]]=n(e[i+1]))}(r.match(e.reg),i,e.names,e.name),e.push&&t[e.push].push(i)},i=r(6712),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],n=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach((function(e){var t=e[0],s=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),n=r[r.length-1]);for(var c=0;c<(i[t]||[]).length;c+=1){var o=i[t][c];if(o.reg.test(s))return a(o,n,s)}})),t.media=r,t};var c=function(e,t){var r=t.split(/=(.+)/,2);return 2===r.length?e[r[0]]=n(r[1]):1===r.length&&t.length>1&&(e[r[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(c,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],r=e.split(" ").map(n),a=0;a<r.length;a+=3)t.push({component:r[a],ip:r[a+1],port:r[a+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(c,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,r=!1;return"~"!==e[0]?t=n(e):(t=n(e.substring(1,e.length)),r=!0),{scid:t,paused:r}}))}))}},2921:function(e,t,r){var n=r(6712),a=/%[sdv%]/g,i=function(e){var t=1,r=arguments,n=r.length;return e.replace(a,(function(e){if(t>=n)return e;var a=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(a);case"%d":return Number(a);case"%v":return""}}))},s=function(e,t,r){var n=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var a=0;a<t.names.length;a+=1){var s=t.names[a];t.name?n.push(r[t.name][s]):n.push(r[t.names[a]])}else n.push(r[t.name]);return i.apply(null,n)},c=["v","o","s","i","u","e","p","c","b","t","r","z","a"],o=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||c,a=t.innerOrder||o,i=[];return r.forEach((function(t){n[t].forEach((function(r){r.name in e&&null!=e[r.name]?i.push(s(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){i.push(s(t,r,e))}))}))})),e.media.forEach((function(e){i.push(s("m",n.m[0],e)),a.forEach((function(t){n[t].forEach((function(r){r.name in e&&null!=e[r.name]?i.push(s(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){i.push(s(t,r,e))}))}))}))})),i.join("\r\n")+"\r\n"}},3405:function(e,t,r){var n=r(3897);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},7156:function(e){function t(e,t,r,n,a,i,s){try{var c=e[i](s),o=c.value}catch(u){return void r(u)}c.done?t(o):Promise.resolve(o).then(n,a)}e.exports=function(e){return function(){var r=this,n=arguments;return new Promise((function(a,i){var s=e.apply(r,n);function c(e){t(s,a,i,c,o,"next",e)}function o(e){t(s,a,i,c,o,"throw",e)}c(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},3515:function(e,t,r){var n=r(6015),a=r(9617);function i(t,r,s){return a()?(e.exports=i=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,r){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return r&&n(i,r.prototype),i},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(null,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,r){var n=r(6116);e.exports=function(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){o=!0,s=e},f:function(){try{c||null==r.return||r.return()}finally{if(o)throw s}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,r){var n=r(3808),a=r(9617),i=r(4993);e.exports=function(e){var t=a();return function(){var r,a=n(e);if(t){var s=n(this).constructor;r=Reflect.construct(a,arguments,s)}else r=a.apply(this,arguments);return i(this,r)}},e.exports.__esModule=!0,e.exports.default=e.exports},1588:function(e,t,r){var n=r(1753);function a(){return"undefined"!==typeof Reflect&&Reflect.get?(e.exports=a=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=a=function(e,t,r){var a=n(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},e.exports.__esModule=!0,e.exports.default=e.exports),a.apply(this,arguments)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,r){var n=r(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},6035:function(e){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},9498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2122:function(e,t,r){var n=r(8416);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,r){var n=r(8698).default,a=r(6115);e.exports=function(e,t){if(t&&("object"===n(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7061:function(e,t,r){var n=r(8698).default;function a(){"use strict";e.exports=a=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},r=Object.prototype,i=r.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(T){d=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var a=t&&t.prototype instanceof h?t:h,i=Object.create(a.prototype),s=new C(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(a,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw i;return D()}for(r.method=a,r.arg=i;;){var s=r.delegate;if(s){var c=k(s,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var o=l(e,t,r);if("normal"===o.type){if(n=r.done?"completed":"suspendedYield",o.arg===f)continue;return{value:o.arg,done:r.done}}"throw"===o.type&&(n="completed",r.method="throw",r.arg=o.arg)}}}(e,r,s),i}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(T){return{type:"throw",arg:T}}}t.wrap=p;var f={};function h(){}function m(){}function v(){}var g={};d(g,c,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(P([])));b&&b!==r&&i.call(b,c)&&(g=b);var _=v.prototype=h.prototype=Object.create(g);function w(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function r(a,s,c,o){var u=l(e[a],e,s);if("throw"!==u.type){var d=u.arg,p=d.value;return p&&"object"==n(p)&&i.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,c,o)}),(function(e){r("throw",e,c,o)})):t.resolve(p).then((function(e){d.value=e,c(d)}),(function(e){return r("throw",e,c,o)}))}o(u.arg)}var a;this._invoke=function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}}function k(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method))return f;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=l(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,f;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function P(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:D}}function D(){return{value:void 0,done:!0}}return m.prototype=v,d(_,"constructor",v),d(v,"constructor",m),m.displayName=d(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,d(e,u,"GeneratorFunction")),e.prototype=Object.create(_),e},t.awrap=function(e){return{__await:e}},w(S.prototype),d(S.prototype,o,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,n,a,i){void 0===i&&(i=Promise);var s=new S(p(e,r,n,a),i);return t.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(_),d(_,u,"Generator"),d(_,c,(function(){return this})),d(_,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=P,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),o=i.call(a,"finallyLoc");if(c&&o){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,f):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;R(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1753:function(e,t,r){var n=r(3808);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,r){var n=r(3405),a=r(9498),i=r(6116),s=r(2281);e.exports=function(e){return n(e)||a(e)||i(e)||s()},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3496:function(e,t,r){var n=r(3808),a=r(6015),i=r(6035),s=r(3515);function c(t){var r="function"===typeof Map?new Map:void 0;return e.exports=c=function(e){if(null===e||!i(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return s(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),a(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,c(t)}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports}}]);
//# sourceMappingURL=947.e3ec2ed8.chunk.js.map